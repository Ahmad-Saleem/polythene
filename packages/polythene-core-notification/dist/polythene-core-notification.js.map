{"version":3,"file":"polythene-core-notification.js","sources":["../../polythene-css-classes/notification.js","../src/notification-instance.js","../src/vars.js","../src/transitions.js"],"sourcesContent":["\nexport default {\n  component:      \"pe-notification\",\n\n  // elements\n  action:         \"pe-notification__action\",\n  content:        \"pe-notification__content\",\n  holder:         \"pe-notification__holder\",\n  placeholder:    \"pe-notification__placeholder\",\n  title:          \"pe-notification__title\",\n\n  // states\n  hasContainer:   \"pe-notification--container\",\n  horizontal:     \"pe-notification--horizontal\",\n  multilineTitle: \"pe-notification__title--multi-line\",\n  vertical:       \"pe-notification--vertical\",\n};","import { filterSupportedAttributes, transitionComponent, isClient, isServer } from \"polythene-core\";\nimport { Timer } from \"polythene-utilities\";\nimport classes from \"polythene-css-classes/notification\";\n\nconst DEFAULT_ANIMATION_DURATION = .6;\nconst DEFAULT_TIME_OUT = 3;\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst pause = state => {\n  state.paused(true);\n  if (state.timer) {\n    state.timer.pause();\n  }\n};\n\nconst unpause = state => {\n  state.paused(false);\n  if (state.timer) {\n    state.timer.resume();\n  }\n};\n\nconst stopTimer = state => {\n  if (state.timer) {\n    state.timer.stop();\n  }\n};\n\nconst prepareShow = (state, attrs) => {\n  if (!state.containerEl && isClient) {\n    // attrs.holderSelector is passed as option to Multiple\n    state.containerEl = document.querySelector(attrs.containerSelector || attrs.holderSelector);\n  }\n  if (!state.containerEl && isClient) {\n    console.error(\"No container element found\"); // eslint-disable-line no-console\n  }\n  if (attrs.containerSelector && state.containerEl) {\n    state.containerEl.classList.add(classes.hasContainer);\n  }\n};\n\nconst transitionOptions = (state, attrs, isShow) => ({\n  state,\n  attrs,\n  isShow,\n  beforeTransition: isShow\n    ? () => (\n      stopTimer(state),\n      prepareShow(state, attrs)\n    )\n    : () => (\n      stopTimer(state)\n    ),\n  afterTransition: isShow\n    ? () => {\n      // set timer to hide in a few seconds\n      const timeout = attrs.timeout;\n      if (timeout === 0) {\n        // do not time out\n      } else {\n        const timeoutSeconds = timeout !== undefined\n          ? timeout\n          : DEFAULT_TIME_OUT;\n        state.timer.start(() => {\n          hideNotification(state, attrs);\n        }, timeoutSeconds);\n      }     \n    }\n    : null,\n  domElements: {\n    el: state.el,\n    containerEl: state.containerEl,\n  },\n  showClass: classes.visible,\n  defaultDuration: DEFAULT_ANIMATION_DURATION\n});\n\nconst showNotification = (state, attrs) =>\n  transitionComponent(transitionOptions(state, attrs, true));\n\nconst hideNotification = (state, attrs) =>\n  transitionComponent(transitionOptions(state, attrs, false));\n\nconst setTitleStyles = titleEl => {\n  if (isServer) return;\n  const height = titleEl.getBoundingClientRect().height;\n  const lineHeight = parseInt(window.getComputedStyle(titleEl).lineHeight, 10);\n  const paddingTop = parseInt(window.getComputedStyle(titleEl).paddingTop, 10);\n  const paddingBottom = parseInt(window.getComputedStyle(titleEl).paddingBottom, 10);\n  if (height > (lineHeight + paddingTop + paddingBottom)) {\n    titleEl.classList.add(classes.multilineTitle);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  const paused = createStream(false);\n  const mounted = createStream(false);\n  const visible = createStream(false);\n  return {\n    cleanUp:        undefined,\n    containerEl:    undefined,\n    dismissEl:      undefined,\n    el:             undefined,\n    timer:          new Timer(),\n    paused,\n    transitioning,\n    visible,\n    mounted,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.el = dom;\n  const titleEl = state.el.querySelector(`.${classes.title}`);\n  if (titleEl) {\n    setTitleStyles(titleEl);\n  }\n  if (attrs.show && !state.visible()) {\n    showNotification(state, attrs);\n  }\n  state.mounted(true);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.mounted(false)\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.tone === \"light\" ? null : \"pe-dark-tone\", // default dark tone\n        attrs.containerSelector ? classes.hasContainer : null,\n        attrs.layout === \"vertical\" ? classes.vertical : classes.horizontal,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      [k.onclick]: e => e.preventDefault()\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (state.mounted() && !state.transitioning()) {\n    if (attrs.hide && state.visible()) {\n      hideNotification(state, attrs);\n    } else if (attrs.show && !state.visible()) {\n      showNotification(state, attrs);\n    }\n  }\n  if (attrs.pause && !state.paused()) {\n    pause(state, attrs);\n  } else if (attrs.unpause && state.paused()) {\n    unpause(state, attrs);\n  }\n\n  return h(\"div\",\n    {\n      className: classes.content,\n      style: attrs.style,\n    },\n    attrs.content || [\n      attrs.title\n        ? h(\"div\",\n          { className: classes.title },\n          attrs.title\n        )\n        : null,\n      attrs.action\n        ? h(\"div\",\n          { className: classes.action },\n          attrs.action\n        )\n        : null\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nconst buttonPaddingH = 8; // padding, inner text space\n\nexport default {\n  width:                  288,\n  min_height:             80,\n  border_radius:          vars.unit_block_border_radius,\n  title_padding_h:        buttonPaddingH,\n  title_single_padding_v: 14,\n  title_multi_padding_v:  20, // 24 - natural line height\n  side_padding:           24 - buttonPaddingH,\n  font_size:              14,\n  line_height:            20,\n\n  color_light_background: rgba(vars.color_light_background),\n  color_light_text:       rgba(vars.color_light_foreground, vars.blend_light_dark_primary),\n\n  color_dark_background:  rgba(vars.color_dark_background),\n  color_dark_text:        rgba(vars.color_dark_foreground, vars.blend_light_text_primary)\n};\n","const ANIMATION_DURATION = .5;\n\nconst show = ({ el, showDuration, showDelay }) => ({\n  el,\n  showDuration: showDuration || ANIMATION_DURATION,\n  showDelay:    showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = ({ el, hideDuration, hideDelay }) => ({\n  el,\n  hideDuration: hideDuration || ANIMATION_DURATION,\n  hideDelay:    hideDelay || 0,\n  hide:         () => el.style.opacity = 0,\n});\n\nexport default {\n  show,\n  hide\n};\n"],"names":["component","action","content","holder","placeholder","title","hasContainer","horizontal","multilineTitle","vertical","DEFAULT_ANIMATION_DURATION","DEFAULT_TIME_OUT","getElement","vnode","attrs","element","pause","state","paused","timer","unpause","resume","stopTimer","stop","prepareShow","containerEl","isClient","document","querySelector","containerSelector","holderSelector","console","error","classList","add","classes","transitionOptions","isShow","beforeTransition","afterTransition","timeout","timeoutSeconds","undefined","start","hideNotification","domElements","el","showClass","visible","defaultDuration","showNotification","transitionComponent","setTitleStyles","isServer","height","titleEl","getBoundingClientRect","lineHeight","parseInt","window","getComputedStyle","paddingTop","paddingBottom","getInitialState","createStream","transitioning","mounted","cleanUp","dismissEl","Timer","redrawOnUpdate","merge","onMount","dom","show","onUnMount","createProps","k","keys","filterSupportedAttributes","remove","className","tone","layout","class","join","onclick","e","preventDefault","createContent","h","renderer","hide","style","rgba","colorStr","opacity","buttonPaddingH","width","min_height","border_radius","vars","unit_block_border_radius","title_padding_h","title_single_padding_v","title_multi_padding_v","side_padding","font_size","line_height","color_light_background","color_light_text","color_light_foreground","blend_light_dark_primary","color_dark_background","color_dark_text","color_dark_foreground","blend_light_text_primary","ANIMATION_DURATION","showDuration","showDelay","beforeShow","hideDuration","hideDelay"],"mappings":"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"}