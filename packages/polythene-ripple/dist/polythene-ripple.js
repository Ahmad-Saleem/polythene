!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril"),require("polythene-core"),require("polythene-css"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","mithril","polythene-core","polythene-css","polythene-theme"],t):t(e.polythene=e.polythene||{},e.m,e["polythene-core"],e["polythene-css"],e["polythene-theme"])}(this,function(e,t,n,i,r){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t="default"in t?t.default:t;var l={component:"pe-ripple",mask:"pe-ripple__mask",waves:"pe-ripple__waves",constrained:"pe-ripple--constrained",wavesAnimating:"pe-ripple__waves--animating"},c={color:"inherit"},p=function(e){return[o({},e,[i.mixin.fit(),{color:"inherit",borderRadius:"inherit",pointerEvents:"none",".pe-ripple--constrained":{borderRadius:"inherit"," .pe-ripple__mask":{overflow:"hidden",borderRadius:"inherit"}}," .pe-ripple__mask":[i.mixin.fit(),{transform:"translate3d(0,0,0)"}]," .pe-ripple__waves":{outline:"1px solid transparent",position:"absolute",borderRadius:"50%",pointerEvents:"none",display:"none"}," .pe-ripple__waves--animating":{display:"block"}}])]},u=function(e,t,n,i){return[a({},e.map(function(e){return e+t}).join(","),{color:n["color_"+i]||n.color||"inherit"})]},d=function(e,t){return[u([".pe-dark-tone",".pe-dark-tone "],e,t,"dark"),u(["",".pe-light-tone",".pe-light-tone "],e,t,"light")]},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f=[p,d],v="."+l.component,h=function(e,t){return i.styler.generateStyles([e,v],m({},c,t),f)};i.styler.generateStyles([v],c,f);var y=n.animationEndEvent(),g=function(e,t,o,a,l,c){var p=t.getBoundingClientRect(),u=n.isTouch&&e.touches?e.touches[0].pageX:e.clientX,d=n.isTouch&&e.touches?e.touches[0].pageY:e.clientY,m=t.offsetWidth,f=t.offsetHeight,v=Math.sqrt(m*m+f*f),h=a.center?p.left+p.width/2:u,g=a.center?p.top+p.height/2:d,b=h-p.left-v/2,w=g-p.top-v/2,_=void 0!==a.startOpacity?a.startOpacity:.2,k=void 0!==a.opacityDecayVelocity?a.opacityDecayVelocity:.35,E=a.endOpacity||0,O=a.startScale||.1,j=a.endScale||2,x=a.duration?a.duration:1/k*.2,S=window.getComputedStyle(t).color,q="ripple_animation_"+(new Date).getTime(),L=o.style;L.width=L.height=v+"px",L.top=w+"px",L.left=b+"px",L["animation-duration"]=L["-webkit-animation-duration"]=L["-moz-animation-duration"]=L["-o-animation-duration"]=x+"s",L.backgroundColor=S,L.opacity=_,L.animationName=q,L.animationTimingFunction=a.animationTimingFunction||r.vars.animation_curve_default;var P=[s({},"@keyframes "+q,{" 0%":{transform:"scale("+O+")",opacity:_}," 100%":{transform:"scale("+j+")",opacity:E}})];i.styler.add(q,P);var R=function e(t){a.persistent?(L.opacity=E,L.transform="scale("+j+")"):(c(),o.classList.remove(l.wavesAnimating)),o.removeEventListener(y,e,!1),i.styler.remove(q),a.end&&a.end(t)};o.addEventListener(y,R,!1),a.start&&a.start(e),o.classList.add(l.wavesAnimating)},b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},w=void 0,_=function(e){var t=e.state,i=e.attrs;if(e.dom){var r=e.dom,o=e.dom.querySelector("."+l.waves),a=function(e){t.animating||(g(e,r,o,i,l,function(){return t.animating=!1}),t.animating=!0)},s=i.target?i.target():e.dom.parentElement;s.addEventListener(n.touchEndEvent,a,!1),w=function(){s.removeEventListener(n.touchEndEvent,a,!1)}}},k=function(e){var i=e.attrs;if(i.disabled)return null;var r=i.element||"div",o=b({},n.filterSupportedAttributes(i),{class:[l.component,i.constrained!==!1?l.constrained:null,"dark"===i.tone?"pe-dark-tone":null,"light"===i.tone?"pe-light-tone":null,i.class].join(" ")}),a=t("div",{class:l.mask},t("div",{class:l.waves}));return t(r,o,[i.before,a,i.after])},E={theme:h,oninit:function(e){return e.state.animating=!1},oncreate:_,onremove:w,view:k};e.default=E,e.classes=l,e.vars=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-ripple.js.map
