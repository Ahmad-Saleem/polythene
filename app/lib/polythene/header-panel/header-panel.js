define(["polythene/polythene/polythene","mithril","polythene/toolbar/toolbar","css!./header-panel"],function(e,l,o){"use strict";var a,r,t,n;return a={shadowAfterScroll:{waterfall:1,"waterfall-tall":1},noShadow:{seamed:1,cover:1,scroll:1},tallMode:{tall:!0,"waterfall-tall":!0},outerScroll:{scroll:1}},r=function(e){return a.outerScroll[e]?"outer":"main"},t=function(e,l){return a.noShadow[e]?!1:a.shadowAfterScroll[e]&&l?!1:!0},n={view:function(e,a,r,t){return a=a||{},a.toolbar?l.component(o,a.toolbar):a.content?l(".header animate",{className:[a.className||null,r?t:null].join(" ")},a.content):l("div",a)}},{controller:function(){return{headerElem:l.prop(),shadowElem:l.prop(),isTall:l.prop(!1),isTop:l.prop(),tallClass:l.prop(),onScroll:function(l,o,a){var r=l.scrollTop,t=0===r;this.updateStates(r,t,o,a),a.isTop(t),e.observable.trigger("scroll",{ctrl:a,scroller:l,headerElem:a.headerElem()})},updateStates:function(e,l,o,a){var r,n;a.isTop()!==l&&(r=a.shadowElem(),r&&r.classList[t(o,l)?"remove":"add"]("hidden"),n=a.headerElem(),n&&a.isTall()&&n.classList[l?"add":"remove"](a.tallClass()))}}},view:function(o,t){var s,d,i,c,h;t=t||{};var u;return t.mode?u=t.mode:t.header.toolbar?u=t.header.toolbar.mode:t.header.content&&(u=t.header.mode),u=u||"standard",o.isTall(a.tallMode[u]||!1),o.tallClass(t.tallClass||"tall"),t.header=t.header||{},c=t.header?l.component(n,t.header,o.isTall(),o.tallClass()):null,s=t.tag||"div",d=e.componentProps({classList:["header-panel"],props:{mode:u}},t,this,o),h=function(e,l){if(!l){var a=e.querySelector(".header")||e.querySelector(".toolbar");o.headerElem(a),o.updateStates(0,!0,u,o)}},i=l(".outerContainer[vertical][layout]",{config:h,onscroll:"main"!==r(u)?function(){o.onScroll(this,u,o)}:null},[c,l(".mainPanel[flex][vertical][layout]",[l(".mainContainer[flex]",{onscroll:"main"===r(u)?function(){o.onScroll(this,u,o)}:null},t.content?t.content:null),"seamed"===u||t.shadow===!1?null:l(".dropShadow",{config:o.shadowElem})])]),l(s,d,e.embellish(i,t))}}});