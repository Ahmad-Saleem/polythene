{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/dialog-pane.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  base:       \"pe-button\",\n  component:  \"pe-button pe-text-button\",\n  row:        \"pe-button-row\",\n\n  // elements\n  content:    \"pe-button__content\",\n  focus:      \"pe-button__focus\",\n  label:      \"pe-button__label\",\n  wash:       \"pe-button__wash\",\n\n  // states\n  borders:    \"pe-button--borders\",\n  disabled:   \"pe-button--disabled\",\n  focused:    \"pe-button--focus\",\n  inactive:   \"pe-button--inactive\",\n  selected:   \"pe-button--selected\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nconst updateFooterState = vnode => {\n  const state = vnode.state;\n  const footerEl = state.footerEl();\n  if (!footerEl) {\n    return;\n  }\n  const style = window.getComputedStyle(footerEl);\n  const height = footerEl.getBoundingClientRect().height;\n  const minHeight = parseInt(style.minHeight, 10);\n  if (height > minHeight) {\n    footerEl.classList.add(classes.footerHigh);\n  } else {\n    footerEl.classList.remove(classes.footerHigh);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream(null);\n  const headerEl = createStream(null);\n  const isScrolling = createStream(false);\n  const scrollEl = createStream(null);\n  const topOverflow = createStream(false);\n  const el = createStream(null);\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.title}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n    updateFooterState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n  \n  updateScrollOverflowState(vnode);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (borders === \"overflow\" && state.bottomOverflow());\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  max_width:           7 * vars.grid_unit_menu,      // 56   \n  side_padding_mobile: 6 * vars.grid_unit,           // 48\n  padding:             3 * vars.grid_unit_component, // 24\n  header_bottom:       20,\n  header_height:       60,\n  footer_height:       52,\n\n  border_width:        1,\n\n  color_light_title_text:          \"inherit\",\n  color_light_body_text:           \"inherit\",\n  color_light_body_border:         rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_light_background:          \"inherit\",\n\n  color_dark_title_text:           \"inherit\",\n  color_dark_body_text:            \"inherit\",\n  color_dark_body_border:          rgba(vars.color_dark_foreground, vars.blend_dark_border_light),\n  color_dark_background:           \"inherit\",\n};\n"],"names":["getElement","vnode","attrs","element","SCROLL_WATCH_END_TIMER","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","updateFooterState","footerEl","style","window","getComputedStyle","minHeight","parseInt","classList","add","classes","footerHigh","remove","getInitialState","createStream","headerEl","isScrolling","el","undefined","merge","onMount","dom","querySelector","body","footer","title","map","update","cleanUp","unsubscribe","onUnMount","createProps","k","keys","unpackAttrs","borders","showTopBorder","showBottomBorder","withHeader","header","withFooter","footerButtons","filterSupportedAttributes","component","fullBleed","borderTop","borderBottom","tone","className","class","join","formOptions","createContent","h","renderer","content","menu","menuContent","headerWithTitle","onscroll","scrollWatchId","setTimeout","footerWithButtons","buttonClasses","row","actions","rgba","colorStr","opacity","vars","grid_unit_menu","grid_unit","grid_unit_component","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light"],"mappings":"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"}