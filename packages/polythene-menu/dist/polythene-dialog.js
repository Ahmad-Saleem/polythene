!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril"),require("polythene-shadow"),require("polythene-core"),require("polythene-css"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","mithril","polythene-shadow","polythene-core","polythene-css","polythene-theme"],t):t(e.polythene=e.polythene||{},e.m,e["polythene-shadow"],e["polythene-core"],e["polythene-css"],e["polythene-theme"])}(this,function(e,t,n,i,r,o){"use strict";t="default"in t?t.default:t;var u=o.vars.rgba,a={sizes:[1,1.5,2,3,4,5,6,7],min_size:1.5,max_size_small_screen:5,size_factor:o.vars.grid_unit_menu,border_radius:o.vars.unit_block_border_radius,color_light_background:u(o.vars.color_light_background),color_dark_background:u(o.vars.color_dark_background)},l=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},c=function(e,t){return t<e.min_size?e.min_size:t},d=function(e){var t=e.toString().replace(".","-");return"pe-menu--width-"+t},p=function(e,t){var n=c(e,t);return l({},"&."+d(n),{width:e.size_factor*n+"px","max-width":"100%"})},f=function(e,t){return[l({},e,[t.sizes.map(function(e){return p(t,e)}),l({transitionTimingFunction:"ease-out",transitionProperty:"opacity",zIndex:o.vars.z_menu,opacity:0,position:"absolute",width:"100%",minWidth:o.vars.grid_unit_menu*t.min_size+"px","&.pe-menu--width-auto":{width:"auto"},"&.pe-menu--visible":{opacity:1},"&.pe-menu--permanent":{position:"relative",opacity:1}," .pe-menu__content":{width:"100%",borderRadius:t.border_radius+"px"}},"@media (max-width: "+o.vars.unit_screen_size_large+"px)",{"max-width":t.max_size_small_screen*o.vars.grid_unit_menu+"px"})])]},h=function(e,t,n,i){return[l({},e+t,{" .pe-menu__content":{"background-color":n["color_"+i+"_background"]}})]},m=function(e,t){return[h("",e,t,"light"),h(".pe-dark-theme",e,t,"dark"),h(".pe-dark-theme ",e,t,"dark")]},g=[f,m],v=".pe-menu",_=function(e,t){return r.styler.generateStyles([e,v],s({},a,t),g)};r.styler.generateStyles([v],a,g);var b={component:"pe-menu",content:"pe-menu__content",placeholder:"pe-menu--placeholder",visible:"pe-menu--visible",permanent:"pe-menu--permanent",target:"pe-menu--target",width_n:"pe-menu--width-",width_auto:"pe-menu--width-auto",listTile:"pe-list-tile",selectedListTile:"pe-list-tile--selected"},y=-8,w=16,z=1.5,k=function(e,t){if(t.target){var n=document.querySelector("#"+t.target);if(n){var i=void 0!==t.offset?t.offset:w,r=e.el;if(r){var o=e.contentEl,u=t.origin||"top-left",a=t.reposition!==!1,l=0;if(a){var s=o.querySelectorAll("."+b.listTile)[0],c=o.querySelector("."+b.selectedListTile);if(s&&c){var d=s.getBoundingClientRect(),p=c.getBoundingClientRect();l=p.top-d.top}var f=c||s,h=f.getBoundingClientRect(),m=n.getBoundingClientRect(),g=h.height-m.height;l+=g/2}var v=n.getBoundingClientRect(),_=r.parentNode.getBoundingClientRect(),z=function(){return r.style.left=v.left-_.left+i+"px"},k=function(){return r.style.right=v.right-_.right+i+"px"},x=function(){return r.style.top=v.top-_.top-l+y+"px"},T=function(){return r.style.bottom=v.bottom-_.bottom-l+"px"},S={"top-left":function(){return x()&&z()},"top-right":function(){return x()&&k()},"bottom-left":function(){return T()&&z()},"bottom-right":function(){return T()&&k()}};S[u].call()}}}},x=function(e,t){return e.isTransitioning=!0,i.show(s({},t,{el:e.el,showClass:b.visible})).then(function(){e.isTransitioning=!1,e.visible=!0,t.didShow&&t.didShow(t.id)})},T=function(e,n){return e.isTransitioning=!0,i.hide(s({},n,{el:e.el,showClass:b.visible})).then(function(){e.isTransitioning=!1,e.visible=!1,n.didHide&&n.didHide(n.id),t.redraw()})},S=function(e){return e<z?z:e},q=function(e){var t=e.toString().replace(".","-");return b.width_n+t},C=function(e,r){var o=document.body,u=function(){o.addEventListener("click",l)},a=function(){o.removeEventListener("click",l)},l=function(t){t.target!==e.el&&(a(),t.defaultPrevented?T(e,r):T(e,s({},r,{hideDelay:0})))},c=function(){k(e,r),t.redraw()},d=function(t){27===t.which&&T(e,s({},r,{hideDelay:0}))},p=r.element||"div",f=s({},i.filterSupportedAttributes(r),{class:[b.component,r.permanent?b.permanent:null,r.target?b.target:"layout center-center",r.size?q(S(r.size)):null,r.class].join(" "),oncreate:function(t){var n=t.dom;e.el=n,r.permanent||(i.subscribe("resize",c),i.subscribe("keydown",d),setTimeout(function(){u(),x(e,r)},0)),k(e,r)},onremove:function(){i.unsubscribe("resize",c),i.unsubscribe("keydown",d),r.permanent||a()}}),h=t("div",{class:b.content,oncreate:function(t){var n=t.dom;return e.contentEl=n},onclick:function(e){return e.preventDefault()}},[t(n.shadow,{z:e.z,animated:!0}),r.content?r.content:null]);return t(p,f,[r.before,h,r.after])},R={theme:_,oninit:function(e){var t=e.attrs;e.state=s(e.state,{z:void 0!==t.z?t.z:1,el:null,contentEl:null,isTransitioning:!1,visible:t.permanent||!1})},view:function(e){var n=e.state,i=e.attrs;return i.show&&(n.visible=!0),n.visible?C(n,i):t("span",{class:b.placeholder})}};e.menu=R,e.vars=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-dialog.js.map
