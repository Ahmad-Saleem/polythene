{"version":3,"file":"polythene-core-notification.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/layout-holder.js","../src/theme/index.js","../src/notification-instance.js","../src/theme/transitions.js"],"sourcesContent":["export default {\n  component:      \"pe-notification\",\n\n  // elements\n  action:         \"pe-notification__action\",\n  content:        \"pe-notification__content\",\n  holder:         \"pe-notification__holder\",\n  placeholder:    \"pe-notification__placeholder\",\n  title:          \"pe-notification__title\",\n\n  // states\n  hasContainer:   \"pe-notification--container\",\n  horizontal:     \"pe-notification--horizontal\",\n  multilineTitle: \"pe-notification__title--multiline\",\n  vertical:       \"pe-notification--vertical\",\n};","import { vars } from \"polythene-theme\";\nconst rgba = vars.rgba;\n\nconst buttonPaddingH = 8; // padding, inner text space\n\nexport default {\n  width:                  274,\n  min_height:             80,\n  border_radius:          vars.unit_block_border_radius,\n  title_padding_h:        buttonPaddingH,\n  title_single_padding_v: 14,\n  title_multi_padding_v:  20,\n  side_padding:           24 - buttonPaddingH,\n  font_size:              14,\n  line_height:            20,\n\n  color_light_background: rgba(vars.color_light_background),\n  color_light_text:       rgba(vars.color_light_foreground, vars.blend_light_dark_primary),\n\n  color_dark_background:  rgba(vars.color_dark_background),\n  color_dark_text:        rgba(vars.color_dark_foreground, vars.blend_light_text_primary)\n};\n","\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector, componentVars) => [{\n  [selector]: [\n    flex.layoutCenter,\n    {\n      width: componentVars.width + \"px\",\n      minHeight: componentVars.min_height + \"px\",\n      position: \"relative\",\n      padding: \"0 \" + componentVars.side_padding + \"px\",\n      margin: \"0 auto\",\n      borderRadius: componentVars.border_radius + \"px\",\n      pointerEvents: \"all\",\n\n      \" .pe-notification__content\": {\n        width: \"100%\"\n      },\n\n      \" .pe-notification__title\": {\n        padding: componentVars.title_single_padding_v + \"px \" + componentVars.title_padding_h + \"px\",\n        fontSize: componentVars.font_size + \"px\",\n        lineHeight: componentVars.line_height + \"px\"\n      },\n\n      \" .pe-notification__action\": {\n        \" .pe-button\": {\n          margin: 0\n        }\n      },\n\n      \"&.pe-notification--horizontal\": {\n        \" .pe-notification__content\": flex.layoutHorizontal,\n        \" .pe-notification__title\": flex.flex(),\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\",\n          paddingBottom: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutCenter\n      },\n      \"&.pe-notification--vertical\": {\n        \" .pe-notification__content\": flex.layoutVertical,\n        \" .pe-notification__title\": {\n          paddingBottom: \"4px\"\n        },\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutEndJustified\n      }\n    }\n  ]\n}];\n\n","\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n    color: componentVars[\"color_\" + tint + \"_text\"],\n    background: componentVars[\"color_\" + tint + \"_background\"]\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { vars } from \"polythene-theme\";\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector) => [{\n  [selector]: [\n    flex.layoutCenterCenter,\n    {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      zIndex: vars.z_notification,\n      pointerEvents: \"none\",\n\n      \".pe-multiple--screen\": {\n        position: \"fixed\",\n      },\n      \".pe-multiple--container\": {\n        position: \"absolute\",\n      }\n    }\n  ]\n}];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\nimport holderLayout from \"./layout-holder\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nconst holderFns = [holderLayout];\nconst holderSelector = `.${classes.holder}`;\n\nexport const customTheme = (customSelector, customVars) => (\n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns),\n  styler.generateStyles([customSelector, holderSelector], {...vars, ...customVars}, holderFns)\n);\n\nstyler.generateStyles([selector], vars, fns);\nstyler.generateStyles([holderSelector], vars, holderFns);\n","import { filterSupportedAttributes, show, hide } from \"polythene-core\";\nimport { Timer } from \"polythene-utilities\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\nconst DEFAULT_TIME_OUT = 3;\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nexport const theme = customTheme;\n\nconst pauseInstance = state => {\n  state.paused(true);\n  if (state.timer) {\n    state.timer.pause();\n  }\n};\n\nconst unpauseInstance = state => {\n  state.paused(false);\n  if (state.timer) {\n    state.timer.resume();\n  }\n};\n\nconst stopTimer = state => {\n  if (state.timer) {\n    state.timer.stop();\n  }\n};\n\nconst prepareShow = (state, attrs) => {\n  if (!state.containerEl) {\n    state.containerEl = document.querySelector(attrs.containerSelector || attrs.holder);\n  }\n  if (!state.containerEl) {\n    console.error(\"No containerEl found\");\n  }\n  if (attrs.containerSelector) {\n    const holderEl = state.containerEl.querySelector(attrs.holder);\n    holderEl.classList.add(classes.hasContainer);\n  }\n};\n\nconst showInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  prepareShow(state, attrs);\n  const id = state.instanceId;\n  const transitions = attrs.transitions;\n  return show(Object.assign({},\n    attrs,\n    transitions.show(state.containerEl, attrs)\n  )).then(() => {\n    if (attrs.multipleDidShow) {\n      attrs.multipleDidShow(id); // this will call attrs.didShow\n    }\n    // set timer to hide in a few seconds\n    const timeout = attrs.timeout;\n    if (timeout === 0) {\n      // do not time out\n    } else {\n      const timeoutSeconds = timeout !== undefined\n        ? timeout\n        : DEFAULT_TIME_OUT;\n      state.timer.start(() => {\n        hideInstance(state, attrs);\n      }, timeoutSeconds);\n    }\n    state.transitioning(false);\n    state.visible(true);\n  });\n};\n\nconst hideInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  const id = state.instanceId;\n  const transitions = attrs.transitions;\n  return hide(Object.assign({},\n    attrs,\n    transitions.hide(state.containerEl, attrs)\n  )).then(() => {\n    if (attrs.multipleDidHide) {\n      attrs.multipleDidHide(id); // this will call attrs.didHide\n    }\n    state.transitioning(false);\n    state.visible(false);\n  });\n};\n\nconst setTitleStyles = titleEl => {\n  const height = titleEl.getBoundingClientRect().height;\n  const lineHeight = parseInt(window.getComputedStyle(titleEl).lineHeight, 10);\n  const paddingTop = parseInt(window.getComputedStyle(titleEl).paddingTop, 10);\n  const paddingBottom = parseInt(window.getComputedStyle(titleEl).paddingBottom, 10);\n  if (height > (lineHeight + paddingTop + paddingBottom)) {\n    titleEl.classList.add(classes.multilineTitle);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  const paused = createStream(false);\n  const mounted = createStream(false);\n  const visible = createStream(false);\n  return {\n    cleanUp:       undefined,\n    containerEl:   undefined,\n    dismissEl:     undefined,\n    timer:         undefined,\n    el:            undefined,\n    timer:         new Timer(),\n    paused,\n    transitioning,\n    visible,\n    mounted,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.el = vnode.dom;\n  const titleEl = state.el.querySelector(`.${classes.title}`);\n  if (titleEl) {\n    setTitleStyles(titleEl);\n  }\n  if (attrs.show && !state.visible()) {\n    showInstance(state, attrs);\n  }\n  state.mounted(true);\n};\n\nexport const onUnMount = vnode =>\n  vnode.state.mounted(false);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.tone === \"light\" ? null : \"pe-dark-tone\", // default dark tone\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.containerSelector ? classes.hasContainer : null,\n        attrs.layout === \"vertical\" ? classes.vertical : classes.horizontal,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      [k.onclick]: e => e.preventDefault()\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  if (state.mounted() && !state.transitioning()) {\n    if (attrs.hide && state.visible()) {\n      setTimeout(() => hideInstance(state, attrs));\n      // hideInstance(state, attrs);\n    } else if (attrs.show && !state.visible()) {\n      setTimeout(() => showInstance(state, attrs));\n      // showInstance(state, attrs);\n    }\n  }\n  if (attrs.pause && !state.paused()) {\n    pauseInstance(state, attrs);\n  } else if (attrs.unpause && state.paused()) {\n    unpauseInstance(state, attrs);\n  }\n\n  return h(\"div\",\n    {\n      className: classes.content,\n      style: attrs.style\n    },\n    attrs.content || [\n      attrs.title\n        ? h(\"div\",\n            { className: classes.title },\n          attrs.title\n        )\n        : null,\n      attrs.action\n        ? h(\"div\",\n            { className: classes.action },\n          attrs.action\n        )\n        : null\n    ]\n  );\n};\n","const ANIMATION_DURATION = .5;\n\nconst show = (el, attrs) => ({\n  el,\n  showDuration: attrs.showDuration || ANIMATION_DURATION,\n  showDelay:    attrs.showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = (el, attrs) => ({\n  el,\n  hideDuration: attrs.hideDuration || ANIMATION_DURATION,\n  hideDelay:    attrs.hideDelay || 0,\n  hide:         () => el.style.opacity = 0,\n});\n\nexport default {\n  show,\n  hide\n};\n"],"names":["rgba","vars","unit_block_border_radius","color_light_background","color_light_foreground","blend_light_dark_primary","color_dark_background","color_dark_foreground","blend_light_text_primary","selector","componentVars","flex","layoutCenter","width","min_height","side_padding","border_radius","title_single_padding_v","title_padding_h","font_size","line_height","layoutHorizontal","title_multi_padding_v","layoutVertical","layoutEndJustified","style","scopes","tint","map","s","join","layoutCenterCenter","z_notification","fns","layout","color","classes","component","holderFns","holderLayout","holderSelector","holder","customTheme","customSelector","customVars","styler","generateStyles","getElement","vnode","attrs","element","theme","pauseInstance","paused","state","timer","pause","unpauseInstance","resume","stopTimer","stop","prepareShow","containerEl","document","querySelector","containerSelector","error","classList","add","hasContainer","showInstance","transitioning","Promise","resolve","id","instanceId","transitions","show","_extends","then","multipleDidShow","timeout","timeoutSeconds","undefined","start","visible","hideInstance","hide","multipleDidHide","setTitleStyles","titleEl","getBoundingClientRect","height","parseInt","window","getComputedStyle","lineHeight","paddingTop","paddingBottom","multilineTitle","getInitialState","createStream","mounted","Timer","merge","onMount","dom","el","title","onUnMount","createProps","k","keys","filterSupportedAttributes","tone","vertical","horizontal","className","class","onclick","e","preventDefault","createContent","h","renderer","unpause","content","action","showDuration","showDelay","opacity","hideDuration","hideDelay"],"mappings":"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"}