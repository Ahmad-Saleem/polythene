{"version":3,"file":"polythene-react-base.js","sources":["../src/keys.js","../src/renderer.js","../src/statefulComponent.js","../src/viewComponent.js","../src/Conditional.js"],"sourcesContent":["\nexport const keys = {\n  class:       \"className\",\n  formaction:  \"formAction\",\n  onblur:      \"onBlur\",\n  onclick:     \"onClick\",\n  onfocus:     \"onFocus\",\n  onkeydown:   \"onKeyDown\",\n  onkeyup:     \"onKeyUp\",\n  onmousedown: \"onMouseDown\",\n  onmouseout:  \"onMouseOut\",\n  onmouseover: \"onMouseOver\",\n  onmouseup:   \"onMouseUp\",\n  tabindex:    \"tabIndex\",\n};\n\nexport const normalizeKey = key => keys[key.toLowerCase()];\n","import h from \"react-hyperscript\";\n\nexport const renderer = h;\n\nrenderer.trust = (html, element = \"div\") => {\n  if (html == null) html = \"\";\n  return h(element, {\n    dangerouslySetInnerHTML: { __html: html }\n  });\n};","import { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\n\nconst requiresKeys = true;\n\nexport const statefulComponent = ({\n  createContent,\n  createProps,\n  element,\n  getInitialState = () => ({}),\n  onMount = () => {},\n  onUnmount = () => {},\n  state = {},\n}) => {\n  \n  return class extends Component {\n    \n    constructor(props) {\n      super(props);\n      this.state = {\n        now: Date.now()\n      };\n      // Store the state we are interested in in a private property\n      this._state = Object.assign({}, state, getInitialState(props));\n    }\n\n    componentDidMount() {\n      onMount(this.createVirtualNode());\n    }\n\n    componentWillUnmount() {\n      onUnmount(this.createVirtualNode());\n    }\n\n    updateState(attr, value, callback) {\n      this._state[attr] = value;\n      // Force new render\n      this.setState({\n        now: Date.now()\n      }, callback);\n    }\n\n    createVirtualNode() {\n      const props = Object.assign({}, this.props);\n      return {\n        state: this._state,\n        attrs: props,\n        children: props.children,\n        dom: this.dom,\n        updateState: this.updateState.bind(this)\n      };\n    }\n\n    render() {\n      const vnode = this.createVirtualNode();\n      return renderer(\n        vnode.attrs.element || element,\n        Object.assign(\n          {},\n          createProps(vnode, { renderer, requiresKeys, keys }),\n          { ref: reactComponent => {\n            if (!this.dom) {\n              this.dom = ReactDOM.findDOMNode(reactComponent);\n            }\n          }}\n        ),\n        [\n          vnode.attrs.before,\n          createContent(vnode, { renderer, requiresKeys, keys }),\n          vnode.attrs.after\n        ]\n      );\n    }\n  };\n};\n","import { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\n\nconst requiresKeys = true;\n\nexport const viewComponent = ({\n  createContent,\n  createProps,\n  element,\n}) => {\n  \n  return class extends Component {\n\n    createVirtualNode() {\n      const props = Object.assign({}, this.props);\n      return {\n        attrs: props,\n        children: props.children,\n        dom: this.dom\n      };\n    }\n\n    render() {\n      const vnode = this.createVirtualNode();\n      return renderer(\n        vnode.attrs.element || element,\n        Object.assign(\n          {},\n          createProps(vnode, { renderer, requiresKeys, keys }),\n          { ref: reactComponent => {\n            if (!this.dom) {\n              this.dom = ReactDOM.findDOMNode(reactComponent);\n            }\n          }}\n        ),\n        [\n          vnode.attrs.before,\n          createContent(vnode, { renderer, requiresKeys, keys }),\n          vnode.attrs.after\n        ]\n      );\n    }\n  };\n};\n","import { Component } from \"react\";\nimport { renderer } from \"./renderer\";\n\nclass Conditional extends Component {\n    \n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: props.permanent || props.show || false,\n      transitioning: false\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.permanent || this.state.transitioning) {\n      return;\n    }\n    if (!this.state.visible && nextProps.show) {\n      this.setState({\n        visible: true\n      });\n    } else if (this.state.visible && nextProps.hide) {\n      this.setState({\n        visible: false\n      });\n    }\n  }\n\n  render() {\n    return this.state.visible\n      ? renderer(this.props.instance,\n          Object.assign(\n            {},\n            this.props,\n            {\n              setVisible: value => this.setState({ visible: value }),\n              setTransitioning: value => this.setState({ transitioning: value })\n            }\n          )\n        )\n      : renderer(\"span\", { className: this.props.placeholderClassName });\n  }\n}\n\nexport { Conditional };\n"],"names":["keys","renderer","h","trust","html","element","__html","statefulComponent","createContent","createProps","getInitialState","onMount","onUnmount","state","props","Date","now","_state","_extends","this","createVirtualNode","attr","value","callback","setState","children","dom","updateState","bind","vnode","attrs","requiresKeys","ref","_this2","ReactDOM","findDOMNode","reactComponent","before","after","Component","viewComponent","Conditional","permanent","show","nextProps","transitioning","visible","hide","instance","className","placeholderClassName"],"mappings":"mlEACO,IAAMA,UACE,uBACA,oBACA,iBACA,kBACA,oBACA,oBACA,sBACA,yBACA,yBACA,wBACA,qBACA,YCXFC,EAAWC,CAExBD,GAASE,MAAQ,SAACC,MAAMC,0DAAU,YACpB,OAARD,IAAcA,EAAO,IAClBF,EAAEG,4BACoBC,OAAQF,maCA1BG,EAAoB,eAC/BC,KAAAA,cACAC,IAAAA,YACAJ,IAAAA,YACAK,gBAAAA,aAAkB,2BAClBC,QAAAA,aAAU,mBACVC,UAAAA,aAAY,mBACZC,MAAAA,gDAKcC,4EACJA,aACDD,WACEE,KAAKC,SAGPC,OAASC,KAAkBL,EAAOH,EAAgBI,qEAI/CK,KAAKC,sEAIHD,KAAKC,yDAGLC,EAAMC,EAAOC,QAClBN,OAAOI,GAAQC,OAEfE,cACET,KAAKC,OACTO,kDAIGT,GAAQI,KAAkBC,KAAKL,oBAE5BK,KAAKF,aACLH,WACGA,EAAMW,aACXN,KAAKO,gBACGP,KAAKQ,YAAYC,KAAKT,mDAK/BU,EAAQV,KAAKC,0BACZnB,GACL4B,EAAMC,MAAMzB,SAAWA,EACvBa,KAEET,EAAYoB,GAAS5B,WAAU8B,cAxDpB,EAwDkC/B,UAC3CgC,IAAK,YACAC,EAAKP,QACHA,IAAMQ,EAASC,YAAYC,QAKpCP,EAAMC,MAAMO,OACZ7B,EAAcqB,GAAS5B,WAAU8B,cAjEtB,EAiEoC/B,SAC/C6B,EAAMC,MAAMQ,eAtDCC,uaCVVC,EAAgB,eAC3BhC,KAAAA,cACAC,IAAAA,YACAJ,IAAAA,+LAMUS,GAAQI,KAAkBC,KAAKL,oBAE5BA,WACGA,EAAMW,aACXN,KAAKO,iDAKNG,EAAQV,KAAKC,0BACZnB,GACL4B,EAAMC,MAAMzB,SAAWA,EACvBa,KAEET,EAAYoB,GAAS5B,WAAU8B,cAzBpB,EAyBkC/B,UAC3CgC,IAAK,YACAC,EAAKP,QACHA,IAAMQ,EAASC,YAAYC,QAKpCP,EAAMC,MAAMO,OACZ7B,EAAcqB,GAAS5B,WAAU8B,cAlCtB,EAkCoC/B,SAC/C6B,EAAMC,MAAMQ,eA3BCC,uaCVjBE,yBAEQ3B,4EACJA,aACDD,eACMC,EAAM4B,WAAa5B,EAAM6B,OAAQ,iBAC3B,wEAIOC,GACpBA,EAAUF,WAAavB,KAAKN,MAAMgC,iBAGjC1B,KAAKN,MAAMiC,SAAWF,EAAUD,UAC9BnB,mBACM,IAEFL,KAAKN,MAAMiC,SAAWF,EAAUG,WACpCvB,mBACM,uDAMNL,MAAKN,MAAMiC,QACd7C,EAASkB,KAAKL,MAAMkC,SAClB9B,KAEEC,KAAKL,kBAES,kBAASmB,GAAKT,UAAWsB,QAASxB,sBAC5B,kBAASW,GAAKT,UAAWqB,cAAevB,QAIhErB,EAAS,QAAUgD,UAAW9B,KAAKL,MAAMoC,8BArCvBX"}