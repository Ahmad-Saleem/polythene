{"version":3,"file":"polythene-core-base-spinner.js","sources":["../../polythene-css-classes/base-spinner.js","../src/spinner.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:   \"pe-spinner\",\n\n  // elements\n  animation:   \"pe-spinner__animation\",\n  placeholder: \"pe-spinner__placeholder\",\n\n  // states\n  animated:    \"pe-spinner--animated\",\n  fab:         \"pe-spinner--fab\",\n  large:       \"pe-spinner--large\",\n  medium:      \"pe-spinner--medium\",\n  permanent:   \"pe-spinner--permanent\",\n  raised:      \"pe-spinner--raised\",\n  regular:     \"pe-spinner--regular\",\n  singleColor: \"pe-spinner--single-color\",\n  small:       \"pe-spinner--small\",\n  visible:     \"pe-spinner--visible\",\n};\n","import { filterSupportedAttributes, show, hide } from \"polythene-core\";\nimport classes from \"polythene-css-classes/base-spinner\";\n\nconst sizeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large,\n  fab:     classes.fab\n};\n\nconst classForSize = (size = \"regular\") => sizeClasses[size];\n\nconst showSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: false, transitioning: true });\n  }\n  return show(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: true, transitioning: false });\n    }\n    if (attrs.didShow) {\n      attrs.didShow(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nconst hideSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: true, transitioning: true });\n  }\n  return hide(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: false, transitioning: false });\n    }\n    if (attrs.didHide) {\n      attrs.didHide(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const visible = createStream(false);\n  const dom = createStream(null);\n  return {\n    dom,\n    visible,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.dom(vnode.dom);\n\n  if (!attrs.permanent) {\n    showSpinner(state, attrs);\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass,\n        classForSize(attrs.size),\n        attrs.singleColor ? classes.singleColor: null,\n        attrs.raised ? classes.raised : null,\n        attrs.animated ? classes.animated : null,\n        attrs.permanent ? classes.permanent : null,\n        attrs.permanent ? classes.visible : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.events\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, Shadow }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  if (state.hide) {\n    setTimeout(() => { hideSpinner(state, attrs); }, 0);\n  }\n\n  return [\n    attrs.raised && attrs.content\n      ? h(Shadow, { key: \"shadow\", z: attrs.z })\n      : null,\n    attrs.content\n  ];\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n  \nexport default {\n  size_small:   3 * vars.grid_unit_component,\n  size_regular: 4 * vars.grid_unit_component,\n  size_medium:  5 * vars.grid_unit_component,\n  size_large:   6 * vars.grid_unit_component,\n  size_fab:     7 * vars.grid_unit_component,\n\n  raisedSize: size => {\n    const padding = size * 0.25;\n    const paddedSize = size + padding * 2;\n    return { padding, paddedSize };\n  },\n\n  color_light_raised_background: rgba(vars.color_light_background),\n  // also use light background with dark tone\n  color_dark_raised_background: rgba(vars.color_light_background)\n};\n"],"names":["component","animation","placeholder","animated","fab","large","medium","permanent","raised","regular","singleColor","small","visible","sizeClasses","classes","classForSize","size","showSpinner","state","attrs","onChange","transitioning","show","el","dom","showClass","then","didShow","id","hideSpinner","hide","didHide","getInitialState","vnode","createStream","redrawOnUpdate","merge","onMount","createProps","k","keys","filterSupportedAttributes","className","instanceClass","class","join","events","createContent","h","renderer","Shadow","setTimeout","content","key","z","rgba","colorStr","opacity","size_small","vars","grid_unit_component","size_regular","size_medium","size_large","size_fab","raisedSize","padding","paddedSize","color_light_raised_background","color_light_background","color_dark_raised_background"],"mappings":"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"}