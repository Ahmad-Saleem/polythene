{"version":3,"file":"polythene-core.js","sources":["../src/iso.js","../src/animation-event.js","../src/Conditional.js","../src/attrs.js","../src/pointer.js","../src/events.js","../src/multi.js","../src/transition.js","../src/style.js"],"sourcesContent":["export const isClient = typeof document !== \"undefined\";\nexport const isServer = !isClient;\n","import { isClient } from \"./iso\";\n\nconst evts = {\n  \"animation\": \"animationend\",\n  \"OAnimation\": \"oAnimationEnd\",\n  \"MozAnimation\": \"animationend\",\n  \"WebkitAnimation\": \"webkitAnimationEnd\"\n};\n\nexport const getAnimationEndEvent = () => {\n  if (isClient) {\n    const el = document.createElement(\"fakeelement\");\n    for (let a in evts) {\n      if (el.style[a] !== undefined) {\n        return evts[a];\n      }\n    }\n  }\n};\n","\nexport const Conditional = {\n  view: (vnode, { renderer: h }) => {\n    const attrs = vnode.attrs;\n    return attrs.permanent || attrs.show\n      ? h(attrs.instance, attrs)\n      : h(\"span\", { className: attrs.placeholderClassName });\n  }\n};\n\nConditional.displayName = \"Conditional\";\n","\nconst r = (acc, p) => (acc[p] = 1, acc);\n\n/* \nSeparately handled props:\n- class\n- element\n*/\n\nconst defaultAttrs = [\n  // Universal\n  \"key\",\n  \"style\",\n  \"href\",\n  \"id\",\n  \n  // React\n  \"tabIndex\",\n\n  // Mithril\n  \"tabindex\",\n  \"oninit\",\n  \"oncreate\",\n  \"onupdate\",\n  \"onbeforeremove\",\n  \"onremove\",\n  \"onbeforeupdate\",\n];\n\nexport const filterSupportedAttributes = (attrs, { add: addAttrs = [], remove: removeAttrs = []} = {} ) => {\n  const removeLookup = removeAttrs.reduce(r, {});\n  const supported = defaultAttrs.concat(addAttrs).filter(item => !removeLookup[item]).reduce(r, {});\n  return Object.keys(attrs).reduce((acc, key) => (\n    supported[key]\n      ? acc[key] = attrs[key]\n      : null,\n    acc\n  ), {});\n};\n\nexport const unpackAttrs = attrs =>\n  typeof attrs === \"function\"\n    ? attrs()\n    : attrs;\n","import { isClient, isServer } from \"./iso\";\n\nexport const isTouch = isServer\n  ? false\n  : \"ontouchstart\" in document.documentElement;\n\nexport const pointerStartEvent = isTouch\n  ? \"click\"\n  : \"mousedown\";\n\nexport const pointerEndEvent = isTouch\n  ? \"click\"\n  : \"mouseup\";\n\nexport const pointerStartMoveEvent = isTouch\n  ? \"touchstart\"\n  : \"mousedown\";\n\nexport const pointerMoveEvent = isTouch\n  ? \"touchmove\"\n  : \"mousemove\";\n\nexport const pointerEndMoveEvent = isTouch\n  ? \"touchend\"\n  : \"mouseup\";\n\nif (isClient) {\n  document.querySelector(\"html\").classList.add(isTouch ? \"pe-touch\" : \"pe-no-touch\");\n}\n","import { pointerEndEvent } from \"./pointer\";\nimport { isClient } from \"./iso\";\n\nconst listeners = {};\n\n// https://gist.github.com/Eartz/fe651f2fadcc11444549\nexport const throttle = (func, s = 0.05, context = isClient ? window : {}) => {\n  let wait = false;\n  return (...args) => {\n    const later = () => func.apply(context, args);\n    if (!wait) {\n      later();\n      wait = true;\n      setTimeout(() => wait = false, s);\n    }\n  };\n};\n\nexport const subscribe = (eventName, listener, delay) => {\n  listeners[eventName] = listeners[eventName] || [];\n  listeners[eventName].push(delay ? throttle(listener, delay) : listener);\n};\n\nexport const unsubscribe = (eventName, listener) => {\n  if (!listeners[eventName]) {\n    return;\n  }\n  const index = listeners[eventName].indexOf(listener);\n  if (index > -1) {\n    listeners[eventName].splice(index, 1);\n  }\n};\n\nexport const emit = (eventName, event) => {\n  if (!listeners[eventName]) {\n    return;\n  }\n  listeners[eventName].forEach(listener => listener(event));\n};\n\nif (isClient) {\n  window.addEventListener(\"resize\",      e => emit(\"resize\", e));\n  window.addEventListener(\"scroll\",      e => emit(\"scroll\", e));\n  window.addEventListener(\"keydown\",     e => emit(\"keydown\", e));\n  window.addEventListener(pointerEndEvent, e => emit(pointerEndEvent, e));\n}\n","/*\nHelper module to manage multiple items of the same component type.\n*/\n\nimport { isClient } from \"./iso\";\nimport { unpackAttrs } from \"./attrs\";\nimport { emit } from \"./events\";\n\nexport const Multi = ({ options: mOptions, renderer }) => {\n\n  const items = []; // This is shared between all instances of a type (Dialog, Notification, ...)\n  let current;\n  \n  const getInitialState = (vnode, createStream) => {\n    current = createStream(null);\n    return {\n      current,\n      redrawOnUpdate: createStream.merge([current])\n    };\n  };\n\n  /*\n  @param e: { id, eventName }\n  */\n  const onChange = e => {\n    if (!current) {\n      console.error(\"Cannot set state. Did you set a root element like Dialog to show instances?\"); // eslint-disable-line no-console\n    }\n    current(e.id);\n    emit(mOptions.name, e);\n  };\n\n  const itemIndex = id => {\n    const item = findItem(id);\n    return items.indexOf(item);\n  };\n\n  const removeItem = id => {\n    const index = itemIndex(id);\n    if (index !== -1) {\n      items.splice(index, 1);\n      onChange({ id, name: \"removeItem\" });\n    }\n  };\n\n  const replaceItem = (id, newItem) => {\n    const index = itemIndex(id);\n    if (index !== -1) {\n      items[index] = newItem;\n    }\n  };\n\n  const findItem = id => {\n    // traditional for loop for IE10\n    for (let i = 0; i < items.length; i++) {\n      if (items[i].instanceId === id) {\n        return items[i];\n      }\n    }\n  };\n\n  const next = () => {\n    if (items.length) {\n      items[0].show = true;\n    }\n    onChange({ id: items.length ? items[0].instanceId : null, name: \"next\" });\n  };\n\n  const remove = (instanceId = mOptions.defaultId) => {\n    if (mOptions.queue) {\n      items.shift();\n      next();\n    } else {\n      removeItem(instanceId);\n    }\n  };\n\n  const removeAll = () => {\n    items.length = 0;\n    onChange({ id: null, name: \"removeAll\" });\n  };\n\n  const setPauseState = (pause, instanceId) => {\n    const item = findItem(instanceId);\n    if (item) {\n      item.pause = pause;\n      item.unpause = !pause;\n      onChange({ id: instanceId, name: pause ? \"pause\" : \"unpause\" });\n    }\n  };\n\n  const createItem = (itemAttrs, instanceId, spawn) => {\n    let resolveShow;\n    let resolveHide;\n    const attrs = unpackAttrs(itemAttrs);\n\n    const didShow = () => {\n      if (attrs.didShow) {\n        attrs.didShow(instanceId);\n      }\n      onChange({ id: instanceId, name: \"didShow\" });\n      return resolveShow(instanceId);\n    };\n    const showPromise = new Promise(resolve => \n      resolveShow = resolve\n    );\n\n    const didHide = () => {\n      if (attrs.didHide) {\n        attrs.didHide(instanceId);\n      }\n      onChange({ id: instanceId, name: \"didHide\" });\n      remove(instanceId);\n      return resolveHide(instanceId);\n    };\n\n    const hidePromise = new Promise(resolve => resolveHide = resolve);\n\n    return Object.assign(\n      {},\n      mOptions,\n      {\n        instanceId,\n        spawn,\n        attrs: itemAttrs,\n        show: mOptions.queue ? false : true,\n        showPromise,\n        hidePromise,\n        didShow,\n        didHide\n      }\n    );\n  };\n\n  const count = () => items.length;\n  const pause = (instanceId = mOptions.defaultId) => setPauseState(true, instanceId);\n  const unpause = (instanceId = mOptions.defaultId) => setPauseState(false, instanceId);\n\n  const show = (attrs = {}, spawnOpts = {}) => {\n    const instanceId = spawnOpts.id || mOptions.defaultId;\n    const spawn = spawnOpts.spawn || mOptions.defaultId;\n    const item = createItem(attrs, instanceId, spawn);\n    onChange({ id: instanceId, name: \"show\" });\n    if (mOptions.queue) {\n      items.push(item);\n      if (items.length === 1) {\n        next();\n      }\n    } else {\n      const storedItem = findItem(instanceId);\n      if (!storedItem) {\n        items.push(item);\n      } else {\n        replaceItem(instanceId, item);\n      }\n    }\n    return item.showPromise;\n  };\n\n  const hide = (spawnOpts = {}) => {\n    const instanceId = spawnOpts.id || mOptions.defaultId;\n    const item = mOptions.queue && items.length\n      ? items[0]\n      : findItem(instanceId);\n    if (item) {\n      item.hide = true;\n    }\n    onChange({ id: instanceId, name: \"hide\" });\n    return item\n      ? item.hidePromise\n      : Promise.resolve(instanceId);\n  };\n\n  const clear = removeAll;\n\n  const view = ({ attrs }) => {\n    const spawn = attrs.spawn || mOptions.defaultId;\n    const candidates = items.filter(item => \n      item.show && item.spawn === spawn\n    );\n    if (mOptions.htmlShowClass && isClient && document.documentElement) {\n      document.documentElement.classList[candidates.length ? \"add\" : \"remove\"](mOptions.htmlShowClass);\n    }\n    return !candidates.length\n      ? renderer(mOptions.placeholder) // placeholder because we cannot return null\n      : renderer(mOptions.holderSelector,\n        {\n          className: attrs.position === \"container\"\n            ? \"pe-multiple--container\"\n            : \"pe-multiple--screen\"\n        },\n        candidates.map(itemData => {\n          return renderer(mOptions.instance, Object.assign(\n            {},\n            {\n              key: itemData.key,\n              spawnId: spawn,\n              instanceId: itemData.instanceId,\n              transitions: mOptions.transitions,\n              holderSelector: mOptions.holderSelector,\n              className: mOptions.className,\n              show: itemData.show,\n              hide: itemData.hide,\n              pause: itemData.pause,\n              unpause: itemData.unpause,\n              fromMultipleDidShow: itemData.didShow,\n              fromMultipleDidHide: itemData.didHide,\n              fromMultipleClear: clear\n            },\n            unpackAttrs(itemData.attrs)\n          ));\n        })\n      );\n  };\n\n  return {\n    clear,\n    count,\n    getInitialState,  \n    hide,\n    pause,\n    remove,\n    show,\n    unpause,\n    view,\n  };\n};\n\nMulti.displayName = \"Multi\";\n","/*\nGeneric show/hide transition module\n*/\n\n// defaults\nconst SHOW_DURATION = .220; // default dialog timing\nconst HIDE_DURATION = .200; // default dialog timing\nconst SHOW_DELAY =    0;\nconst HIDE_DELAY =    0;\nconst TRANSITION =    \"both\";\n\n// See: transition\nexport const show = opts =>\n  transition(opts, \"show\");\n\nexport const hide = opts =>\n  transition(opts, \"hide\");\n\nconst getTiming = (opts, state, showAttr, hideAttr, defaultShowTiming, defaultHideTiming) => {\n  const transition = opts.transition || TRANSITION;\n  if (transition === \"none\") {\n    return 0;\n  } else if (transition === \"show\" && state === \"hide\") {\n    return 0;\n  } else if (transition === \"hide\" && state === \"show\") {\n    return 0;\n  } else {\n    // both\n    return state === \"show\"\n      ? opts[showAttr] !== undefined\n        ? opts[showAttr]\n        : defaultShowTiming\n      : opts[hideAttr] !== undefined\n        ? opts[hideAttr]\n        : defaultHideTiming;\n  }\n};\n\n/*\nopts:\n- transition\n- showDuration\n- hideDuration\n\n- state (show, hide)\n*/\nconst getDuration = (opts, state) => \n  getTiming(opts, state, \"showDuration\", \"hideDuration\", SHOW_DURATION, HIDE_DURATION);\n\n/*\nopts:\n- transition (show, hide, both)\n- showDelay\n- hideDelay\n\n- state (show, hide)\n*/\nconst getDelay = (opts, state) =>\n  getTiming(opts, state, \"showDelay\", \"hideDelay\", SHOW_DELAY, HIDE_DELAY);\n\n/*\nopts:\n- el\n- duration\n- delay\n- showClass\n- beforeShow\n- show\n- hide\n- afterHide\n- showDelay\n- hideDelay\n\n- state (show, hide)\n*/\nconst transition = (opts, state) => {\n  const el = opts.el;\n  if (!el) {\n    return Promise.resolve();\n  } else {\n    return new Promise(resolve => {\n      const transitionDuration = getDuration(opts, state) * 1000;\n      const delay = getDelay(opts, state) * 1000;\n      const style = el.style;\n      const beforeTransition = (opts.beforeShow && state === \"show\")\n        ? () => {\n          style.transitionDuration = \"0ms\";\n          style.transitionDelay = \"0ms\";\n          opts.beforeShow();\n        }\n        : null;\n\n      const afterTransition = opts.afterHide && state === \"hide\"\n        ? () => opts.afterHide()\n        : null;\n\n      const applyTransition = () => {\n        style.transitionDuration = transitionDuration + \"ms\";\n        style.transitionDelay = delay + \"ms\";\n        \n        if (opts.showClass) {\n          el.classList[(state === \"show\") ? \"add\" : \"remove\"](opts.showClass);\n        }\n        if (opts.show && typeof opts.show === \"function\" && state === \"show\") {\n          opts.show();\n        }\n        if (opts.hide && typeof opts.hide === \"function\" && state === \"hide\") {\n          opts.hide();\n        }\n      };\n\n      const doTransition = () => {\n        applyTransition();\n        setTimeout(() => {\n          if (afterTransition) {\n            afterTransition();\n          }\n          resolve();\n        }, transitionDuration + delay);\n      };\n\n      const maybeDelayTransition = () => {\n        if (transitionDuration === 0) {\n          doTransition();\n        } else {\n          setTimeout(doTransition, 0);\n        }\n      };\n\n      if (beforeTransition) {\n        beforeTransition();\n        el.offsetHeight; // force reflow\n        setTimeout(() => {\n          maybeDelayTransition();\n        }, 0);\n      } else {\n        maybeDelayTransition();\n      }\n    });\n  }\n};\n","\nexport const getStyle = ({ element = document, selector, prop }) => {\n  const el = selector\n    ? element.querySelector(selector)\n    : element;\n  return el.currentStyle\n    ? el.currentStyle[prop]\n    : window.getComputedStyle\n      ? document.defaultView.getComputedStyle(el, null).getPropertyValue(prop)\n      : null;\n};\n\nexport const isRTL = ({ element = document, selector }) => \n  getStyle({ element, selector, prop: \"direction\" }) === \"rtl\";"],"names":["isClient","document","isServer","evts","getAnimationEndEvent","el","createElement","a","style","undefined","Conditional","vnode","h","renderer","attrs","permanent","show","instance","className","placeholderClassName","displayName","r","acc","p","defaultAttrs","filterSupportedAttributes","add","addAttrs","remove","removeAttrs","removeLookup","reduce","supported","concat","filter","item","Object","keys","key","unpackAttrs","isTouch","documentElement","pointerStartEvent","pointerEndEvent","pointerStartMoveEvent","pointerMoveEvent","pointerEndMoveEvent","querySelector","classList","listeners","throttle","func","s","context","window","wait","args","later","apply","subscribe","eventName","listener","delay","push","unsubscribe","index","indexOf","splice","emit","event","forEach","addEventListener","e","Multi","mOptions","options","items","current","getInitialState","createStream","merge","onChange","error","id","name","itemIndex","findItem","removeItem","replaceItem","newItem","i","length","instanceId","next","defaultId","queue","shift","removeAll","setPauseState","pause","unpause","createItem","itemAttrs","spawn","resolveShow","resolveHide","didShow","showPromise","Promise","resolve","didHide","hidePromise","count","spawnOpts","storedItem","hide","clear","view","candidates","htmlShowClass","placeholder","holderSelector","position","map","itemData","transitions","SHOW_DURATION","HIDE_DURATION","SHOW_DELAY","HIDE_DELAY","TRANSITION","transition","opts","getTiming","state","showAttr","hideAttr","defaultShowTiming","defaultHideTiming","getDuration","getDelay","transitionDuration","beforeTransition","beforeShow","transitionDelay","afterTransition","afterHide","applyTransition","showClass","doTransition","maybeDelayTransition","offsetHeight","getStyle","element","selector","prop","currentStyle","getComputedStyle","defaultView","getPropertyValue","isRTL"],"mappings":"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"}