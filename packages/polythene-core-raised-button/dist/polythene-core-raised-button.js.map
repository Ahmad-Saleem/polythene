{"version":3,"file":"polythene-core-raised-button.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/color.js","../src/theme/index.js","../src/raised-button.js"],"sourcesContent":["\nexport default {\n  component: \"pe-button pe-text-button pe-raised-button\"\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = vars.rgba;\n\nexport default {\n  color_light_background:          \"#e0e0e0\", // grey-300\n  color_light_text:                rgba(vars.color_light_foreground, vars.blend_light_text_primary),\n  color_light_hover_background:    \"transparent\",\n  color_light_focus_background:    rgba(vars.color_light_foreground, vars.blend_light_background_hover),\n  color_light_active_background:   rgba(vars.color_light_foreground, vars.blend_light_background_hover), // same as hover\n  color_light_disabled_background: rgba(vars.color_light_foreground, vars.blend_light_background_disabled),\n  color_light_disabled_text:       rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n\n  color_dark_background:           rgba(vars.color_primary),\n  color_dark_text:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_primary),\n  color_dark_hover_background:     vars.color_primary_active,\n  color_dark_focus_background:     vars.color_primary_active,\n  color_dark_active_background:    vars.color_primary_dark,\n  color_dark_disabled_background:  rgba(vars.color_dark_foreground, vars.blend_dark_background_disabled),\n  color_dark_disabled_text:        rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled)\n};","\nconst style = (scopes, selector, componentVars, tint) => {\n  const normalBorder   = componentVars[\"color_\" + tint + \"_border\"]          || \"transparent\";\n  const activeBorder   = componentVars[\"color_\" + tint + \"_active_border\"]   || normalBorder;\n  const disabledBorder = componentVars[\"color_\" + tint + \"_disabled_border\"] || normalBorder;\n  return [{\n    [scopes.map(s => s + selector).join(\",\")]: {\n      \"&, &:link, &:visited\": {\n        color: componentVars[\"color_\" + tint + \"_text\"]\n      },\n\n      \" .pe-button__content\": {\n        backgroundColor: componentVars[\"color_\" + tint + \"_background\"],\n        borderColor: normalBorder\n      },\n\n      \".pe-button--disabled\": {\n        color: componentVars[\"color_\" + tint + \"_disabled_text\"],\n\n        \" .pe-button__content\": {\n          backgroundColor: componentVars[\"color_\" + tint + \"_disabled_background\"],\n          borderColor: disabledBorder\n        }\n      },\n\n      \".pe-button--selected\": {\n        \" .pe-button__content\": {\n          backgroundColor: componentVars[\"color_\" + tint + \"_active_background\"],\n          borderColor: activeBorder\n        },\n        \" .pe-button__focus\": {\n          opacity: 1,\n          backgroundColor: componentVars[\"color_\" + tint + \"_focus_background\"]\n        }\n      },\n\n      \".pe-button--focus\": {\n        \" .pe-button__focus\": {\n          opacity: 1,\n          backgroundColor: componentVars[\"color_\" + tint + \"_focus_background\"]\n        }\n      }\n    }\n  }];\n};\n\nconst noTouchStyle = (scopes, selector, componentVars, tint) => {\n  const normalBorder = componentVars[\"color_\" + tint + \"_border\"];\n  const hoverBorder = componentVars[\"color_\" + tint + \"_border\"] || normalBorder;\n  return [{\n    [scopes.map(s => s + selector + \":hover\").join(\",\")]: {\n      \":not(.pe-button--selected):not(.pe-button--inactive) .pe-button__wash\": {\n        backgroundColor: componentVars[\"color_\" + tint + \"_hover_background\"],\n        borderColor: hoverBorder\n      }\n    }\n  }];\n};\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n  noTouchStyle([\"html.pe-no-touch .pe-dark-tone \"], selector, componentVars, \"dark\"), // inside dark tone\n  noTouchStyle([\"html.pe-no-touch \", \"html.pe-no-touch .pe-light-tone \"], selector, componentVars, \"light\"),\n];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport color from \"./color\";\n\nconst fns = [color];\nconst selector = `.${classes.component.replace(/ /g, \".\")}`;\n\nexport const customTheme = (customSelector, customVars) => \n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns);\n\nstyler.generateStyles([selector], vars, fns);\n","import { isTouch, touchStartEvent, touchEndEvent, subscribe } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\n// Don't export 'getElement': it will be the wrapped button component (set in polythene-xxx-raised-button)\n\nexport const theme = customTheme;\n\nconst MAX_Z = 5;\n\nlet tapStart,\n  tapEndAll = () => {},\n  downButtons = [];\n\nsubscribe(touchEndEvent, () => tapEndAll());\n\nconst animateZ = (which, vnode) => {\n  const zBase = vnode.state.zBase;\n  const increase = vnode.attrs.increase || 1;\n  const z = vnode.state.z();\n  const newZ = which === \"down\" && zBase < MAX_Z\n    ? Math.min(zBase + increase, MAX_Z)\n    : which === \"up\"\n      ? Math.max(z - increase, zBase)\n      : z;\n  if (newZ !== z) {\n    vnode.state.updateZ(newZ);\n  }\n};\n\nconst tapHandler = (which, vnode) => {\n  if (which === \"down\") {\n    downButtons.push(Object.assign({}, vnode));\n  }\n  // no z animation on touch\n  const animateOnTap = vnode.attrs.animateOnTap !== false ? true : false;\n  if (animateOnTap && !isTouch) {\n    animateZ(which, vnode);\n  }\n};\n\nconst initTapEvents = vnode => {\n  tapStart = () => tapHandler(\"down\", vnode);\n  tapEndAll = () => {\n    downButtons.map(buttonVnode =>\n      tapHandler(\"up\", buttonVnode));\n    downButtons = [];\n  };\n  vnode.dom.addEventListener(touchStartEvent, tapStart);\n};\n\nconst clearTapEvents = vnode =>\n  vnode.dom.removeEventListener(touchStartEvent, tapStart);\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const zValue = attrs.z !== undefined ? attrs.z : 1;\n  const z = createStream(zValue);\n  const redraw = createStream(); // helper stream to call redraw whenever z changes, but not on the initial value\n  const updateZ = newZ => (\n    z(newZ),\n    redraw(newZ)\n  );\n  const tapEventsInited = createStream(false);\n  return {\n    zBase: zValue,\n    z,\n    updateZ,\n    tapEventsInited,\n    redrawOnUpdate: createStream.merge([redraw])\n  };\n};\n\nexport const onMount = vnode => {\n  if (vnode.dom && !vnode.attrs.disabled && !vnode.attrs.inactive && !vnode.state.tapEventsInited()) {\n    initTapEvents(vnode);\n    vnode.state.tapEventsInited(true);\n  }\n};\n\nexport const onUnMount = vnode => {\n  if (vnode.state.tapEventsInited()) {\n    clearTapEvents(vnode);\n  }\n};\n\nexport const createProps = (vnode, { renderer: h, Shadow }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const children = attrs.children || vnode.children || [];\n  return Object.assign(\n    {},\n    {\n      parentClassName: [\n        attrs.parentClassName || classes.component\n      ].join(\" \"),\n      animateOnTap: false,\n      shadowComponent: h(Shadow, { z: state.z, animated: true }),\n      children\n    },\n    attrs\n  );\n};\n\nexport const createContent = () => null;\n"],"names":["rgba","vars","color_light_foreground","blend_light_text_primary","blend_light_background_hover","blend_light_background_disabled","blend_light_text_disabled","color_primary","color_dark_foreground","blend_dark_text_primary","color_primary_active","color_primary_dark","blend_dark_background_disabled","blend_dark_text_disabled","style","scopes","selector","componentVars","tint","normalBorder","activeBorder","disabledBorder","map","s","join","noTouchStyle","hoverBorder","fns","color","classes","component","replace","customTheme","customSelector","customVars","styler","generateStyles","theme","tapStart","tapEndAll","downButtons","subscribe","touchEndEvent","animateZ","which","vnode","zBase","state","increase","attrs","z","newZ","Math","min","max","updateZ","tapHandler","push","_extends","animateOnTap","isTouch","initTapEvents","buttonVnode","dom","addEventListener","touchStartEvent","clearTapEvents","removeEventListener","getInitialState","createStream","zValue","undefined","redraw","tapEventsInited","merge","onMount","disabled","inactive","onUnMount","createProps","h","renderer","Shadow","children","parentClassName","animated","createContent"],"mappings":"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"}