!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-hyperscript"),require("react-dom"),require("polythene-core")):"function"==typeof define&&define.amd?define(["exports","react","react-hyperscript","react-dom","polythene-core"],t):t(e.polythene={},e.react,e["react-hyperscript"],e["react-dom"],e["polythene-core"])}(this,function(e,t,n,r,o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n,r=r&&r.hasOwnProperty("default")?r.default:r;var y={autocomplete:"autoComplete",autofocus:"autoFocus",class:"className",className:"className",enctype:"encType",formaction:"formAction",maxlength:"maxLength",minlength:"minLength",onblur:"onBlur",onchange:"onChange",onclick:"onClick",onfocus:"onFocus",oninput:"onInput",onkeydown:"onKeyDown",onkeyup:"onKeyUp",onmousedown:"onMouseDown",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onscroll:"onScroll",onsubmit:"onSubmit",ontouchend:"onTouchEnd",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",readonly:"readOnly",tabindex:"tabIndex"},v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=function(e){return function(t){function n(t){a(this,n);var r=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t)),o=v({},e,{state:{},attrs:r.props,redrawValues:void 0});return e.oninit&&e.oninit(o),r.state=o,r}return u(n,t),m(n,[{key:"componentDidMount",value:function(){var e=this;this._mounted=!0,this.state.state.redrawOnUpdate&&this.state.state.redrawOnUpdate.map(function(t){e._mounted&&e.setState({redrawValues:t})})}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"render",value:function(){return e.view({state:this.state.state,attrs:this.props},this.props.children)}}]),n}(t.Component)},b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return"object"===b(t[0])?n.call.apply(n,[null,_(t[0])].concat(s(t.slice(1)))):n.call.apply(n,[null].concat(t))};O.trust=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return null==e&&(e=""),n(t,{dangerouslySetInnerHTML:{__html:e}})},O.displayName="react";var g=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){!function(){function t(){function e(){return arguments.length>0&&arguments[0]!==k&&r(e,arguments[0]),e._state.value}return n(e),arguments.length>0&&arguments[0]!==k&&r(e,arguments[0]),e}function n(e){e.constructor=t,e._state={id:w++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},e.map=e["fantasy-land/map"]=l,e["fantasy-land/ap"]=p,e["fantasy-land/of"]=t,e.valueOf=d,e.toJSON=h,e.toString=d,Object.defineProperties(e,{end:{get:function(){if(!e._state.endStream){var n=t();n.map(function(t){return!0===t&&(f(e),n._state.unregister=function(){f(n)}),t}),e._state.endStream=n}return e._state.endStream}}})}function r(e,t){o(e,t);for(var n in e._state.deps)a(e._state.deps[n],!1);null!=e._state.unregister&&e._state.unregister(),i(e)}function o(e,t){e._state.value=t,e._state.changed=!0,2!==e._state.state&&(e._state.state=1)}function a(e,t){var n=e._state.parents;if(n.length>0&&n.every(v)&&(t||n.some(m))){var r=e._state.derive();if(r===k)return!1;o(e,r)}}function i(e){e._state.changed=!1;for(var t in e._state.deps)e._state.deps[t]._state.changed=!1}function u(e,n){if(!n.every(y))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return s(t(),n,function(){return e.apply(this,n.concat([n.filter(m)]))})}function s(e,t,n){var r=e._state;return r.derive=n,r.parents=t.filter(_),c(e,r.parents),a(e,!0),e}function c(e,t){for(var n=0;n<t.length;n++)t[n]._state.deps[e._state.id]=e,c(e,t[n]._state.parents)}function f(e){for(var t=0;t<e._state.parents.length;t++)delete e._state.parents[t]._state.deps[e._state.id];for(var n in e._state.deps){var r=e._state.deps[n],o=r._state.parents.indexOf(e);o>-1&&r._state.parents.splice(o,1)}e._state.state=2,e._state.deps={}}function l(e){return u(function(t){return e(t())},[this])}function p(e){return u(function(e,t){return e()(t())},[e,this])}function d(){return this._state.value}function h(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function y(e){return e._state}function v(e){return 1===e._state.state}function m(e){return e._state.changed}function _(e){return 2!==e._state.state}function b(e){return u(function(){return e.map(function(e){return e()})},e)}function O(e,t,n){var r=u(function(n){return t=e(t,n._state.value)},[n]);return 0===r._state.state&&r(t),r}function g(e,t){var n=e.map(function(e){var t=e[0];return 0===t._state.state&&t(void 0),t});return u(function(){var r=arguments[arguments.length-1];return n.forEach(function(n,o){r.indexOf(n)>-1&&(t=e[o][1](t,n._state.value))}),t},n)}var w=0,k={};t["fantasy-land/of"]=t,t.merge=b,t.combine=u,t.scan=O,t.scanMerge=g,t.HALT=k,e.exports=t}()}),w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),j=function(e){var n=e.createContent,a=void 0===n?function(){}:n,i=e.createProps,u=void 0===i?function(){return{}}:i,s=e.getElement,p=void 0===s?function(){return"div"}:s,d=e.component,h=e.getInitialState,v=void 0===h?function(){return{}}:h,m=e.onMount,_=void 0===m?function(){}:m,b=e.onUnMount,j=void 0===b?function(){}:b,M=e.view,S=void 0===M?null:M;return function(e){function t(e){c(this,t);var n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.dom=null;var r=w({},d,n.createVirtualNode(),{redrawValues:void 0}),o=v(r,g);return n.state=o,n.registerDOM=n.registerDOM.bind(n),n._render=n._render.bind(n),n}return l(t,e),k(t,[{key:"componentDidMount",value:function(){var e=this;this._mounted=!0,this.state.redrawOnUpdate&&this.state.redrawOnUpdate.map(function(t){return e._mounted&&e.setState({redrawValues:t})}),_(this.createVirtualNode(),{keys:y})}},{key:"componentWillUnmount",value:function(){this._mounted=!1,j(this.createVirtualNode())}},{key:"createVirtualNode",value:function(){var e=w({},this.props);return{state:this.state,attrs:e,children:e.children,dom:this.dom}}},{key:"registerDOM",value:function(e){o.isClient&&!this.dom&&e&&(this.dom=e instanceof HTMLElement?e:r.findDOMNode(e))}},{key:"_render",value:function(){var e=this.createVirtualNode();return O(d||p(e),w({},u(e,{renderer:O,requiresKeys:!0,keys:y}),{ref:this.registerDOM}),[e.attrs.before,a(e,{renderer:O,requiresKeys:!0,keys:y}),e.attrs.after])}},{key:"render",value:function(){return S?S(this.createVirtualNode(),{renderer:O,render:this._render}):this._render(this.props)}}]),t}(t.Component)},M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),P=function(e){var n=e.createContent,a=void 0===n?function(){}:n,i=e.createProps,u=void 0===i?function(){return{}}:i,s=e.getElement,c=void 0===s?function(){return"div"}:s,f=e.onMount,l=void 0===f?function(){}:f,v=e.onUnMount,m=void 0===v?function(){}:v,_=e.component,b=e.view,g=void 0===b?null:b;return function(e){function t(e){p(this,t);var n=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.dom=null,n.registerDOM=n.registerDOM.bind(n),n._render=n._render.bind(n),n}return h(t,e),S(t,[{key:"componentDidMount",value:function(){l(this.createVirtualNode(),{keys:y})}},{key:"componentWillUnmount",value:function(){m(this.createVirtualNode())}},{key:"createVirtualNode",value:function(){var e=M({},this.props);return{attrs:e,children:e.children,dom:this.dom}}},{key:"registerDOM",value:function(e){o.isClient&&!this.dom&&e&&(this.dom=e instanceof HTMLElement?e:r.findDOMNode(e))}},{key:"_render",value:function(){var e=this.createVirtualNode();return O(_||c(e),M({},u(e,{renderer:O,requiresKeys:!0,keys:y}),{ref:this.registerDOM}),[e.attrs.before,a(e,{renderer:O,requiresKeys:!0,keys:y}),e.attrs.after])}},{key:"render",value:function(){return g?g(this.createVirtualNode(),{renderer:O,render:this._render}):this._render(this.props)}}]),t}(t.Component)};e.keys=y,e.MithrilToReact=_,e.renderer=O,e.StateComponent=j,e.ViewComponent=P,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-react-base.js.map
