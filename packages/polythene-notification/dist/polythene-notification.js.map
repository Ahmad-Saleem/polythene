{"version":3,"file":"polythene-notification.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/layout-holder.js","../src/theme/index.js","../src/instance.js","../src/theme/transitions.js","../src/notification.js"],"sourcesContent":["export default {\n  component:      \"pe-notification\",\n\n  // elements\n  action:         \"pe-notification__action\",\n  content:        \"pe-notification__content\",\n  holder:         \"pe-notification__holder\",\n  placeholder:    \"pe-notification__placeholder\",\n  title:          \"pe-notification__title\",\n\n  // states\n  hasContainer:   \"pe-notification--container\",\n  horizontal:     \"pe-notification--horizontal\",\n  multilineTitle: \"pe-notification__title--multiline\",\n  vertical:       \"pe-notification--vertical\",\n};","import { vars } from \"polythene-theme\";\nconst rgba = vars.rgba;\n\nconst buttonPaddingH = 8; // padding, inner text space\n\nexport default {\n  width:                  274,\n  min_height:             80,\n  border_radius:          vars.unit_block_border_radius,\n  title_padding_h:        buttonPaddingH,\n  title_single_padding_v: 14,\n  title_multi_padding_v:  20,\n  side_padding:           24 - buttonPaddingH,\n  font_size:              14,\n  line_height:            20,\n\n  color_light_background: rgba(vars.color_light_background),\n  color_light_text:       rgba(vars.color_light_foreground, vars.blend_light_dark_primary),\n\n  color_dark_background:  rgba(vars.color_dark_background),\n  color_dark_text:        rgba(vars.color_dark_foreground, vars.blend_light_text_primary)\n};\n","\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector, componentVars) => [{\n  [selector]: [\n    flex.layoutCenter,\n    {\n      width: componentVars.width + \"px\",\n      minHeight: componentVars.min_height + \"px\",\n      position: \"relative\",\n      padding: \"0 \" + componentVars.side_padding + \"px\",\n      margin: \"0 auto\",\n      borderRadius: componentVars.border_radius + \"px\",\n      pointerEvents: \"all\",\n\n      \" .pe-notification__content\": {\n        width: \"100%\"\n      },\n\n      \" .pe-notification__title\": {\n        padding: componentVars.title_single_padding_v + \"px \" + componentVars.title_padding_h + \"px\",\n        fontSize: componentVars.font_size + \"px\",\n        lineHeight: componentVars.line_height + \"px\"\n      },\n\n      \" .pe-notification__action\": {\n        \" .pe-button\": {\n          margin: 0\n        }\n      },\n\n      \"&.pe-notification--horizontal\": {\n        \" .pe-notification__content\": flex.layoutHorizontal,\n        \" .pe-notification__title\": flex.flex(),\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\",\n          paddingBottom: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutCenter\n      },\n      \"&.pe-notification--vertical\": {\n        \" .pe-notification__content\": flex.layoutVertical,\n        \" .pe-notification__title\": {\n          paddingBottom: \"4px\"\n        },\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutEndJustified\n      }\n    }\n  ]\n}];\n\n","\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n    color: componentVars[\"color_\" + tint + \"_text\"],\n    background: componentVars[\"color_\" + tint + \"_background\"]\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark theme\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { vars } from \"polythene-theme\";\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector) => [{\n  [selector]: [\n    flex.layoutCenterCenter,\n    {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      zIndex: vars.z_notification,\n      pointerEvents: \"none\",\n\n      \".pe-multiple--screen\": {\n        position: \"fixed\",\n      },\n      \".pe-multiple--container\": {\n        position: \"absolute\",\n      }\n    }\n  ]\n}];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\nimport holderLayout from \"./layout-holder\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nconst holderFns = [holderLayout];\nconst holderSelector = `.${classes.holder}`;\n\nexport const customTheme = (customSelector, customVars) => (\n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns),\n  styler.generateStyles([customSelector, holderSelector], {...vars, ...customVars}, holderFns)\n);\n\nstyler.generateStyles([selector], vars, fns);\nstyler.generateStyles([holderSelector], vars, holderFns);\n","import m from \"mithril\";\nimport { show, hide, filterSupportedAttributes } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\nimport { Timer } from \"polythene-utilities\";\nimport classes from \"./classes\";\n\nconst DEFAULT_TIME_OUT = 3;\n\nconst pauseInstance = state => {\n  state.isPaused = true;\n  if (state.timer) {\n    state.timer.pause();\n  }\n};\n\nconst unpauseInstance = state => {\n  state.isPaused = false;\n  if (state.timer) {\n    state.timer.resume();\n  }\n};\n\nconst stopTimer = state => {\n  if (state.timer) {\n    state.timer.stop();\n  }\n};\n\nconst prepareShow = (state, opts) => {\n  state.containerEl = state.containerEl || document.querySelector(opts.containerSelector || state.element);\n  if (opts.containerSelector) {\n    const holderEl = state.containerEl.querySelector(state.element);\n    holderEl.classList.add(classes.hasContainer);\n  }\n};\n\nconst showInstance = (state, opts) => {\n  prepareShow(state, opts);\n  stopTimer(state);\n  state.transitioning = true;\n  const transitions = opts.transitions || state.transitions;\n  return show(Object.assign({},\n    opts,\n    transitions.show(state.containerEl, opts)\n  )).then(() => {\n    state.transitioning = false;\n    if (state.didShow) {\n      // notify multiple\n      state.didShow(state.instanceId);\n      // this will call opts.didShow\n    }\n    // set timer to hide in a few seconds\n    const timeout = opts.timeout;\n    if (timeout === 0) {\n      // do not time out\n    } else {\n      const timeoutSeconds = timeout !== undefined\n        ? timeout\n        : DEFAULT_TIME_OUT;\n      state.timer = new Timer(() => {\n        hideInstance(state, opts);\n      }, timeoutSeconds);\n    }\n  });\n};\n\nconst hideInstance = (state, opts) => {\n  stopTimer(state);\n  const id = state.instanceId;\n  state.transitioning = true;\n  const transitions = opts.transitions || state.transitions;\n  return hide(Object.assign({},\n    opts,\n    transitions.hide(state.containerEl, opts)\n  )).then(() => {\n    stopTimer(state);\n    state.transitioning = false;\n    if (state.didHide) {\n      // notify multiple\n      state.didHide(id);\n      // this will call opts.didHide\n    }\n    m.redraw(); // removes remainder of drawn component\n  });\n};\n\nconst createView = (state, opts) => {\n  const element = opts.element || \"div\";\n  const props = Object.assign({},\n    filterSupportedAttributes(opts),\n    {\n      class: [\n        state.class,\n        opts.tone === \"light\" ? null : \"pe-dark-tone\", // default dark tone\n        opts.tone === \"light\" ? \"pe-light-tone\" : null,\n        opts.containerSelector ? classes.hasContainer : null,\n        opts.layout === \"vertical\" ? classes.vertical : classes.horizontal,\n        opts.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        opts.tone === \"light\" ? \"pe-light-tone\" : null,\n        opts.class\n      ].join(\" \"),\n      oncreate: ({ dom }) => {\n        state.el = dom;\n        showInstance(state, opts);\n      },\n      onclick: e => e.preventDefault()\n    }\n  );\n\n  const content = m(\"div\",\n    {\n      class: classes.content\n    },\n    opts.content || [\n      opts.title\n        ? m(\"div\", {\n          class: classes.title,\n          oncreate: ({ dom }) => {\n            const height = dom.getBoundingClientRect().height;\n            const lineHeight = parseInt(window.getComputedStyle(dom).lineHeight, 10);\n            const paddingTop = parseInt(window.getComputedStyle(dom).paddingTop, 10);\n            const paddingBottom = parseInt(window.getComputedStyle(dom).paddingBottom, 10);\n            if (height > (lineHeight + paddingTop + paddingBottom)) {\n              dom.classList.add(classes.multilineTitle);\n            }\n          }\n        }, opts.title)\n        : null,\n      opts.action\n        ? m(\"div\", { class: classes.action }, [ opts.action ])\n        : null\n    ]\n  );\n  return m(element, props, content);\n};\n\nexport default {\n  theme: customTheme, // accepts (selector, vars)\n  oninit: vnode => {\n    const attrs = vnode.attrs;\n    vnode.state = Object.assign(\n      vnode.state,\n      attrs,\n      {\n        el:            null,\n        containerEl:   null,\n        dismissEl:     null,\n        transitioning: false,\n        timer:         null,\n        isPaused:      false\n      }\n    );\n  },\n  view: ({ state, attrs }) => {\n    // attrs contains {id, opts}\n    const opts = (typeof attrs.opts === \"function\")\n      ? attrs.opts()\n      : attrs.opts;\n    if (attrs.hide && !state.transitioning) {\n      hideInstance(state, opts);\n    }\n    if (attrs.pause && !state.isPaused) {\n      pauseInstance(state, attrs);\n    } else if (attrs.unpause && state.isPaused) {\n      unpauseInstance(state, attrs);\n    }\n    return createView(state, opts);\n  }\n};\n","\nconst show = (el, opts) => ({\n  el,\n  showDuration: opts.showDuration || .5,\n  showDelay:    opts.showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = (el, opts) => ({\n  el,\n  hideDuration: opts.hideDuration || .5,\n  hideDelay:    opts.hideDelay || 0,\n  hide:         () => el.style.opacity = 0,\n});\n\nexport default {\n  show,\n  hide\n};\n","import { multiple } from \"polythene-core\";\nimport instance from \"./instance\";\nimport classes from \"./classes\";\nimport transitions from \"./theme/transitions\";\n\nexport default multiple({\n  instance,\n  transitions,\n  queue:         true,\n  defaultId:     \"default_notification\",\n  class:         classes.component,\n  element:       `.${classes.holder}`,\n  placeholder:   `span.${classes.placeholder}`,\n  bodyShowClass: classes.open\n});\n"],"names":["rgba","vars","unit_block_border_radius","color_light_background","color_light_foreground","blend_light_dark_primary","color_dark_background","color_dark_foreground","blend_light_text_primary","selector","componentVars","flex","layoutCenter","width","min_height","side_padding","border_radius","title_single_padding_v","title_padding_h","font_size","line_height","layoutHorizontal","title_multi_padding_v","layoutVertical","layoutEndJustified","style","scopes","tint","map","s","join","layoutCenterCenter","z_notification","fns","layout","color","classes","component","holderFns","holderLayout","holderSelector","holder","customTheme","customSelector","customVars","styler","generateStyles","pauseInstance","isPaused","state","timer","pause","unpauseInstance","resume","stopTimer","stop","prepareShow","opts","containerEl","document","querySelector","containerSelector","element","classList","add","hasContainer","showInstance","transitioning","transitions","show","_extends","then","didShow","instanceId","timeout","timeoutSeconds","undefined","Timer","hideInstance","id","hide","didHide","redraw","createView","m","filterSupportedAttributes","class","tone","vertical","horizontal","dom","el","e","preventDefault","content","title","getBoundingClientRect","height","parseInt","window","getComputedStyle","lineHeight","paddingTop","paddingBottom","multilineTitle","action","attrs","vnode","unpause","showDuration","showDelay","opacity","hideDuration","hideDelay","multiple","placeholder","open"],"mappings":"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"}