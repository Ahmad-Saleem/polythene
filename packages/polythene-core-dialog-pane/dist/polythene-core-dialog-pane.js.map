{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/index.js","../src/dialog-pane.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  hasBottomOverflow: \"pe-dialog-pane--overflow-bottom\",\n  hasTopOverflow:    \"pe-dialog-pane--overflow-top\"\n};\n","import { vars } from \"polythene-theme\";\nconst rgba = vars.rgba;\n\nexport default {\n  padding:       3 * vars.grid_unit_component,\n  header_bottom: 20,\n  header_height: 60,\n  footer_height: 52,\n\n  color_light_title_text:          \"inherit\",\n  color_light_body_text:           \"inherit\",\n  color_light_body_border:         rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_light_background:          \"inherit\",\n\n  color_dark_title_text:           \"inherit\",\n  color_dark_body_text:            \"inherit\",\n  color_dark_body_border:          rgba(vars.color_dark_foreground, vars.blend_dark_border_light),\n  color_dark_background:           \"inherit\",\n};\n\n\n  ","import { vars } from \"polythene-theme\";\nimport { mixin, flex } from \"polythene-core-css\";\n\nconst lineHeightTitle = 24;\n\nexport default (selector, componentVars) => [{\n  [selector]: [\n    flex.layoutVertical,\n    {\n      position: \"relative\",\n      maxHeight: \"100%\",\n      minWidth: 56 * 5 + \"px\",\n      maxWidth: 7 * vars.grid_unit_menu + \"px\",\n      borderRadius: \"inherit\",\n      \n      \".pe-menu__content\": {\n        \" .pe-dialog-pane__body\": {\n          padding: 0,\n          border: \"none\"\n        }\n      },\n      \" .pe-dialog-pane__header, pe-dialog-pane__body, pe-dialog-pane__header\": {\n        zIndex: 1\n      },\n\n      \" .pe-dialog-pane__title\": {\n        fontSize: vars.font_size_title + \"px\",\n        lineHeight: lineHeightTitle + \"px\",\n        fontWeight: vars.font_weight_medium,\n\n        \"& + div\": {\n          marginTop: \"16px\"\n        },\n      },\n\n      \" .pe-dialog-pane__header\": {\n        padding: [(componentVars.padding - 4), componentVars.padding, (componentVars.header_bottom - 4), componentVars.padding].map((v) => (v + \"px\")).join(\" \"),\n        minHeight: componentVars.header_height + \"px\",\n\n        \" .pe-dialog-pane__title\": [\n          mixin.ellipsis(1), {\n            width: \"100%\"\n          }\n        ]\n      },\n\n      \" .pe-dialog-pane__body\": [\n        flex.selfStretch,\n        {\n          padding: componentVars.padding + \"px\",\n          overflowY: \"auto\",\n          \"-webkit-overflow-scrolling\": \"touch\",\n          borderWidth: \"1px\",\n          borderStyle: \"solid none\",\n          borderColor: \"transparent\",\n          // initially set max-height; will be overridden by dialog core with actual heights\n          maxHeight: \"calc(100vh - \" + (2 * componentVars.padding) + \"px - \" + (componentVars.header_height + componentVars.footer_height) + \"px)\",\n\n          \" p\": {\n            margin: 0\n          },\n          \" p + p\": {\n            marginTop: \"16px\"\n          }\n        }\n      ],\n      \" .pe-dialog-pane__header + .pe-dialog-pane__body\": {\n        paddingTop: 0\n      },\n\n      \" .pe-dialog-pane__footer\": {\n        padding: \"2px 8px\",\n        minHeight: componentVars.footer_height + \"px\",\n        fontSize: 0, // remove inline block spacing\n\n        \".pe-dialog-pane__footer--high\": {\n          // when buttons are stacked vertically\n          paddingBottom: \"8px\"\n        }\n      },\n\n      \" .pe-dialog-pane__actions\": [\n        flex.layoutHorizontal,\n        flex.layoutEndJustified,\n        flex.layoutWrap, {\n          margin: \"0 -4px\",\n\n          \" .pe-button\": {\n            height: \"36px\",\n            marginTop: \"6px\",\n            marginBottom: \"6px\",\n            padding: 0\n          }\n        }\n      ]\n    },\n  ],\n  \".pe-menu__content\": {\n    \" .pe-dialog-pane__body\": {\n      padding: 0,\n      border: \"none\"\n    }\n  },\n  \" .pe-dialog--fullscreen\": {\n    \" .pe-dialog-pane__content\": {\n      borderRadius: 0,\n      maxWidth: \"none\",\n      height: \"100vh\",\n      width: \"100vw\",\n    },\n    \" .pe-dialog-pane, .pe-dialog-pane__body\": {\n      padding: 0,\n      height: \"100vh\",\n      maxHeight: \"100vh\",\n      border: \"none\",\n      maxWidth: \"initial\",\n    }\n  }\n}];\n","\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n\n    backgroundColor: componentVars[\"color_\" + tint + \"_background\"],\n    \n    \" .pe-dialog-pane__header .pe-dialog-pane__title\": {\n      color: componentVars[\"color_\" + tint + \"_title_text\"]\n    },\n    \" .pe-dialog-pane__body\": {\n      color: componentVars[\"color_\" + tint + \"_body_text\"]\n    },\n    \"&.pe-dialog-pane--overflow-top .pe-dialog-pane__body\": {\n      borderTopColor: componentVars[\"color_\" + tint + \"_body_border\"]\n    },\n    \"&.pe-dialog-pane--overflow-bottom .pe-dialog-pane__body\": {\n      borderBottomColor: componentVars[\"color_\" + tint + \"_body_border\"]\n    }\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nexport const customTheme = (customSelector, customVars) => \n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns);\n\nstyler.generateStyles([selector], vars, fns);\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nexport const theme = customTheme;\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nconst updateFooterState = vnode => {\n  const state = vnode.state;\n  const footerEl = state.footerEl();\n  if (!footerEl) {\n    return;\n  }\n  const style = window.getComputedStyle(footerEl);\n  const height = footerEl.getBoundingClientRect().height;\n  const minHeight = parseInt(style.minHeight, 10);\n  if (height > minHeight) {\n    footerEl.classList.add(classes.footerHigh);\n  } else {\n    footerEl.classList.remove(classes.footerHigh);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream();\n  const headerEl = createStream();\n  const isScrolling = createStream();\n  const scrollEl = createStream();\n  const topOverflow = createStream(false);\n  const el = createStream();\n  isScrolling.map(vnode1 =>\n    updateScrollOverflowState(vnode1)\n  );\n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  // const attrs = vnode.attrs;\n  state.el(vnode.dom);\n\n  state.scrollEl(vnode.dom.querySelector(`.${classes.body}`));\n  state.footerEl(vnode.dom.querySelector(`.${classes.footer}`));\n  state.headerEl(vnode.dom.querySelector(`.${classes.title}`));\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n    updateFooterState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n  \n  updateScrollOverflowState(vnode);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        state.topOverflow() || attrs.borders ? classes.hasTopOverflow : null,\n        state.bottomOverflow() || attrs.borders ? classes.hasBottomOverflow : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.title\n        ? h(\"div\",\n          {\n            className: classes.header,\n            key: \"header\"\n          },\n          h(\"div\",\n            { className: classes.title },\n            attrs.title\n          )\n        )\n        : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(vnode);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(vnode);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          h(\"div\",\n            { className: classes.actions },\n            attrs.footer\n          )\n        )\n        : null\n    ]\n  );\n};\n"],"names":["rgba","vars","grid_unit_component","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light","selector","componentVars","flex","layoutVertical","grid_unit_menu","font_size_title","lineHeightTitle","font_weight_medium","padding","header_bottom","map","v","join","header_height","mixin","ellipsis","selfStretch","footer_height","layoutHorizontal","layoutEndJustified","layoutWrap","style","scopes","tint","s","fns","layout","color","classes","component","customTheme","customSelector","customVars","styler","generateStyles","getElement","vnode","attrs","element","theme","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","updateFooterState","footerEl","window","getComputedStyle","parseInt","minHeight","classList","add","footerHigh","remove","getInitialState","createStream","headerEl","isScrolling","el","vnode1","undefined","merge","onMount","dom","querySelector","body","footer","title","update","cleanUp","unsubscribe","onUnMount","createProps","k","keys","unpackAttrs","_extends","filterSupportedAttributes","borders","hasTopOverflow","hasBottomOverflow","tone","className","class","formOptions","createContent","h","renderer","content","menu","menuContent","header","onscroll","scrollWatchId","setTimeout","actions"],"mappings":"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"}