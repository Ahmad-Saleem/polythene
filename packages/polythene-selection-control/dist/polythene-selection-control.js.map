{"version":3,"file":"polythene-selection-control.js","sources":["../src/selection-control.js","../src/control-view.js","../src/theme/vars.js","../src/theme/color.js","../src/theme/layout.js"],"sourcesContent":["import m from \"mithril\";\nimport { filterSupportedAttributes } from \"polythene-core\";\n\nexport const classes = {\n  component: \"pe-control\",\n  formLabel: \"pe-control__form-label\",\n  label:     \"pe-control__label\",\n  input:     \"pe-control__input\",\n  on:        \"pe-control--on\",\n  off:       \"pe-control--off\",\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  small:     \"pe-control--small\",\n  regular:   \"pe-control--regular\",\n  medium:    \"pe-control--medium\",\n  large:     \"pe-control--large\"\n};\n\nconst typeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large\n};\n\nconst classForType = (mode = \"regular\") => typeClasses[mode];\n\nconst view = vnode => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  if (typeof attrs.checked === \"function\") {\n    state.setChecked(attrs.checked());\n  }\n  const checked = state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  const element = attrs.element || \"div\";\n  const name = attrs.name || \"\";\n  const props = Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      class: [\n        classes.component,\n        attrs.defaultClass,\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForType(attrs.size),\n        attrs.class\n      ].join(\" \")\n    },\n    attrs.events ? attrs.events : null\n  );\n  const content = [\n    m(\"input\", {\n      class: classes.input,\n      name,\n      value: state.value(),\n      type: attrs.type, // set by checkbox / radio-button\n      tabindex: -1, // set in controlView / icon-button\n      checked,\n      oncreate: vnode => state.setInputEl(vnode.dom)\n    }),\n    m(\"label\", Object.assign(\n      {}, \n      {\n        class: classes.formLabel,\n        tabindex: -1, // set in controlView\n      },\n      inactive\n        ? null\n        : {\n          onclick: state.toggle\n        }\n    ), [\n      attrs.controlView ? attrs.controlView(checked, attrs) : null,\n      attrs.label ? m(`.${classes.label}`, attrs.label) : null\n    ])\n  ];\n  return m(element, props, [attrs.before, content, attrs.after]);\n};\n\nexport const selectionControl = {\n  oninit: vnode => {\n    const attrs = vnode.attrs;\n    // Because this module also supports radio buttons (paired control elements)\n    // we won\"t keep a separate \"checked\" value but instead keep the checked value\n    // as a HTMLElement checked state.\n    const defaultChecked = false;\n    let value = attrs.value || \"1\";\n    let inputEl;\n\n    const setInputElChecked = isChecked => {\n      if (inputEl) {\n        inputEl.checked = isChecked;\n      }\n    };\n\n    const getAttrsChecked = () => {\n      if (typeof attrs.checked === \"function\") {\n        const v = attrs.checked();\n        return v !== undefined\n          ? v\n          : defaultChecked;\n      } else {\n        return attrs.checked !== undefined\n          ? attrs.checked\n          : defaultChecked;\n      }\n    };\n\n    const setInputEl = el => {\n      inputEl = el;\n      setInputElChecked(getAttrsChecked());\n    };\n\n    const setChecked = isChecked => {\n      setInputElChecked(isChecked);\n      if (attrs.getState) {\n        attrs.getState({\n          checked: inputEl ? inputEl.checked : getAttrsChecked(),\n          value,\n          el: inputEl,\n        });\n      }\n    };\n\n    const toggle = () => (setChecked(!inputEl.checked));\n\n    vnode.state = {\n      setInputEl,\n      setChecked,\n      checked: () => inputEl ? inputEl.checked : getAttrsChecked(),\n      toggle,\n      value: () => value\n    };\n  },\n  view\n};\n","// Helper function for checkbox and radio button\nimport m from \"mithril\";\nimport { icon } from \"polythene-icon\";\nimport { iconButton } from \"polythene-icon-button\";\n\nconst classes = {\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n  on:        \"pe-control__button--on\",\n  off:       \"pe-control__button--off\"\n};\n\nconst createIcon = (onOffType, attrs) => (\n    // if attrs.iconOn/Off is passed, use that icon options object and ignore size\n    // otherwise create a new object\n    Object.assign(\n      {},\n      attrs[onOffType]\n        ? attrs[onOffType]\n        : { msvg: attrs.theme[onOffType] },\n      { class: attrs.class },\n      attrs.icon,\n      attrs.size\n        ? { type: attrs.size }\n        : null\n    )\n);\n\nexport const controlView = (checked, attrs) =>   \n  m(\"div\", {\n    class: classes.box\n  },\n  m(iconButton, Object.assign(\n    {},\n    {\n      element: \"div\",\n      class: classes.button,\n      content: [\n        m(icon, createIcon(\"iconOn\", Object.assign(\n          {},\n          attrs,\n          { class: classes.on }\n        ))),\n        m(icon, createIcon(\"iconOff\", Object.assign(\n          {},\n          attrs,\n          { class: classes.off }\n        )))\n      ],\n      ripple: { center: true },\n      disabled: attrs.disabled\n    },\n    attrs.selectable !== undefined\n      ? {inactive: !attrs.selectable(checked)}\n      : null,\n    attrs.iconButton\n  )));\n\n","import { vars } from \"polythene-theme\";\n\nconst rgba = vars.rgba;\n\nconst activeColor = vars.color_primary; // or override in CSS by setting 'color' property on '.pe-checkbox' / '.pe-radio-button'\nconst label_padding = (vars.grid_unit_icon_button - vars.unit_icon_size) / 2; // 12\n\nexport default {\n  label_font_size:                     2 * vars.grid_unit_component, // 16\n  label_height:                        3 * vars.grid_unit_component, // 24\n  padding:                             Math.floor(1.7 * vars.grid_unit_component),\n  label_padding,                 \n  button_size:                         6 * vars.grid_unit_component,\n  icon_size:                           3 * vars.grid_unit_component,\n  animation_duration:                  vars.animation_duration,\n\n  color_light_on:                      vars.rgba(activeColor),\n  color_light_off:                     rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_label:                   rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled:                rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_thumb_off_focus_opacity: .08,\n  color_light_thumb_on_focus_opacity:  .11,\n\n  // icon colors may be set in theme; disabled by default\n  // color_light_on_icon\n  // color_light_off_icon\n\n  color_light_focus_on:                rgba(vars.color_primary),\n  color_light_focus_on_opacity:        .11,\n  color_light_focus_off:                rgba(vars.color_light_foreground),\n  color_light_focus_off_opacity:       .07,\n\n  color_dark_on:                       vars.rgba(activeColor),\n  color_dark_off:                      rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_label:                    rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_thumb_off_focus_opacity:  .08,\n  color_dark_thumb_on_focus_opacity:   .11,\n\n  // icon color may be set in theme; disabled by default\n  // color_dark_on_icon\n  // color_dark_off_icon\n  \n  color_dark_focus_on:                 rgba(vars.color_primary), // or '#80cbc4'\n  color_dark_focus_on_opacity:         .14,\n  color_dark_focus_off:                rgba(vars.color_dark_foreground),\n  color_dark_focus_off_opacity:        .09\n};\n","// Returns a style function to be used by checkbox and radio-button\n\nconst style = (scope, selector, componentVars, tint) => [{\n  [scope + selector]: {\n    color: componentVars[\"color_\" + tint + \"_on\"], // override by specifying \"color\"\n\n    \" .pe-control__label\": {\n      color: componentVars[\"color_\" + tint + \"_label\"]\n    },\n    \" .pe-control__box\": {\n      \" .pe-control__button\": {\n        color: \"inherit\",\n\n        \" .pe-control__button--on\": {\n          color: componentVars[\"color_\" + tint + \"_on_icon\"] ||  \"inherit\"\n        },\n\n        \" .pe-control__button--off\": {\n          color: componentVars[\"color_\" + tint + \"_off_icon\"] || componentVars[\"color_\" + tint + \"_off\"]\n        }\n      }\n    },\n    \".pe-control--off\": {\n      \" .pe-button--focus .pe-button__focus\": {\n        opacity: componentVars[\"color_\" + tint + \"_focus_off_opacity\"],\n        backgroundColor: componentVars[\"color_\" + tint + \"_focus_off\"]\n      }\n    },\n    \".pe-control--on\": {\n      \" .pe-button--focus .pe-button__focus\": {\n        opacity: componentVars[\"color_\" + tint + \"_focus_on_opacity\"],\n        backgroundColor: componentVars[\"color_\" + tint + \"_focus_on\"]\n      }\n    },\n\n    \".pe-control--disabled\": {\n      \" .pe-control__label\": {\n        color: componentVars[\"color_\" + tint + \"_disabled\"]\n      },\n      \" .pe-control__box\": {\n        \" .pe-control__button--on, .pe-control__button--off\": {\n          color: componentVars[\"color_\" + tint + \"_disabled\"]\n        }\n      }\n    }\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style(\"\",                selector, componentVars, \"light\"),\n  style(\".pe-dark-theme \", selector, componentVars, \"dark\" ) // inside dark theme\n];\n\n","// Returns a style function to be used by checkbox and radio-button\n\nimport { mixin, flex } from \"polythene-css\";\nimport { vars } from \"polythene-theme\";\n\nconst getSize = (componentVars, height, iconSize = vars.unit_icon_size) => {\n  const labelSize = iconSize + 2 * componentVars.label_padding;\n  const iconOffset = (labelSize - iconSize) / 2;\n  return {\n    \" .pe-control__form-label\": {\n      height: height + \"px\"\n    },\n    \" .pe-control__box\": {\n      width: iconSize + \"px\",\n      height: iconSize + \"px\"\n    },\n    \" .pe-button__content\": {\n      width: labelSize + \"px\",\n      height: labelSize + \"px\",\n\n      \" .pe-icon\": [\n        mixin.fit(iconOffset)\n      ]\n    }\n  };\n};\n\nconst activeButton = () => ({\n  opacity: 1,\n  zIndex: 1\n});\n\nconst inactiveButton = () => ({\n  opacity: 0,\n  zIndex: 0\n});\n\nexport default (selector, componentVars, type) => [{\n  [selector]: {\n    display: \"inline-block\",\n    boxSizing: \"border-box\",\n    margin: 0,\n    padding: 0,\n\n    \" .pe-control__form-label\": [\n      flex.layoutHorizontal,\n      flex.layoutCenter, {\n        position: \"relative\",\n        cursor: \"pointer\",\n        fontSize: componentVars.label_font_size + \"px\",\n        lineHeight: componentVars.label_height + \"px\",\n        margin: 0,\n        color: \"inherit\",\n\n        \":focus\": {\n          outline: 0\n        },\n      }\n    ],\n\n    \".pe-control--inactive\": {\n      \" .pe-control__form-label\": {\n        cursor: \"default\"\n      }\n    },\n\n    [\" input[type=\" + type + \"].pe-control__input\"]: [\n      mixin.vendorize({\n        appearance: \"none\"\n      }, vars.prefixes_appearance), {\n        lineHeight: componentVars.label_height + \"px\",\n        // Hide input element\n        position: \"absolute\",\n        zIndex: \"-1\",\n        width: 0,\n        height: 0,\n        margin: 0,\n        padding: 0,\n        opacity: 0,\n        border: \"none\",\n        pointerEvents: \"none\"\n      }\n    ],\n\n    \" .pe-control__box\": {\n      position: \"relative\",\n      display: \"inline-block\",\n      boxSizing: \"border-box\",\n      width: componentVars.label_height + \"px\",\n      height: componentVars.label_height + \"px\",\n      color: \"inherit\",\n\n      \":focus\": {\n        outline: 0,\n      }\n    },\n\n    \" .pe-button.pe-control__button\": [\n      mixin.defaultTransition(\"opacity\", componentVars.animation_duration), {\n        position: \"absolute\",\n        left: -((componentVars.button_size - componentVars.icon_size) / 2) + \"px\",\n        top: -((componentVars.button_size - componentVars.icon_size) / 2) + \"px\",\n        zIndex: 1\n          // opacity: 0,\n          // \"pointer-events\": \"auto\"\n      }\n    ],\n\n    \".pe-control--off\": {\n      \" .pe-control__button--on\": inactiveButton(),\n      \" .pe-control__button--off\": activeButton()\n    },\n\n    \".pe-control--on\": {\n      \" .pe-control__button--on\": activeButton(),\n      \" .pe-control__button--off\": inactiveButton()\n    },\n\n    \" .pe-control__label\": {\n      marginBottom: \"-1px\", // make text vertically center to box\n      paddingLeft: componentVars.padding + \"px\",\n      paddingRight: componentVars.padding + \"px\"\n    },\n\n    \".pe-control--disabled\": {\n      \" .pe-control__form-label\": {\n        cursor: \"auto\"\n      },\n      \" .pe-control__button\": {\n        pointerEvents: \"none\"\n      }\n    },\n\n    \" .pe-button__content\": {\n      \" .pe-icon\": {\n        position: \"absolute\"\n      }\n    },\n\n    \".pe-control--small\": getSize(componentVars, vars.unit_icon_size_small, vars.unit_icon_size_small),\n    \".pe-control--regular\": getSize(componentVars, componentVars.label_height, vars.unit_icon_size),\n    \".pe-control--medium\": getSize(componentVars, vars.unit_icon_size_medium, vars.unit_icon_size_medium),\n    \".pe-control--large\": getSize(componentVars, vars.unit_icon_size_large, vars.unit_icon_size_large)\n  }\n}];\n"],"names":["classes","typeClasses","small","regular","medium","large","classForType","mode","view","attrs","vnode","state","checked","setChecked","selectable","undefined","inactive","disabled","element","name","props","babelHelpers.extends","filterSupportedAttributes","component","defaultClass","on","off","size","class","join","events","content","m","input","value","type","setInputEl","dom","formLabel","toggle","controlView","label","before","after","selectionControl","defaultChecked","inputEl","setInputElChecked","isChecked","getAttrsChecked","v","el","getState","createIcon","onOffType","msvg","theme","icon","box","iconButton","button","center","rgba","vars","activeColor","color_primary","label_padding","grid_unit_icon_button","unit_icon_size","grid_unit_component","Math","floor","animation_duration","color_light_foreground","blend_light_text_secondary","blend_light_text_disabled","color_dark_foreground","blend_dark_text_secondary","blend_dark_text_disabled","style","scope","selector","componentVars","tint","getSize","height","iconSize","labelSize","iconOffset","mixin","fit","activeButton","inactiveButton","flex","layoutHorizontal","layoutCenter","label_font_size","label_height","vendorize","prefixes_appearance","defaultTransition","button_size","icon_size","padding","unit_icon_size_small","unit_icon_size_medium","unit_icon_size_large"],"mappings":"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"}