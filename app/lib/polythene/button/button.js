define(["polythene/polythene/polythene","mithril","polythene/ripple/ripple","polythene/shadow/shadow","css!./button"],function(e,n,t,i){"use strict";var o,a,r;return o=function(o,s){var l,d,u,p,c;return s=s||{},s.ripple=s.ripple||{},s.shadow=s.shadow||{},l=s.tag||(s.url?"a":"div"),p=void 0!==s.ink&&!s.ink,s.disabled&&(l+="[disabled]"),p&&(l+="[noink]"),s.raised&&(l+="[raised]"),d={"class":[s.parentClass||"button",s["class"]].join(" ")},s.disabled||(d=Object.assign({},d,{config:function(e,n,t){n||(a(e,o,s.shadow),t.onunload=function(){r(e)})}},s.url?s.url:null)),c=null,s.label&&(c=n("span",s.label)),s.content&&(c=s.content),u=[n("div",{"class":"button-content"},[c,s.disabled||p?null:n.component(t,s.ripple),s.disabled||void 0!==s.wash&&!s.wash?null:n(".wash[fit]"),s.raised&&!s.disabled?n.component(i,{z:o.z(),animated:!0}):null])],n(l,d,e.insertContent(u,s))},a=function(e,t,i){var o,a,r;o=5,a=t.baseZ(),r=i.increase||1,e.addEventListener("mousedown",function(){if(5!=a){var e=t.z();e+=r,e=Math.min(e,o),t.z(e),n.redraw()}}),e.addEventListener("mouseup",function(){if(5!=a){var e=t.z();e-=r,e=Math.max(e,a),t.z(e),n.redraw()}})},r=function(e){e.removeEventListener("mousedown"),e.removeEventListener("mouseup")},{controller:function(e){return{view:n.prop(),baseZ:n.prop(e.z||1),z:n.prop(e.z||1)}},view:function(e,n){n=n||{};var t=e.view();return(!t||n.refresh)&&(t=o(e,n),e.view(t)),t}}});