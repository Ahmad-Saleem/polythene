{"version":3,"file":"polythene-core-base-spinner.js","sources":["../src/classes.js","../src/spinner.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:   \"pe-spinner\",\n\n  // elements\n  animation:   \"pe-spinner__animation\",\n  placeholder: \"pe-spinner__placeholder\",\n\n  // states\n  animated:    \"pe-spinner--animated\",\n  fab:         \"pe-spinner--fab\",\n  large:       \"pe-spinner--large\",\n  medium:      \"pe-spinner--medium\",\n  permanent:   \"pe-spinner--permanent\",\n  raised:      \"pe-spinner--raised\",\n  regular:     \"pe-spinner--regular\",\n  singleColor: \"pe-spinner--single-color\",\n  small:       \"pe-spinner--small\",\n  visible:     \"pe-spinner--visible\",\n};\n","import { filterSupportedAttributes, show, hide } from \"polythene-core\";\nimport classes from \"./classes\";\n\nconst sizeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large,\n  fab:     classes.fab\n};\n\nconst classForSize = (size = \"regular\") => sizeClasses[size];\n\nconst showSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: false, transitioning: true });\n  }\n  return show(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: true, transitioning: false });\n    }\n    if (attrs.didShow) {\n      attrs.didShow(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nconst hideSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: true, transitioning: true });\n  }\n  return hide(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: false, transitioning: false });\n    }\n    if (attrs.didHide) {\n      attrs.didHide(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const visible = createStream(false);\n  const dom = createStream();\n  return {\n    dom,\n    visible,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.dom(vnode.dom);\n\n  if (!attrs.permanent) {\n    showSpinner(state, attrs);\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass,\n        classForSize(attrs.size),\n        attrs.singleColor ? classes.singleColor: null,\n        attrs.raised ? classes.raised : null,\n        attrs.animated ? classes.animated : null,\n        attrs.permanent ? classes.permanent : null,\n        attrs.permanent ? classes.visible : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.events\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, Shadow }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  if (state.hide) {\n    setTimeout(() => { hideSpinner(state, attrs); }, 0);\n  }\n\n  return [\n    attrs.raised && attrs.content\n      ? h(Shadow, { key: \"shadow\", z: attrs.z })\n      : null,\n    attrs.content\n  ];\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n  \nexport default {\n  size_small:   3 * vars.grid_unit_component,\n  size_regular: 4 * vars.grid_unit_component,\n  size_medium:  5 * vars.grid_unit_component,\n  size_large:   6 * vars.grid_unit_component,\n  size_fab:     7 * vars.grid_unit_component,\n\n  raisedSize: size => {\n    const padding = size * 0.25;\n    const paddedSize = size + padding * 2;\n    return { padding, paddedSize };\n  },\n\n  color_light_raised_background: rgba(vars.color_light_background),\n  // also use light background with dark tone\n  color_dark_raised_background: rgba(vars.color_light_background)\n};\n"],"names":["sizeClasses","classes","small","regular","medium","large","fab","classForSize","size","showSpinner","state","attrs","onChange","visible","transitioning","show","_extends","dom","then","didShow","id","hideSpinner","hide","didHide","getInitialState","vnode","createStream","merge","onMount","permanent","createProps","k","keys","filterSupportedAttributes","component","instanceClass","singleColor","raised","animated","className","class","join","events","createContent","h","renderer","Shadow","content","key","z","rgba","colorStr","vars","grid_unit_component","padding","paddedSize","color_light_background"],"mappings":"gUACA,kBACe,uBAGA,oCACA,mCAGA,2BACA,wBACA,2BACA,+BACA,+BACA,6BACA,kCACA,iCACA,4BACA,2LCfTA,SACKC,EAAQC,cACRD,EAAQE,eACRF,EAAQG,aACRH,EAAQI,UACRJ,EAAQK,KAGbC,EAAe,cAACC,0DAAO,gBAAcR,GAAYQ,IAEjDC,EAAc,SAACC,EAAOC,SACtBA,GAAMC,YACFA,UAAWC,SAAS,EAAOC,eAAe,IAE3CC,OAAKC,KACVL,MACMD,EAAMO,gBACChB,EAAQY,WAEpBK,KAAK,WACFP,EAAMC,YACFA,UAAWC,SAAS,EAAMC,eAAe,IAE7CH,EAAMQ,WACFA,QAAQR,EAAMS,MAEhBP,SAAQ,MAIZQ,EAAc,SAACX,EAAOC,SACtBA,GAAMC,YACFA,UAAWC,SAAS,EAAMC,eAAe,IAE1CQ,OAAKN,KACVL,MACMD,EAAMO,gBACChB,EAAQY,WAEpBK,KAAK,WACFP,EAAMC,YACFA,UAAWC,SAAS,EAAOC,eAAe,IAE9CH,EAAMY,WACFA,QAAQZ,EAAMS,MAEhBP,SAAQ,MAILW,EAAkB,SAACC,EAAOC,MAC/Bb,GAAUa,GAAa,cACjBA,6BAIMA,EAAaC,OAAOd,MAI3Be,EAAU,eAChBH,EAAMR,QAGLP,GAAQe,EAAMf,MACdC,EAAQc,EAAMd,QACdM,IAAIQ,EAAMR,KAEXN,EAAMkB,aACGnB,EAAOC,KAIVmB,EAAc,SAACL,QAAeM,KAANC,KAC7BrB,EAAQc,EAAMd,YACbK,MAELiB,4BAA0BtB,eAGtBV,EAAQiC,UACRvB,EAAMwB,cACN5B,EAAaI,EAAMH,MACnBG,EAAMyB,YAAcnC,EAAQmC,YAAa,KACzCzB,EAAM0B,OAASpC,EAAQoC,OAAS,KAChC1B,EAAM2B,SAAWrC,EAAQqC,SAAW,KACpC3B,EAAMkB,UAAY5B,EAAQ4B,UAAY,KACtClB,EAAMkB,UAAY5B,EAAQY,QAAU,KACpCF,EAAM4B,WAAa5B,EAAMoB,EAAES,QAC3BC,KAAK,MAET9B,EAAM+B,SAIGC,EAAgB,SAAClB,QAAmBmB,KAAVC,SAAaC,IAAAA,OAC5CpC,EAAQe,EAAMf,MACdC,EAAQc,EAAMd,YAEhBD,GAAMY,iBACG,aAAoBZ,EAAOC,IAAW,IAIjDA,EAAM0B,QAAU1B,EAAMoC,QAClBH,EAAEE,GAAUE,IAAK,SAAUC,EAAGtC,EAAMsC,IACpC,KACJtC,EAAMoC,uFC5GJG,EAAO,SAACC,iBACJA,+DADwB,sBAIlB,EAAIC,OAAKC,iCACT,EAAID,OAAKC,gCACT,EAAID,OAAKC,+BACT,EAAID,OAAKC,6BACT,EAAID,OAAKC,+BAEX,eACJC,GAAiB,IAAP9C,SAEP8C,UAASC,WADC/C,EAAiB,EAAV8C,kCAIGJ,EAAKE,OAAKI,qDAEXN,EAAKE,OAAKI"}