define(["polythene/polythene/polythene","mithril","polythene/ripple/ripple","polythene/shadow/shadow","css!./button"],function(n,e,t,o){"use strict";var i,a,r,s,l;return i=function(i,a){var r,d,u,p,c;return a=a||{},a.ripple=a.ripple||{},a.shadow=a.shadow||{},r=a.tag||(a.url?"a":"div"),p=void 0!==a.ink&&!a.ink,a.disabled&&(r+="[disabled]"),p&&(r+="[noink]"),a.raised&&(r+="[raised]"),d={"class":[a.parentClass||"button",a["class"]].join(" ")},a.disabled||(d=Object.assign({},d,{config:function(n,e,t){e||(s(n,i,a.shadow),t.onunload=function(){l(n)})}},a.url?a.url:null)),c=null,a.label&&(c=e("span",a.label)),a.content&&(c=a.content),u=[e("div",{"class":"button-content"},[c,a.disabled||p?null:e.component(t,a.ripple),a.disabled||void 0!==a.wash&&!a.wash?null:e(".wash[fit]"),a.raised&&!a.disabled?e.component(o,{z:i.z(),animated:!0}):null])],e(r,d,n.insertContent(u,a))},s=function(n,t,o){var i=function(n){var i,a,r;if(i=5,a=t.baseZ(),r=o.increase||1,5!=a){var s=t.z();"down"===n?(s+=r,s=Math.min(s,i)):"up"==n&&(s-=r,s=Math.max(s,a)),t.z(s),e.redraw()}};a=function(){i("down")},r=function(){i("up")},n.addEventListener("mousedown",a),n.addEventListener("mouseup",r)},l=function(n){n.removeEventListener("mousedown",a),n.removeEventListener("mouseup",r)},{controller:function(n){return{view:e.prop(),baseZ:e.prop(n.z||1),z:e.prop(n.z||1)}},view:function(n,e){e=e||{};var t=n.view();return(!t||e.refresh)&&(t=i(n,e),n.view(t)),t}}});