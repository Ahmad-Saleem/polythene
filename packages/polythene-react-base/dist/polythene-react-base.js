!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("react-hyperscript"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-hyperscript","react-dom"],e):e(t.polythene={},t.react,t["react-hyperscript"],t["react-dom"])}(this,function(t,e,n,r){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n=n&&n.hasOwnProperty("default")?n.default:n,r=r&&r.hasOwnProperty("default")?r.default:r;var h={autofocus:"autoFocus",class:"className",className:"className",enctype:"encType",formaction:"formAction",maxlength:"maxLength",minlength:"minLength",onblur:"onBlur",onchange:"onChange",onclick:"onClick",onfocus:"onFocus",oninput:"onInput",onkeydown:"onKeyDown",onkeyup:"onKeyUp",onmousedown:"onMouseDown",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onscroll:"onScroll",onsubmit:"onSubmit",ontouchend:"onTouchEnd",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",readonly:"readOnly",tabindex:"tabIndex"},y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),m=function(t){return function(e){function n(e){o(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),i=y({},t,{state:{},attrs:r.props,redrawValues:void 0});return t.oninit&&t.oninit(i),r.state=i,r}return i(n,e),v(n,[{key:"componentDidMount",value:function(){var t=this;this._mounted=!0,this.state.state.redrawOnUpdate&&this.state.state.redrawOnUpdate.map(function(e){t._mounted&&t.setState({redrawValues:e})})}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"render",value:function(){return t.view({state:this.state.state,attrs:this.props},this.props.children)}}]),n}(e.Component)},_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return"object"===_(e[0])?n.call.apply(n,[null,m(e[0])].concat(u(e.slice(1)))):n.call.apply(n,[null].concat(e))};b.trust=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return null==t&&(t=""),n(e,{dangerouslySetInnerHTML:{__html:t}})};var O=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t){!function(){function e(){function t(){return arguments.length>0&&arguments[0]!==j&&r(t,arguments[0]),t._state.value}return n(t),arguments.length>0&&arguments[0]!==j&&r(t,arguments[0]),t}function n(t){t.constructor=e,t._state={id:w++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},t.map=t["fantasy-land/map"]=l,t["fantasy-land/ap"]=p,t["fantasy-land/of"]=e,t.valueOf=d,t.toJSON=h,t.toString=d,Object.defineProperties(t,{end:{get:function(){if(!t._state.endStream){var n=e();n.map(function(e){return!0===e&&(f(t),n._state.unregister=function(){f(n)}),e}),t._state.endStream=n}return t._state.endStream}}})}function r(t,e){o(t,e);for(var n in t._state.deps)a(t._state.deps[n],!1);null!=t._state.unregister&&t._state.unregister(),i(t)}function o(t,e){t._state.value=e,t._state.changed=!0,2!==t._state.state&&(t._state.state=1)}function a(t,e){var n=t._state.parents;if(n.length>0&&n.every(v)&&(e||n.some(m))){var r=t._state.derive();if(r===j)return!1;o(t,r)}}function i(t){t._state.changed=!1;for(var e in t._state.deps)t._state.deps[e]._state.changed=!1}function u(t,n){if(!n.every(y))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return s(e(),n,function(){return t.apply(this,n.concat([n.filter(m)]))})}function s(t,e,n){var r=t._state;return r.derive=n,r.parents=e.filter(_),c(t,r.parents),a(t,!0),t}function c(t,e){for(var n=0;n<e.length;n++)e[n]._state.deps[t._state.id]=t,c(t,e[n]._state.parents)}function f(t){for(var e=0;e<t._state.parents.length;e++)delete t._state.parents[e]._state.deps[t._state.id];for(var n in t._state.deps){var r=t._state.deps[n],o=r._state.parents.indexOf(t);o>-1&&r._state.parents.splice(o,1)}t._state.state=2,t._state.deps={}}function l(t){return u(function(e){return t(e())},[this])}function p(t){return u(function(t,e){return t()(e())},[t,this])}function d(){return this._state.value}function h(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function y(t){return t._state}function v(t){return 1===t._state.state}function m(t){return t._state.changed}function _(t){return 2!==t._state.state}function b(t){return u(function(){return t.map(function(t){return t()})},t)}function O(t,e,n){var r=u(function(n){return e=t(e,n._state.value)},[n]);return 0===r._state.state&&r(e),r}function g(t,e){var n=t.map(function(t){var e=t[0];return 0===e._state.state&&e(void 0),e});return u(function(){var r=arguments[arguments.length-1];return n.forEach(function(n,o){r.indexOf(n)>-1&&(e=t[o][1](e,n._state.value))}),e},n)}var w=0,j={};e["fantasy-land/of"]=e,e.merge=b,e.combine=u,e.scan=O,e.scanMerge=g,e.HALT=j,t.exports=e}()}),g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},w=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),j=function(t){var n=t.createContent,o=void 0===n?function(){}:n,a=t.createProps,i=void 0===a?function(){return{}}:a,u=t.getElement,l=void 0===u?function(){return"div"}:u,p=t.component,d=t.getInitialState,y=void 0===d?function(){return{}}:d,v=t.onMount,m=void 0===v?function(){}:v,_=t.onUnMount,j=void 0===_?function(){}:_,k=t.view,M=void 0===k?null:k;return function(t){function e(t){s(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=g({},p,n.createVirtualNode(),{redrawValues:void 0}),o=y(r,O);return n.state=o,n.registerDOM=n.registerDOM.bind(n),n._render=n._render.bind(n),n}return f(e,t),w(e,[{key:"componentDidMount",value:function(){var t=this;this._mounted=!0,this.state.redrawOnUpdate&&this.state.redrawOnUpdate.map(function(e){return t._mounted&&t.setState({redrawValues:e})}),m(this.createVirtualNode())}},{key:"componentWillUnmount",value:function(){this._mounted=!1,j(this.createVirtualNode())}},{key:"createVirtualNode",value:function(){var t=g({},this.props);return{state:this.state,attrs:t,children:t.children,dom:this.dom}}},{key:"registerDOM",value:function(t){this.dom||(this.dom=r.findDOMNode(t))}},{key:"_render",value:function(){var t=this.createVirtualNode();return b(p||l(t),g({},i(t,{renderer:b,requiresKeys:!0,keys:h}),{ref:this.registerDOM}),[t.attrs.before,o(t,{renderer:b,requiresKeys:!0,keys:h}),t.attrs.after])}},{key:"render",value:function(){return M?M(this.createVirtualNode(),{renderer:b,render:this._render}):this._render(this.props)}}]),e}(e.Component)},k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},M=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),S=function(t){var n=t.createContent,o=void 0===n?function(){}:n,a=t.createProps,i=void 0===a?function(){return{}}:a,u=t.getElement,s=void 0===u?function(){return"div"}:u,c=t.onMount,f=void 0===c?function(){}:c,y=t.onUnMount,v=void 0===y?function(){}:y,m=t.component,_=t.view,O=void 0===_?null:_;return function(t){function e(t){l(this,e);var n=p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.registerDOM=n.registerDOM.bind(n),n._render=n._render.bind(n),n}return d(e,t),M(e,[{key:"componentDidMount",value:function(){f(this.createVirtualNode())}},{key:"componentWillUnmount",value:function(){v(this.createVirtualNode())}},{key:"createVirtualNode",value:function(){var t=k({},this.props);return{attrs:t,children:t.children,dom:this.dom}}},{key:"registerDOM",value:function(t){this.dom||(this.dom=r.findDOMNode(t))}},{key:"_render",value:function(){var t=this.createVirtualNode();return b(m||s(t),k({},i(t,{renderer:b,requiresKeys:!0,keys:h}),{ref:this.registerDOM}),[t.attrs.before,o(t,{renderer:b,requiresKeys:!0,keys:h}),t.attrs.after])}},{key:"render",value:function(){return O?O(this.createVirtualNode(),{renderer:b,render:this._render}):this._render(this.props)}}]),e}(e.Component)};t.keys=h,t.MithrilToReact=m,t.renderer=b,t.StateComponent=j,t.ViewComponent=S,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-react-base.js.map
