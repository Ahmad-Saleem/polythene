define(["polythene/polythene/polythene","mithril","polythene/ripple/ripple","polythene/shadow/shadow","css!./button"],function(n,e,t,o){"use strict";var i,a,s,r,l;return i=function(i,a){var s,d,u,p,c;return a=a||{},a.ripple=a.ripple||{},a.shadow=a.shadow||{},s=a.tag||(a.url?"a":"div"),p=void 0!==a.ink&&!a.ink,a.disabled&&(s+="[disabled]"),p&&(s+="[noink]"),a.raised&&(s+="[raised]"),d={"class":[a.parentClass||"button",a["class"]].join(" ")},a.disabled||(d=Object.assign({},d,{config:function(n,e,t){e||(r(n,i,a.shadow),t.onunload=function(){l(n)})}},a.url?a.url:null,a.events?a.events:null)),c=null,a.label&&(c=e("span",a.label)),a.content&&(c=a.content),u=[e("div",{"class":"button-content"},[c,a.disabled||p?null:e.component(t,a.ripple),a.disabled||void 0!==a.wash&&!a.wash?null:e(".wash[fit]"),a.raised&&!a.disabled?e.component(o,{z:i.z(),animated:!0}):null])],e(s,d,n.insertContent(u,a))},r=function(n,t,o){var i=function(n){var i,a,s;if(i=5,a=t.baseZ(),s=o.increase||1,5!=a){var r=t.z();"down"===n?(r+=s,r=Math.min(r,i)):"up"==n&&(r-=s,r=Math.max(r,a)),t.z(r),e.redraw()}};a=function(){i("down")},s=function(){i("up")},n.addEventListener("mousedown",a),n.addEventListener("mouseup",s)},l=function(n){n.removeEventListener("mousedown",a),n.removeEventListener("mouseup",s)},{controller:function(n){var t=void 0!==n.z?n.z:1;return{view:e.prop(),baseZ:e.prop(t),z:e.prop(t)}},view:function(n,e){e=e||{};var t=n.view();return(!t||e.refresh)&&(t=i(n,e),n.view(t)),t}}});