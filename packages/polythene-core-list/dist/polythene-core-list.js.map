{"version":3,"file":"polythene-core-list.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/index.js","../src/list.js"],"sourcesContent":["import { classes as coreListTileClasses } from \"polythene-core-list-tile\";\n\nexport default {\n  component:       \"pe-list\",\n\n  // elements\n  header:          coreListTileClasses.header,\n\n  // states\n  borders:         \"pe-list--borders\",\n  compact:         \"pe-list--compact\",\n  hasHeader:       \"pe-list--header\",\n  indentedBorders: \"pe-list--indented-borders\",\n  padding:         \"pe-list--padding\",\n};\n","import { vars } from \"polythene-theme\";\nimport { rgba } from \"polythene-core-css\";\n\nexport default {\n  padding:                vars.grid_unit_component, // vertical padding\n  padding_compact:        vars.grid_unit_component * 3/4,\n  border_width_stacked:   1,\n  border_width_bordered:  1,\n\n  color_light_border:     rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_dark_border:      rgba(vars.color_dark_foreground,  vars.blend_dark_border_light),\n\n  // background color may be set in theme; disabled by default\n  // color_light_background: \"inherit\",\n  // color_dark_background:  \"inherit\"\n};\n","\nconst borderStyle = componentVars => ({\n  borderStyle: \"none none solid none\",\n  borderWidth: componentVars.border_width_bordered + \"px\"\n});\n\nexport default (selector, componentVars) => [{\n  [selector]: {\n    \n    \".pe-list--padding\": {\n      padding: componentVars.padding + \"px 0\",\n    },\n\n    \".pe-list--header\": {\n      paddingTop: 0\n    },\n\n    \".pe-list--compact\": {\n      padding: componentVars.padding_compact + \"px 0\",\n    },\n\n    \"& + &\": {\n      borderStyle: \"solid none none none\",\n      borderWidth: componentVars.border_width_stacked + \"px\"\n    },\n\n    \".pe-list--borders\": {\n      \" .pe-list-tile\": {\n        \":not(.pe-list-tile--header):not(:last-child)\": {\n          \"&\": borderStyle(componentVars)\n        }\n      }\n    },\n\n    \".pe-list--indented-borders\": {\n      borderTop: \"none\",\n\n      \" .pe-list-tile\": {\n        \":not(.pe-list-tile--header):not(:last-child)\": {\n          \" .pe-list-tile__content:not(.pe-list-tile__content-front)\": borderStyle(componentVars)\n        }\n      }\n    }\n  }\n}];\n","const style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n    backgroundColor: componentVars[\"color_\" + tint + \"_background\"],\n\n    [\"& + .pe-list\"]: {\n      borderTopColor: componentVars[\"color_\" + tint + \"_border\"]\n    },\n\n    \".pe-list--borders\": {\n      \" .pe-list-tile\": {\n        \":not(:last-child)\": {\n          borderColor: componentVars[\"color_\" + tint + \"_border\"]\n        }\n      }\n    },\n\n    \".pe-list--indented-borders\": {\n      \" .pe-list-tile\": {\n        \" .pe-list-tile__content:not(.pe-list-tile__content-front)\": {\n          borderColor: componentVars[\"color_\" + tint + \"_border\"]\n        }\n      }\n    }\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\n    \".pe-dark-tone\",\n    \".pe-dark-tone \"\n  ], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\n    \"\",\n    \".pe-light-tone\",\n    \".pe-light-tone \"\n  ], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nexport const customTheme = (customSelector, customVars) => \n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns);\n\nstyler.generateStyles([selector], vars, fns);\n","import { filterSupportedAttributes } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nexport const theme = customTheme;\n\nconst onSelect = (event, vnode) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.onSelect) {\n    const highlightIndex = state.highlightIndex();\n    const data = {\n      event,\n      index: highlightIndex,\n      dom: state.tiles[highlightIndex].dom,\n      attrs: state.tiles[highlightIndex].attrs\n    };\n    attrs.onSelect(data);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const highlightIndex = createStream(attrs.defaultHighlightIndex !== undefined\n    ? attrs.defaultHighlightIndex\n    : -1);\n  const registerTile = state => (index, data) => state.tiles[index] = data;\n  return {\n    tiles: [],\n    highlightIndex,\n    registerTile,\n    redrawOnUpdate: createStream.merge([highlightIndex])\n  };\n};\n\nexport const onMount = vnode => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.keyboardControl) {\n    state.highlightIndex.map(index => {\n      if (state.tiles[index]) {\n        state.tiles[index].dom.focus();\n      }\n    });\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.borders ? classes.borders : null,\n        attrs.indentedBorders ? classes.indentedBorders : null,\n        attrs.header ? classes.hasHeader : null,\n        attrs.compact ? classes.compact : null,\n        attrs.padding !== false ? classes.padding : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.keyboardControl && {\n      [k.onkeydown]: e => {\n        const highlightIndex = state.highlightIndex();\n        if (e.key === \"ArrowDown\" || e.key === \"ArrowRight\") {\n          e.preventDefault(); // prevent scrolling the page\n          const newIndex = Math.min(state.tiles.length - 1, highlightIndex + 1);\n          state.tiles[newIndex].dom.focus();\n        } else if (e.key === \"ArrowUp\" || e.key === \"ArrowLeft\") {\n          e.preventDefault(); // prevent scrolling the page\n          const newIndex = Math.max(0, highlightIndex - 1);\n          state.tiles[newIndex].dom.focus();\n        } else if (e.key === \"Enter\") {\n          onSelect(e, vnode);\n        } else if (e.key === \"Escape\") {\n          state.tiles[highlightIndex].dom.blur();\n          state.highlightIndex(-1);\n        }\n      },\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, requiresKeys, keys: k, ListTile }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  let headerOpts;\n  if (attrs.header) {\n    headerOpts = Object.assign(\n      {},\n      attrs.header\n    );\n    headerOpts[k.class] = [\n      classes.header,\n      headerOpts[k.class] || null\n    ].join(\" \");\n  }\n  const highlightIndex = state.highlightIndex();\n  const tiles = attrs.tiles\n    ? attrs.tiles\n    : attrs.content\n      ? attrs.content\n      : attrs.children || vnode.children;\n  let index = -1;\n  return [\n    headerOpts ? h(ListTile, Object.assign(\n      {},\n      requiresKeys ? { key: \"header\" } : null,\n      headerOpts,\n      {\n        header: true\n      }\n    )) : null,\n    attrs.keyboardControl\n      ? tiles.map(tileOpts => {\n        if (!tileOpts.header) {\n          index++;\n        }\n        return tileOpts.tag !== undefined\n          ? tileOpts\n          : h(ListTile, Object.assign(\n            {},\n            tileOpts,\n            !tileOpts.header && {\n              keyboardControl: true,\n              register: state.registerTile(state),\n              setHighlightIndex: state.highlightIndex,\n              index,\n              defaultHighlight: highlightIndex === index,\n              events: Object.assign(\n                {},\n                tileOpts.events,\n                {\n                  [k.onclick]: e => onSelect(e, vnode)\n                }\n              )\n            }\n          ));\n      })\n      : tiles\n  ];\n};\n"],"names":["coreListTileClasses","header","vars","grid_unit_component","rgba","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light","borderStyle","componentVars","border_width_bordered","selector","padding","padding_compact","border_width_stacked","style","scopes","tint","map","s","join","fns","layout","color","classes","component","customTheme","customSelector","customVars","styler","generateStyles","getElement","vnode","attrs","element","theme","onSelect","event","state","highlightIndex","data","tiles","dom","getInitialState","createStream","undefined","defaultHighlightIndex","index","merge","onMount","keyboardControl","focus","createProps","k","keys","_extends","filterSupportedAttributes","borders","indentedBorders","hasHeader","compact","tone","className","class","onkeydown","e","key","preventDefault","newIndex","Math","min","length","max","blur","createContent","h","renderer","requiresKeys","ListTile","headerOpts","content","children","tileOpts","tag","registerTile","events","onclick"],"mappings":"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"}