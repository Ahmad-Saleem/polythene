{"version":3,"file":"polythene-core-selection-control.js","sources":["../src/classes.js","../src/selection-control.js","../src/view-control.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import { filterSupportedAttributes } from \"polythene-core\";\nimport classes from \"./classes\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst sizeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large\n};\n\nconst classForSize = (size = \"regular\") => sizeClasses[size];\n\nconst currentState = (attrs, state) => {\n  const checked = attrs.checked !== undefined\n    ? attrs.checked\n    : state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  return { checked, inactive };\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const isChecked = attrs.defaultChecked !== undefined\n    ? attrs.defaultChecked\n    : attrs.checked || false;\n  const checked = createStream(isChecked);\n\n  const notifyChange = (e, isChecked) => {\n    if (attrs.onChange) {\n      attrs.onChange({\n        event: e,\n        checked: isChecked,\n        value: attrs.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (attrs.type === \"radio\") {\n      // do not set directly\n    } else {\n      checked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !checked();\n    checked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  return {\n    checked,\n    toggle,\n    onChange,\n    redrawOnUpdate: createStream.merge([checked])\n  };\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const { checked, inactive } = currentState(attrs, state);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass, // for instance pe-checkbox-control\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(attrs.size),\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, ViewControl }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const { checked, inactive } = currentState(attrs, state);\n  const viewControlClickHandler = attrs.events && attrs.events[k.onclick];\n  const viewControlKeyDownHandler = attrs.events && attrs.events[k.onkeydown]\n    ? attrs.events[k.onkeydown]\n    : e => {\n      if (e.key === \"Enter\") {\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          state.toggle(e);\n        }\n      }\n    };\n\n  return h(\"label\",\n    Object.assign(\n      {},\n      { className: classes.formLabel }\n    ),\n    [\n      h(ViewControl, Object.assign(\n        {},\n        attrs,\n        {\n          inactive,\n          checked,\n          key: \"control\",\n          events: {\n            // Only use key down event; click events are handled by input element\n            [k.onkeydown]: viewControlKeyDownHandler\n          }\n        }\n      )),\n      attrs.label\n        ? h(`.${classes.label}`,\n          { key: \"label\" },\n          attrs.label\n        )\n        : null,\n      h(\"input\", Object.assign(\n        {},\n        attrs.events,\n        {\n          name: attrs.name,\n          type: attrs.type,\n          value: attrs.value,\n          checked\n        },\n        attrs.disabled || inactive\n          ? { disabled: \"disabled\" }\n          : {\n            [k.onchange]: state.onChange\n          }\n      ))\n    ]\n  );\n};\n","import classes from \"./classes\";\n\nconst CONTENT = [\n  { iconType: \"iconOn\", className: classes.buttonOn},\n  { iconType: \"iconOff\", className: classes.buttonOff}\n];\n\nexport const getElement = vnode =>\n  vnode.attrs.element || `.${classes.box}`;\n\nconst createIcon = (h, iconType, attrs, className) => (\n  // if attrs.iconOn/attrs.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    {\n      className,\n      key: iconType\n    },\n    attrs[iconType]\n      ? attrs[iconType]\n      : { svg: { content: h.trust(attrs.icons[iconType]) } },\n    attrs.icon,\n    attrs.size\n      ? { size: attrs.size }\n      : null\n  )\n);\n\nexport const createContent = (vnode, { renderer: h, Icon, IconButton }) => {\n  const attrs = vnode.attrs;\n  return h(IconButton, Object.assign(\n    {},\n    {\n      element: \"div\",\n      key: attrs.key,\n      className: classes.button,\n      content: CONTENT.map(o =>\n        h(Icon, createIcon(h, o.iconType, attrs, o.className))\n      ),\n      ripple: { center: true },\n      disabled: attrs.disabled,\n      events: attrs.events,\n      inactive: attrs.inactive\n    },\n    attrs.iconButton // for example for hover behaviour\n  ));\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  label_font_size:                     2 * vars.grid_unit_component, // 16\n  label_height:                        3 * vars.grid_unit_component, // 24\n  label_padding_before:                vars.grid_unit * 4, // 16\n  label_padding_after:                 0,\n  button_size:                         6 * vars.grid_unit_component,\n  icon_size:                           3 * vars.grid_unit_component,\n  animation_duration:                  vars.animation_duration,\n\n  color_light_on:                      rgba(vars.color_primary),\n  color_light_off:                     rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_label:                   rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled:                rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_thumb_off_focus_opacity: .08,\n  color_light_thumb_on_focus_opacity:  .11,\n\n  // icon colors may be set in theme; set to \"inherit\" by default\n  // color_light_on_icon\n  // color_light_off_icon\n\n  // label on/off colors may be set in theme; set to color_light_label by default\n  // color_light_on_label\n  // color_light_off_label\n\n  color_light_focus_on:                rgba(vars.color_primary),\n  color_light_focus_on_opacity:        .11,\n  color_light_focus_off:               rgba(vars.color_light_foreground),\n  color_light_focus_off_opacity:       .07,\n\n  color_dark_on:                       rgba(vars.color_primary),\n  color_dark_off:                      rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_label:                    rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_thumb_off_focus_opacity:  .08,\n  color_dark_thumb_on_focus_opacity:   .11,\n\n  // icon color may be set in theme; set to \"inherit\" by default\n  // color_dark_on_icon\n  // color_dark_off_icon\n  \n  // label on/off colors may be set in theme; set to color_dark_label by default\n  // color_dark_on_label\n  // color_dark_off_label\n\n  color_dark_focus_on:                 rgba(vars.color_primary), // or '#80cbc4'\n  color_dark_focus_on_opacity:         .14,\n  color_dark_focus_off:                rgba(vars.color_dark_foreground),\n  color_dark_focus_off_opacity:        .09\n};\n"],"names":["getElement","vnode","attrs","element","sizeClasses","classes","small","regular","medium","large","classForSize","size","currentState","state","checked","undefined","selectable","inactive","disabled","getInitialState","createStream","defaultChecked","notifyChange","e","isChecked","onChange","value","newChecked","currentTarget","type","merge","createProps","k","keys","_extends","filterSupportedAttributes","component","instanceClass","on","off","tone","className","class","join","createContent","h","renderer","ViewControl","viewControlClickHandler","events","onclick","viewControlKeyDownHandler","onkeydown","key","toggle","formLabel","label","name","onchange","CONTENT","iconType","buttonOn","buttonOff","box","createIcon","svg","content","trust","icons","icon","Icon","IconButton","button","map","o","center","iconButton","rgba","colorStr","vars","grid_unit_component","grid_unit","animation_duration","color_primary","color_light_foreground","blend_light_text_secondary","blend_light_text_disabled","color_dark_foreground","blend_dark_text_secondary","blend_dark_text_disabled"],"mappings":"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"}