{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/index.js","../src/dialog-pane.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","import { vars } from \"polythene-theme\";\nimport { rgba } from \"polythene-core-css\";\n\nexport default {\n  padding:       3 * vars.grid_unit_component,\n  header_bottom: 20,\n  header_height: 60,\n  footer_height: 52,\n\n  border_width: 1,\n\n  color_light_title_text:          \"inherit\",\n  color_light_body_text:           \"inherit\",\n  color_light_body_border:         rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_light_background:          \"inherit\",\n\n  color_dark_title_text:           \"inherit\",\n  color_dark_body_text:            \"inherit\",\n  color_dark_body_border:          rgba(vars.color_dark_foreground, vars.blend_dark_border_light),\n  color_dark_background:           \"inherit\",\n};\n","import { vars } from \"polythene-theme\";\nimport { mixin, flex } from \"polythene-core-css\";\n\nconst lineHeightTitle = 24;\n\nexport default (selector, componentVars) => [{\n  [selector]: [\n    flex.layoutVertical,\n    {\n      position: \"relative\",\n      maxHeight: \"100%\",\n      minWidth: 56 * 5 + \"px\",\n      maxWidth: 7 * vars.grid_unit_menu + \"px\",\n      borderRadius: \"inherit\",\n      margin: 0,\n      \n      \".pe-menu__content\": {\n        \" .pe-dialog-pane__body\": {\n          padding: 0,\n          border: \"none\"\n        }\n      },\n      \" .pe-dialog-pane__header, pe-dialog-pane__body, pe-dialog-pane__header\": {\n        zIndex: 1\n      },\n\n      \" .pe-dialog-pane__title\": {\n        fontSize: vars.font_size_title + \"px\",\n        lineHeight: lineHeightTitle + \"px\",\n        fontWeight: vars.font_weight_medium,\n\n        \"& + div\": {\n          marginTop: \"16px\"\n        },\n      },\n\n      \" .pe-dialog-pane__header\": {\n        minHeight: componentVars.header_height + \"px\",\n\n        \" .pe-dialog-pane__title\": [\n          mixin.ellipsis(1),\n          {\n            width: \"100%\"\n          }\n        ]\n      },\n\n      \" .pe-dialog-pane__header--title\": {\n        padding: [(componentVars.padding - 4), componentVars.padding, (componentVars.header_bottom - 4), componentVars.padding].map((v) => (v + \"px\")).join(\" \")\n      },\n\n      \" .pe-dialog-pane__body\": [\n        flex.selfStretch,\n        {\n          padding: componentVars.padding + \"px\",\n          overflowY: \"auto\",\n          \"-webkit-overflow-scrolling\": \"touch\",\n          \n          // initially set max-height; will be overridden by dialog core with actual heights\n          maxHeight: \"calc(100vh - \" + (2 * componentVars.padding) + \"px - \" + (componentVars.header_height + componentVars.footer_height) + \"px)\",\n\n          \" p\": {\n            margin: 0\n          },\n          \" p + p\": {\n            marginTop: \"16px\"\n          }\n        }\n      ],\n\n      \".pe-dialog-pane--header.pe-dialog-pane--border-top\": {\n        \" .pe-dialog-pane__body\": {\n          borderTopStyle: \"solid\",\n          borderWidth: componentVars.border_width + \"px\"\n        }\n      },\n\n      \".pe-dialog-pane--footer.pe-dialog-pane--border-bottom\": {\n        \" .pe-dialog-pane__body\": {\n          borderBottomStyle: \"solid\",\n          borderWidth: componentVars.border_width + \"px\"\n        }\n      },\n\n      \".pe-dialog-pane--body-full-bleed .pe-dialog-pane__body\": {\n        padding: 0,\n        borderStyle: \"none\"\n      },\n\n      \" .pe-dialog-pane__header--title + .pe-dialog-pane__body\": {\n        paddingTop: 0\n      },\n\n      \" .pe-dialog-pane__footer\": {\n        \".pe-dialog-pane__footer--high\": {\n          // when buttons are stacked vertically\n          paddingBottom: \"8px\"\n        },\n        \".pe-dialog-pane__footer--buttons\": {\n          padding: \"2px 8px\",\n          minHeight: componentVars.footer_height + \"px\",\n          fontSize: 0, // remove inline block spacing\n        },\n      },\n\n      \" .pe-dialog-pane__actions\": [\n        flex.layoutHorizontal,\n        flex.layoutEndJustified,\n        flex.layoutWrap, {\n          margin: \"0 -4px\",\n\n          \" .pe-button\": {\n            height: \"36px\",\n            marginTop: \"6px\",\n            marginBottom: \"6px\",\n            padding: 0\n          }\n        }\n      ]\n    },\n  ],\n  \".pe-menu__content\": {\n    \" .pe-dialog-pane__body\": {\n      padding: 0,\n      border: \"none\"\n    }\n  },\n  \" .pe-dialog--full-screen\": {\n    \" .pe-dialog-pane__content\": {\n      borderRadius: 0,\n      maxWidth: \"none\",\n      height: \"100vh\",\n      width: \"100vw\",\n    },\n    \" .pe-dialog-pane, .pe-dialog-pane__body\": {\n      height: \"100vh\",\n      maxHeight: \"100vh\",\n      border: \"none\",\n      maxWidth: \"initial\",\n    }\n  }\n}];\n","\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n\n    backgroundColor: componentVars[\"color_\" + tint + \"_background\"],\n    \n    \" .pe-dialog-pane__header .pe-dialog-pane__title\": {\n      color: componentVars[\"color_\" + tint + \"_title_text\"]\n    },\n    \" .pe-dialog-pane__body\": {\n      color: componentVars[\"color_\" + tint + \"_body_text\"],\n      borderColor: \"transparen\" // default\n    },\n    \".pe-dialog-pane--border-top .pe-dialog-pane__body\": {\n      borderTopColor: componentVars[\"color_\" + tint + \"_body_border\"]\n    },\n    \".pe-dialog-pane--border-bottom .pe-dialog-pane__body\": {\n      borderBottomColor: componentVars[\"color_\" + tint + \"_body_border\"]\n    }\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nexport const customTheme = (customSelector, customVars) => \n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns);\n\nstyler.generateStyles([selector], vars, fns);\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nexport const theme = customTheme;\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nconst updateFooterState = vnode => {\n  const state = vnode.state;\n  const footerEl = state.footerEl();\n  if (!footerEl) {\n    return;\n  }\n  const style = window.getComputedStyle(footerEl);\n  const height = footerEl.getBoundingClientRect().height;\n  const minHeight = parseInt(style.minHeight, 10);\n  if (height > minHeight) {\n    footerEl.classList.add(classes.footerHigh);\n  } else {\n    footerEl.classList.remove(classes.footerHigh);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream();\n  const headerEl = createStream();\n  const isScrolling = createStream(false);\n  const scrollEl = createStream();\n  const topOverflow = createStream(false);\n  const el = createStream();\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.title}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n    updateFooterState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n  \n  updateScrollOverflowState(vnode);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (borders === \"overflow\" && state.bottomOverflow());\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n"],"names":["vars","grid_unit_component","rgba","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light","selector","componentVars","flex","layoutVertical","grid_unit_menu","font_size_title","lineHeightTitle","font_weight_medium","header_height","mixin","ellipsis","padding","header_bottom","map","v","join","selfStretch","footer_height","border_width","layoutHorizontal","layoutEndJustified","layoutWrap","style","scopes","tint","s","fns","layout","color","classes","component","customTheme","customSelector","customVars","styler","generateStyles","getElement","vnode","attrs","element","theme","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","updateFooterState","footerEl","window","getComputedStyle","parseInt","minHeight","classList","add","footerHigh","remove","getInitialState","createStream","headerEl","isScrolling","undefined","merge","onMount","dom","el","querySelector","body","footer","title","update","cleanUp","unsubscribe","onUnMount","createProps","k","keys","unpackAttrs","borders","showTopBorder","showBottomBorder","withHeader","header","withFooter","footerButtons","_extends","filterSupportedAttributes","fullBleed","borderTop","borderBottom","tone","className","class","formOptions","createContent","h","renderer","content","menu","menuContent","headerWithTitle","onscroll","scrollWatchId","setTimeout","footerWithButtons","actions"],"mappings":"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"}