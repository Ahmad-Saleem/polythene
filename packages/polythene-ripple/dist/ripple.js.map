{"version":3,"file":null,"sources":["../src/theme/vars.js","../src/theme/layout.js","../src/theme/index.js","../src/ripple.js"],"sourcesContent":["export default {\n  start_scale: 0.1,\n  end_scale: 2,\n  start_opacity: 0.2,\n  end_opacity: 0\n};","import { mixin } from \"polythene-css\";\nimport { vars } from \"polythene-theme\";\n\nconst kfRipple = componentVars => ({\n  \" 100%\": {\n    transform: \"scale(\" + componentVars.end_scale + \")\",\n    \"opacity\": componentVars.end_opacity\n  }\n});\n\nconst createStyles = componentVars => [{\n  \".pe-ripple\": [\n    mixin.fit(), {\n      color: \"inherit\",\n      \"border-radius\": \"inherit\",\n\n      \"&.pe-ripple--constrained\": {\n        \"border-radius\": \"inherit\",\n\n        \" .pe-ripple__mask\": {\n          overflow: \"hidden\",\n          \"border-radius\": \"inherit\"\n        }\n      },\n      \" .pe-ripple__mask\": [\n        mixin.fit(),\n        mixin.vendorize({\n          \"transform\": \"translate3d(0,0,0)\"\n        }, vars.prefixes_transform)\n      ],\n\n      \" .pe-ripple__waves\": [\n        mixin.vendorize({\n          \"transform\": \"scale(\" + componentVars.start_scale + \")\"\n        }, vars.prefixes_transform),\n        mixin.vendorize({\n          \"animation\": \"ripple \" + vars.animation_curve_default\n        }, vars.prefixes_animation),\n        // default durations; finally set in js\n        mixin.vendorize({\n          \"animation-duration\": vars.animation_duration\n        }, vars.prefixes_animation), {\n          outline: \"1px solid transparent\", // for IE10\n          position: \"absolute\",\n          \"border-radius\": \"50%\",\n          opacity: componentVars.start_opacity,\n          \"pointer-events\": \"none\",\n          display: \"none\"\n        }\n      ],\n      \" .pe-ripple__waves--animating\": {\n        display: \"block\"\n      }\n    }\n  ],\n\n  \"@keyframes ripple\": kfRipple(componentVars)\n}];\n\nexport default componentVars => mixin.createStyles(componentVars, createStyles);\n\n","import { styler } from \"polythene-css\";\nimport { styles } from \"polythene-theme\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\n// Does not contain any color styles\n\nconst key = \"ripple\";\nconst className = \"pe-ripple\";\n\nconst styleComponent = (className, styles) =>\n  styler.styleComponent(className, styles, key, vars, layout);\n\nexport const customTheme = (className, vars) =>\n  // Inject additional styles as use className as key\n  styleComponent(className, styler.addComponentStyle(\n    className, styles, key, vars\n  ));\n\nstyleComponent(className, styles);","import m from \"mithril\";\nimport { isTouch, touchEndEvent, animationEndEvent, filterSupportedAttributes } from \"polythene-core\";\nimport { customTheme } from \"./theme\";\n\nconst ANIMATION_END_EVENT = animationEndEvent();\nconst DEFAULT_START_OPACITY = 0.2;\nconst OPACITY_DECAY_VELOCITY = 0.35;\nconst classes = {\n  component: \"pe-ripple\",\n  waves: \"pe-ripple__waves\",\n  mask: \"pe-ripple__mask\",\n  constrained: \"pe-ripple--constrained\",\n  wavesAnimating: \"pe-ripple__waves--animating\"\n};\n\nlet destroyRipple;\n\nconst makeRipple = (e, state, attrs) => {\n  if (state.animating) {\n    return;\n  }\n  const el = state.ripple;\n  const rect = el.getBoundingClientRect();\n  const x = (isTouch && e.touches) ? e.touches[0].pageX : e.clientX;\n  const y = (isTouch && e.touches) ? e.touches[0].pageY : e.clientY;  \n  const w = el.offsetWidth;\n  const h = el.offsetHeight;\n  const waveRadius = Math.sqrt(w * w + h * h);\n  \n  const mx = (attrs.center) ? (rect.left + rect.width / 2) : x;\n  const my = (attrs.center) ? (rect.top + rect.height / 2) : y;\n  const rx = mx - rect.left - waveRadius / 2;\n  const ry = my - rect.top - waveRadius / 2;\n  const initialOpacity = (attrs.initialOpacity !== undefined) ? attrs.initialOpacity : DEFAULT_START_OPACITY;\n  const opacityDecayVelocity = (attrs.opacityDecayVelocity !== undefined) ? attrs.opacityDecayVelocity : OPACITY_DECAY_VELOCITY;\n  const duration = 1 / opacityDecayVelocity * initialOpacity;\n  const color = window.getComputedStyle(el).color;\n\n  const wavesEl = state.waves;\n  const style = wavesEl.style;\n  style.width = style.height = waveRadius + \"px\";\n  style.top = ry + \"px\";\n  style.left = rx + \"px\";\n  style[\"animation-duration\"] =\n    style[\"-webkit-animation-duration\"] =\n    style[\"-moz-animation-duration\"] =\n    style[\"-o-animation-duration\"] = duration + \"s\";\n  style.backgroundColor = color;\n  style.opacity = initialOpacity;\n  state.animating = true;\n  const onEnd = evt => {\n    state.animating = false;\n    wavesEl.classList.remove(classes.wavesAnimating);\n    wavesEl.removeEventListener(ANIMATION_END_EVENT, onEnd, false);\n    if (attrs.end) {\n      attrs.end(evt);\n    }\n  };\n  wavesEl.addEventListener(ANIMATION_END_EVENT, onEnd, false);\n  if (attrs.start) {\n    attrs.start(e);\n  }\n  wavesEl.classList.add(classes.wavesAnimating);\n};\n\nconst initRipple = vnode => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (!vnode.dom) {\n    return;\n  }\n  state.ripple = vnode.dom;\n  state.waves = vnode.dom.querySelector(`.${classes.waves}`);\n  \n  const tap = e => makeRipple(e, state, attrs);\n  const triggerEl = vnode.dom.parentElement;\n  triggerEl.addEventListener(touchEndEvent, tap, false);\n  destroyRipple = () => {\n    triggerEl.removeEventListener(touchEndEvent, tap, false);\n  };\n};\n\nconst view = vnode => {\n  const attrs = vnode.attrs;\n  if (attrs.disabled) {\n    return null;\n  }\n  const element = attrs.element || \"div\";\n  const props = Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      class: [\n        classes.component,\n        (attrs.constrained !== false ? classes.constrained : null),\n        attrs.class\n      ].join(\" \")\n    }\n  );\n  const content = m(\"div\", {\n    class: classes.mask\n  }, m(\"div\", {\n    class: classes.waves\n  }));\n  return m(element, props, [attrs.before, content, attrs.after]);\n};\n\nexport const ripple = {\n  theme: customTheme, // accepts (className, vars)\n  oninit: vnode => {\n    vnode.state = {\n      animating: false,\n      ripple: undefined,\n      waves: undefined\n    };\n  },\n  oncreate: initRipple,\n  onremove: destroyRipple,\n  view\n};\n"],"names":["kfRipple","componentVars","end_scale","end_opacity","createStyles","mixin","fit","vendorize","vars","prefixes_transform","start_scale","animation_curve_default","prefixes_animation","animation_duration","start_opacity","key","className","styleComponent","styles","styler","layout","customTheme","addComponentStyle","ANIMATION_END_EVENT","animationEndEvent","DEFAULT_START_OPACITY","OPACITY_DECAY_VELOCITY","classes","destroyRipple","makeRipple","e","state","attrs","animating","el","ripple","rect","getBoundingClientRect","x","isTouch","touches","pageX","clientX","y","pageY","clientY","w","offsetWidth","h","offsetHeight","waveRadius","Math","sqrt","mx","center","left","width","my","top","height","rx","ry","initialOpacity","undefined","opacityDecayVelocity","duration","color","window","getComputedStyle","wavesEl","waves","style","backgroundColor","opacity","onEnd","classList","remove","wavesAnimating","removeEventListener","end","evt","addEventListener","start","add","initRipple","vnode","dom","querySelector","tap","triggerEl","parentElement","touchEndEvent","view","disabled","element","props","babelHelpers.extends","filterSupportedAttributes","component","constrained","class","join","content","m","mask","before","after"],"mappings":"0cAAA,oBACe,aACF,gBACI,eACF,GCDTA,EAAW,sCAEF,SAAWC,EAAcC,UAAY,YACrCD,EAAcE,eAIvBC,EAAe,kCAEjBC,QAAMC,aACG,0BACU,sDAGE,wCAGL,yBACO,iCAInBD,QAAMC,MACND,QAAME,qBACS,sBACZC,OAAKC,2CAIRJ,QAAME,qBACS,SAAWN,EAAcS,YAAc,KACnDF,OAAKC,oBACRJ,QAAME,qBACS,UAAYC,OAAKG,yBAC7BH,OAAKI,4BAEFL,gCACkBC,OAAKK,oBAC1BL,OAAKI,6BACG,iCACC,2BACO,cACRX,EAAca,+BACL,eACT,kDAIF,+BAKMd,EAASC,0BAGAI,SAAMD,aAAaH,EAAeG,ICrD5DW,EAAM,SACNC,EAAY,YAEZC,EAAiB,SAACD,EAAWE,SACjCC,UAAOF,eAAeD,EAAWE,EAAQH,EAAKP,EAAMY,IAEzCC,EAAc,SAACL,EAAWR,YAEtBQ,EAAWG,SAAOG,kBAC/BN,EAAWE,SAAQH,EAAKP,IAG5BS,GAAeD,EAAWE,kLCdpBK,EAAsBC,sBACtBC,EAAwB,GACxBC,EAAyB,IACzBC,aACO,kBACJ,wBACD,8BACO,wCACG,+BAGdC,SAEEC,EAAa,SAACC,EAAGC,EAAOC,OACxBD,EAAME,cAGJC,GAAKH,EAAMI,OACXC,EAAOF,EAAGG,wBACVC,EAAKC,WAAWT,EAAEU,QAAWV,EAAEU,QAAQ,GAAGC,MAAQX,EAAEY,QACpDC,EAAKJ,WAAWT,EAAEU,QAAWV,EAAEU,QAAQ,GAAGI,MAAQd,EAAEe,QACpDC,EAAIZ,EAAGa,YACPC,EAAId,EAAGe,aACPC,EAAaC,KAAKC,KAAKN,EAAIA,EAAIE,EAAIA,GAEnCK,EAAMrB,EAAMsB,OAAWlB,EAAKmB,KAAOnB,EAAKoB,MAAQ,EAAKlB,EACrDmB,EAAMzB,EAAMsB,OAAWlB,EAAKsB,IAAMtB,EAAKuB,OAAS,EAAKhB,EACrDiB,EAAKP,EAAKjB,EAAKmB,KAAOL,EAAa,EACnCW,EAAKJ,EAAKrB,EAAKsB,IAAMR,EAAa,EAClCY,EAA2CC,SAAzB/B,EAAM8B,eAAgC9B,EAAM8B,eAAiBrC,EAC/EuC,EAAuDD,SAA/B/B,EAAMgC,qBAAsChC,EAAMgC,qBAAuBtC,EACjGuC,EAAW,EAAID,EAAuBF,EACtCI,EAAQC,OAAOC,iBAAiBlC,GAAIgC,MAEpCG,EAAUtC,EAAMuC,MAChBC,EAAQF,EAAQE,QAChBf,MAAQe,EAAMZ,OAAST,EAAa,OACpCQ,IAAMG,EAAK,OACXN,KAAOK,EAAK,OACZ,sBACJW,EAAM,8BACNA,EAAM,2BACNA,EAAM,yBAA2BN,EAAW,MACxCO,gBAAkBN,IAClBO,QAAUX,IACV7B,WAAY,KACZyC,GAAQ,QAARA,QACEzC,WAAY,IACV0C,UAAUC,OAAOjD,EAAQkD,kBACzBC,oBAAoBvD,EAAqBmD,GAAO,GACpD1C,EAAM+C,OACFA,IAAIC,MAGNC,iBAAiB1D,EAAqBmD,GAAO,GACjD1C,EAAMkD,SACFA,MAAMpD,KAEN6C,UAAUQ,IAAIxD,EAAQkD,kBAG1BO,EAAa,eACXrD,GAAQsD,EAAMtD,MACdC,EAAQqD,EAAMrD,SACfqD,EAAMC,OAGLnD,OAASkD,EAAMC,MACfhB,MAAQe,EAAMC,IAAIC,kBAAkB5D,EAAQ2C,UAE5CkB,GAAM,kBAAK3D,GAAWC,EAAGC,EAAOC,IAChCyD,EAAYJ,EAAMC,IAAII,gBAClBT,iBAAiBU,gBAAeH,GAAK,KAC/B,aACJV,oBAAoBa,gBAAeH,GAAK,MAIhDI,EAAO,eACL5D,GAAQqD,EAAMrD,SAChBA,EAAM6D,eACD,SAEHC,GAAU9D,EAAM8D,SAAW,MAC3BC,EAAQC,KAEZC,4BAA0BjE,WAGtBL,EAAQuE,UACPlE,EAAMmE,eAAgB,EAAQxE,EAAQwE,YAAc,KACrDnE,EAAMoE,OACNC,KAAK,OAGLC,EAAUC,EAAE,aACT5E,EAAQ6E,MACdD,EAAE,aACI5E,EAAQ2C,eAEViC,GAAET,EAASC,GAAQ/D,EAAMyE,OAAQH,EAAStE,EAAM0E,SAG5CvE,SACJd,SACC,cACAU,kBACO,SACHgC,aACDA,kBAGDqB,WACAxD"}