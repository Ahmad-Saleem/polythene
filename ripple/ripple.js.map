{"version":3,"sources":["ripple.es6"],"names":["transitionEvent","DEFAULT_START_OPACITY","OPACITY_DECAY_VELOCITY","CSS_CLASSES","ripple","waves","mask","constrained","animated","makeRipple","ctrl","el","offsetWidth","offsetHeight","Math","sqrt","w","h","getBoundingClientRect","isTouch","e","touches","pageX","clientX","pageY","clientY","opts","center","rect","left","width","x","top","height","y","mx","waveRadius","my","initialOpacity","opacityDecayVelocity","window","getComputedStyle","color","onEnd","wavesEl","classList","remove","removeEventListener","end","evt","style","ry","rx","backgroundColor","opacity","addEventListener","start","add","createView","disabled","tag","class","join","id","config","initRipple","inited","parentElement","inactive","onClick","parent","endType","context","onunload","initWaves","props","content","component","controller","prop","delegate","view"],"mappings":"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","file":"ripple.js","sourcesContent":["import m from 'mithril';\nimport p from 'polythene/polythene/polythene';\nimport whichTransitionEvent from 'polythene/common/transition-event';\nimport 'polythene/ripple/theme/theme';\n\nconst transitionEvent = whichTransitionEvent();\nconst DEFAULT_START_OPACITY = 0.2;\nconst OPACITY_DECAY_VELOCITY = 0.35;\n\nconst CSS_CLASSES = {\n    ripple: 'pe-ripple',\n    waves: 'pe-ripple__waves',\n    mask: 'pe-ripple__mask',\n    constrained: 'pe-ripple--constrained',\n    animated: 'pe-ripple__waves--animated'\n};\n\nconst makeRipple = (e, ctrl, opts = {}) => {\n    const el = ctrl.ripple();\n    const wavesEl = ctrl.waves();\n    const w = el.offsetWidth;\n    const h = el.offsetHeight;\n    const waveRadius = Math.sqrt(w * w + h * h);\n    const rect = el.getBoundingClientRect();\n    const x = (p.isTouch && e.touches) ? e.touches[0].pageX : e.clientX;\n    const y = (p.isTouch && e.touches) ? e.touches[0].pageY : e.clientY;\n    const mx = (opts.center) ? (rect.left + rect.width / 2) : x;\n    const my = (opts.center) ? (rect.top + rect.height / 2) : y;\n    const rx = mx - rect.left - waveRadius / 2;\n    const ry = my - rect.top - waveRadius / 2;\n    const initialOpacity = (opts.initialOpacity !== undefined) ? opts.initialOpacity : DEFAULT_START_OPACITY;\n    const opacityDecayVelocity = (opts.opacityDecayVelocity !== undefined) ? opts.opacityDecayVelocity : OPACITY_DECAY_VELOCITY;\n    const duration = 1 / opacityDecayVelocity * initialOpacity;\n    const color = window.getComputedStyle(el).color;\n    const onEnd = function(evt) {\n        wavesEl.classList.remove(CSS_CLASSES.animated);\n        wavesEl.removeEventListener(transitionEvent, onEnd, false);\n        if (opts.end) {\n            opts.end(evt);\n        }\n    };\n\n    wavesEl.classList.remove(CSS_CLASSES.animated);\n    const style = wavesEl.style;\n    style.width = style.height = waveRadius + 'px';\n    style.top = ry + 'px';\n    style.left = rx + 'px';\n    style['animation-duration'] =\n        style['-webkit-animation-duration'] =\n        style['-moz-animation-duration'] =\n        style['-o-animation-duration'] = duration + 's';\n    style.backgroundColor = color;\n    style.opacity = initialOpacity;\n    wavesEl.addEventListener(transitionEvent, onEnd, false);\n\n    if (opts.start) {\n        opts.start(e);\n    }\n    wavesEl.classList.add(CSS_CLASSES.animated);\n};\n\nconst createView = (ctrl, opts = {}) => {\n    if (opts.disabled) {\n        return m('');\n    }\n    const initRipple = (el, inited, context) => {\n        if (inited) {\n            return;\n        }\n        ctrl.ripple(el);\n        const parent = el.parentElement;\n        if (!opts.inactive) {\n            const onClick = (e) => {\n                makeRipple(e, ctrl, opts);\n            };\n            const endType = p.isTouch ? 'click' : 'mouseup';\n            parent.addEventListener(endType, onClick, false);\n            context.onunload = () => {\n                parent.removeEventListener(endType, onClick, false);\n            };\n        }\n    };\n    const initWaves = (waves, inited) => {\n        if (inited) {\n            return;\n        }\n        ctrl.waves(waves);\n\n    };\n    const tag = opts.tag || 'div';\n    const props = {\n        class: [\n            CSS_CLASSES.ripple,\n            (opts.constrained !== false ? CSS_CLASSES.constrained : null),\n            opts.class\n        ].join(' '),\n        id: opts.id || '',\n        config: initRipple\n    };\n    const content = m('div', {\n        class: CSS_CLASSES.mask\n    }, m('div',\n        {\n            class: CSS_CLASSES.waves,\n            config: initWaves\n        })\n    );\n    return m(tag, props, content);\n};\n\nconst component = {\n    controller: () => {\n        return {\n            ripple: m.prop(),\n            waves: m.prop(),\n            delegate: m.prop()\n        };\n    },\n    view: (ctrl, opts = {}) => {\n        return createView(ctrl, opts);\n    }\n};\n\nexport default component;\n"]}