!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril"),require("polythene-core"),require("polythene-css"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","mithril","polythene-core","polythene-css","polythene-theme"],t):t(e.polythene=e.polythene||{},e.m,e["polythene-core"],e["polythene-css"],e["polythene-theme"])}(this,function(e,t,n,i,r){"use strict";t="default"in t?t.default:t;var o={color:"inherit"},a=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(e){return[a({},e,[i.mixin.fit(),{color:"inherit",borderRadius:"inherit",pointerEvents:"none",".pe-ripple--constrained":{borderRadius:"inherit"," .pe-ripple__mask":{overflow:"hidden",borderRadius:"inherit"}}," .pe-ripple__mask":[i.mixin.fit(),{transform:"translate3d(0,0,0)"}]," .pe-ripple__waves":{outline:"1px solid transparent",position:"absolute",borderRadius:"50%",pointerEvents:"none",display:"none"}," .pe-ripple__waves--animating":{display:"block"}}])]},p=function(e,t,n,i){return[a({},e+t,{color:n["color_"+i]||n.color||"inherit"})]},c=function(e,t){return[p("",e,t,"light"),p(".pe-dark-theme ",e,t,"dark")]},d=[l,c],u=".pe-ripple",m=function(e,t){return i.styler.generateStyles([e,u],s({},o,t),d)};i.styler.generateStyles([u],o,d);var f=n.animationEndEvent(),v=.2,h=0,y=.1,g=2,_=.35,w=function(e,t,o,s,l,p){var c=t.getBoundingClientRect(),d=n.isTouch&&e.touches?e.touches[0].pageX:e.clientX,u=n.isTouch&&e.touches?e.touches[0].pageY:e.clientY,m=t.offsetWidth,w=t.offsetHeight,b=Math.sqrt(m*m+w*w),E=s.center?c.left+c.width/2:d,k=s.center?c.top+c.height/2:u,x=E-c.left-b/2,O=k-c.top-b/2,S=void 0!==s.startOpacity?s.startOpacity:v,T=void 0!==s.opacityDecayVelocity?s.opacityDecayVelocity:_,j=s.endOpacity||h,q=s.startScale||y,L=s.endScale||g,R=s.duration?s.duration:1/T*.2,A=window.getComputedStyle(t).color,C="ripple_animation_"+(new Date).getTime(),D=o.style;D.width=D.height=b+"px",D.top=O+"px",D.left=x+"px",D["animation-duration"]=D["-webkit-animation-duration"]=D["-moz-animation-duration"]=D["-o-animation-duration"]=R+"s",D.backgroundColor=A,D.opacity=S,D.animationName=C,D.animationTimingFunction=s.animationTimingFunction||r.vars.animation_curve_default;var P=[a({},"@keyframes "+C,{" 0%":{transform:"scale("+q+")",opacity:S}," 100%":{transform:"scale("+L+")",opacity:j}})];i.styler.add(C,P);var F=function e(t){s.persistent?(D.opacity=j,D.transform="scale("+L+")"):(p(),o.classList.remove(l.wavesAnimating)),o.removeEventListener(f,e,!1),i.styler.remove(C),s.end&&s.end(t)};o.addEventListener(f,F,!1),s.start&&s.start(e),o.classList.add(l.wavesAnimating)},b={component:"pe-ripple",waves:"pe-ripple__waves",mask:"pe-ripple__mask",constrained:"pe-ripple--constrained",wavesAnimating:"pe-ripple__waves--animating"},E=void 0,k=function(e){var t=e.state,i=e.attrs;if(e.dom){var r=e.dom,o=e.dom.querySelector("."+b.waves),a=function(e){t.animating||(w(e,r,o,i,b,function(){return t.animating=!1}),t.animating=!0)},s=i.getTarget?i.getTarget():e.dom.parentElement;s.addEventListener(n.touchEndEvent,a,!1),E=function(){s.removeEventListener(n.touchEndEvent,a,!1)}}},x=function(e){var i=e.attrs;if(i.disabled)return null;var r=i.element||"div",o=s({},n.filterSupportedAttributes(i),{class:[b.component,i.constrained!==!1?b.constrained:null,i.class].join(" ")}),a=t("div",{class:b.mask},t("div",{class:b.waves}));return t(r,o,[i.before,a,i.after])},O={theme:m,oninit:function(e){return e.state.animating=!1},oncreate:k,onremove:E,view:x};e.ripple=O,e.classes=b,e.vars=o,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-ripple.js.map
