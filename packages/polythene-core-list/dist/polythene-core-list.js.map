{"version":3,"file":"polythene-core-list.js","sources":["../../polythene-css-classes/list-tile.js","../../polythene-css-classes/list.js","../src/list.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:       \"pe-list-tile\",\n\n  // elements\n  content:         \"pe-list-tile__content\",\n  highSubtitle:    \"pe-list-tile__high-subtitle\",\n  primary:         \"pe-list-tile__primary\",\n  secondary:       \"pe-list-tile__secondary\",\n  subtitle:        \"pe-list-tile__subtitle\",\n  title:           \"pe-list-tile__title\",\n  contentFront:    \"pe-list-tile__content-front\",\n\n  // states\n  compact:         \"pe-list-tile--compact\",\n  compactFront:    \"pe-list-tile--compact-front\",\n  disabled:        \"pe-list-tile--disabled\",\n  hasFront:        \"pe-list-tile--front\",\n  hasHighSubtitle: \"pe-list-tile--high-subtitle\",\n  hasSubtitle:     \"pe-list-tile--subtitle\",\n  header:          \"pe-list-tile--header\",\n  hoverable:       \"pe-list-tile--hoverable\",\n  selectable:      \"pe-list-tile--selectable\",\n  selected:        \"pe-list-tile--selected\",\n  highlight:       \"pe-list-tile--highlight\",\n  sticky:          \"pe-list-tile--sticky\",\n};\n","import listTileClasses from \"./list-tile\";\n\nexport default {\n  component:       \"pe-list\",\n\n  // states\n  borders:         \"pe-list--borders\",\n  compact:         \"pe-list--compact\",\n  hasHeader:       \"pe-list--header\",\n  indentedBorders: \"pe-list--indented-borders\",\n  padding:         \"pe-list--padding\",\n\n  // lookup\n  header:          listTileClasses.header\n};\n","import { filterSupportedAttributes } from \"polythene-core\";\nimport classes from \"polythene-css-classes/list\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\n/* MARK */\nconst onSelect = (event, vnode, index) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.onSelect) {\n    const selectedIndex = index !== undefined\n      ? index\n      : state.highlightIndex();\n    if (selectedIndex > -1) {\n      const data = {\n        event,\n        index: selectedIndex,\n        dom: state.tiles[selectedIndex].dom,\n        attrs: state.tiles[selectedIndex].attrs\n      };\n      attrs.onSelect(data);\n    }\n  }\n  if (index !== undefined) {\n    setHighlightIndex({ state, index });\n  }\n};\n\n/* MARK */\nconst setHighlightIndex = ({ state, index }) => {\n  const normalizedHighlightIndex = index === undefined || index === null\n    ? -1\n    : index;\n  const currentHighlightIndex = state.highlightIndex();\n  if (normalizedHighlightIndex !== currentHighlightIndex) {\n    // Explicitly reset to -1, or else only change when currently -1\n    if (normalizedHighlightIndex === -1) {\n      state.highlightIndex(-1);\n    } else if (currentHighlightIndex === -1) {\n      state.highlightIndex(normalizedHighlightIndex);\n    }\n  }\n};\n\n/* MARK */\nconst exitHighlight = ({ state, attrs, newIndex }) => {\n  const highlightIndex = state.highlightIndex();\n  state.tiles[highlightIndex].dom.blur();\n  state.highlightIndex(-1);\n  if (attrs.onHighlightExit) {\n    attrs.onHighlightExit({\n      index: newIndex,\n      dom: state.tiles[highlightIndex].dom,\n    });\n  }\n};\n\n/* MARK */\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const highlightIndex = createStream(attrs.defaultHighlightIndex !== undefined && attrs.defaultHighlightIndex !== null\n    ? attrs.defaultHighlightIndex\n    : -1);\n  const registerTile = state => (index, data) => state.tiles[index] = data;\n  return {\n    tiles: [],\n    highlightIndex,\n    registerTile,\n    redrawOnUpdate: createStream.merge([highlightIndex])\n  };\n};\n\n/* MARK */\nexport const onMount = vnode => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.keyboardControl) {\n    state.highlightIndex.map(index => {\n      if (state.tiles[index]) {\n        state.tiles[index].dom.focus();\n      }\n    });\n  }\n};\n\n/* MARK */\nexport const onUpdate = ({ state, attrs }) => {\n  if (!isNaN(attrs.highlightIndex)) {\n    setHighlightIndex({ state, index: attrs.highlightIndex });\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.borders ? classes.borders : null,\n        attrs.indentedBorders ? classes.indentedBorders : null,\n        attrs.header ? classes.hasHeader : null,\n        attrs.compact ? classes.compact : null,\n        attrs.padding !== false ? classes.padding : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    /* MARK */\n    attrs.keyboardControl && {\n      [k.onkeydown]: e => {\n        const highlightIndex = state.highlightIndex();\n        if (e.key === \"ArrowDown\" || e.key === \"ArrowRight\") {\n          e.preventDefault(); // prevent scrolling the page\n          const newIndex = highlightIndex + 1;\n          if (newIndex >= state.tiles.length) {\n            exitHighlight({ state, attrs, newIndex });\n          } else {\n            // Setting the focus on the List Tile will invoke a callback using attr `setHighlightIndex`\n            state.tiles[newIndex].dom.focus();\n          }\n        } else if (e.key === \"ArrowUp\" || e.key === \"ArrowLeft\") {\n          e.preventDefault(); // prevent scrolling the page\n          const newIndex = highlightIndex - 1;\n          if (newIndex < 0) {\n            exitHighlight({ state, attrs, newIndex });\n          } else {\n            state.tiles[newIndex].dom.focus();\n          }\n        } else if (e.key === \"Enter\") {\n          onSelect(e, vnode);\n        } else if (e.key === \"Escape\") {\n          exitHighlight({ state, attrs, newIndex: highlightIndex });\n        }\n      },\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, requiresKeys, keys: k, ListTile }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  let headerOpts;\n  if (attrs.header) {\n    headerOpts = Object.assign(\n      {},\n      attrs.header\n    );\n    headerOpts[k.class] = [\n      classes.header,\n      headerOpts[k.class] || null\n    ].join(\" \");\n  }\n  const tiles = attrs.tiles\n    ? attrs.tiles\n    : attrs.content\n      ? attrs.content\n      : attrs.children || vnode.children;\n  let index = -1;\n  return [\n    headerOpts ? h(ListTile, Object.assign(\n      {},\n      requiresKeys ? { key: \"header\" } : null,\n      attrs.all,\n      headerOpts,\n      {\n        header: true\n      }\n    )) : null,\n    /* MARK */\n    attrs.keyboardControl\n      ? tiles.map(tileOpts => {\n        if (!tileOpts.header) {\n          index++;\n        }\n        const tileIndex = index;\n        return tileOpts.tag !== undefined\n          ? tileOpts\n          : h(ListTile, Object.assign(\n            {},\n            attrs.all,\n            tileOpts,\n            !tileOpts.header && {\n              keyboardControl: true,\n              register: state.registerTile(state),\n              setHighlightIndex: state.highlightIndex,\n              index,\n              defaultHighlight: state.highlightIndex() === tileIndex,\n              events: Object.assign(\n                {},\n                tileOpts.events,\n                {\n                  [k.onclick]: e => onSelect(e, vnode, tileIndex)\n                }\n              )\n            }\n          ));\n      })\n      : attrs.all\n        ? tiles.map(tileOpts =>\n          h(ListTile, Object.assign(\n            {},\n            attrs.all,\n            tileOpts\n          ))\n        )\n        : tiles\n  ];\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  padding:                vars.grid_unit_component, // vertical padding\n  padding_compact:        vars.grid_unit_component * 3/4,\n  border_width_stacked:   1,\n  border_width_bordered:  1,\n\n  color_light_border:     rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_dark_border:      rgba(vars.color_dark_foreground,  vars.blend_dark_border_light),\n\n  // background color may be set in theme; disabled by default\n  // color_light_background: \"inherit\",\n  // color_dark_background:  \"inherit\"\n};\n"],"names":["header","getElement","vnode","attrs","element","onSelect","event","index","state","selectedIndex","undefined","highlightIndex","data","tiles","dom","setHighlightIndex","normalizedHighlightIndex","currentHighlightIndex","exitHighlight","newIndex","blur","onHighlightExit","getInitialState","createStream","defaultHighlightIndex","merge","onMount","keyboardControl","map","focus","onUpdate","isNaN","createProps","k","keys","_extends","filterSupportedAttributes","classes","component","borders","indentedBorders","hasHeader","compact","padding","tone","className","class","join","onkeydown","e","key","preventDefault","length","createContent","h","renderer","requiresKeys","ListTile","headerOpts","content","children","all","tileOpts","tileIndex","tag","registerTile","events","onclick","rgba","colorStr","vars","grid_unit_component","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light"],"mappings":"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"}