!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core"),require("polythene-core-css"),require("polythene-core-list-tile"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-core-css","polythene-core-list-tile","polythene-theme"],t):t(e.polythene=e.polythene||{},e["polythene-core"],e["polythene-core-css"],e["polythene-core-list-tile"],e["polythene-theme"])}(this,function(e,t,n,r,i){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={component:"pe-menu",content:"pe-menu__content",placeholder:"pe-menu__placeholder",target:"pe-menu__target",permanent:"pe-menu--permanent",visible:"pe-menu--visible",width_auto:"pe-menu--width-auto",width_n:"pe-menu--width-",listTile:r.CoreListTile.classes.component,selectedListTile:r.CoreListTile.classes.selected},c=i.vars.rgba,s={sizes:[1,1.5,2,3,4,5,6,7],min_size:1.5,max_size_small_screen:5,size_factor:i.vars.grid_unit_menu,border_radius:i.vars.unit_block_border_radius,color_light_background:c(i.vars.color_light_background),color_dark_background:c(i.vars.color_dark_background)},d=function(e,t){return t<e.min_size?e.min_size:t},p=function(e){return"pe-menu--width-"+e.toString().replace(".","-")},f=function(e,t){var n=d(e,t);return o({},"&."+p(n),{width:e.size_factor*n+"px","max-width":"100%"})},m=function(e,t){var r;return[(r={},o(r,e,[t.sizes.map(function(e){return f(t,e)}),o({transitionTimingFunction:"ease-out",transitionProperty:"opacity",zIndex:i.vars.z_menu,opacity:0,position:"absolute",width:"100%",minWidth:i.vars.grid_unit_menu*t.min_size+"px","&.pe-menu--width-auto":{width:"auto"},"&.pe-menu--visible":{opacity:1},"&.pe-menu--permanent":{position:"relative",opacity:1,zIndex:0}},"@media (max-width: "+i.vars.unit_screen_size_large+"px)",{"max-width":t.max_size_small_screen*i.vars.grid_unit_menu+"px"})]),o(r," .pe-menu__content",{" .pe-list-tile__title":[n.mixin.ellipsis("none")]}),r)]},h=function(e,t,n,r){return[u({},e.map(function(e){return e+t}).join(","),{" .pe-menu__content":{"background-color":n["color_"+r+"_background"]}})]},g=function(e,t){return[h([".pe-dark-tone",".pe-dark-tone "],e,t,"dark"),h(["",".pe-light-tone",".pe-light-tone "],e,t,"light")]},b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=[m,g],_="."+a.component,y=function(e,t){return n.styler.generateStyles([e,_],b({},s,t),v)};n.styler.generateStyles([_],s,v);var w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},k=function(e,t){if(!t.target)throw"Menu: no target";var n=document.querySelector(t.target);if(n){var r=void 0!==t.offset?t.offset:16,i=e.dom;if(i){var o=e.dom.querySelector("."+a.content),u=t.origin||"top-left",l=0;if(!1!==t.reposition){var c=o.querySelectorAll("."+a.listTile)[0],s=o.querySelector("."+a.selectedListTile);if(c&&s){var d=c.getBoundingClientRect(),p=s.getBoundingClientRect();l=p.top-d.top}var f=(s||c).getBoundingClientRect(),m=n.getBoundingClientRect(),h=f.height-m.height;l+=h/2}var g=n.getBoundingClientRect();if(i.parentNode){var b=i.parentNode.getBoundingClientRect(),v=function(){return i.style.left=g.left-b.left+r+"px"},_=function(){return i.style.right=g.right-b.right+r+"px"},y=function(){return i.style.top=g.top-b.top-l-8+"px"},w=function(){return i.style.bottom=g.bottom-b.bottom-l+"px"};({"top-left":function(){return y()&&v()},"top-right":function(){return y()&&_()},"bottom-left":function(){return w()&&v()},"bottom-right":function(){return w()&&_()}})[u].call()}}}},z=function(e,n){return t.show(w({},n,{el:e.dom,showClass:a.visible})).then(function(){n.updates.setVisible(!0),n.didShow&&n.didShow(n.id)})},x=function(e,n){return t.hide(w({},n,{el:e.dom,showClass:a.visible})).then(function(){n.updates.setVisible(!1),n.didHide&&n.didHide(n.id)})},S=function(e){return e<1.5?1.5:e},C=function(e){return a.width_n+e.toString().replace(".","-")},j=function(e,n){var r=e.state,i=e.attrs,o=function(){k(r,i)},u=function(e){e.target!==r.dom&&(c(),e.defaultPrevented?x(r,i):x(r,w({},i,{hideDelay:0})))},l=document.body,a=function(){l.addEventListener("click",u)},c=function(){l.removeEventListener("click",u)},s=function(e){27===e.which&&x(r,w({},i,{hideDelay:0}))};"mount"===n?(t.subscribe("resize",o),t.subscribe("keydown",s),setTimeout(function(){a(),z(r,i)},0)):"unmount"===n&&(t.unsubscribe("resize",o),t.unsubscribe("keydown",s),c())},O={theme:y,element:"div",classes:a,vars:s,createProps:function(e,n){var r=n.keys,i=e.attrs;return w({},t.filterSupportedAttributes(i),{className:[a.component,i.permanent?a.permanent:null,i.target?a.target:null,i.size?C(S(i.size)):null,"dark"===i.tone?"pe-dark-tone":null,"light"===i.tone?"pe-light-tone":null,i.className||i[r.class]].join(" ")})},createContent:function(e,t){var n,r=t.renderer,i=t.keys,o=t.Shadow,u=e.attrs,c=void 0!==u.z?u.z:1;return r("div",(n={className:a.content},l(n,i.onclick,function(e){return e.preventDefault()}),l(n,"style",u.style),n),[c>0&&r(o,{z:c,animated:!0}),u.content?u.content:e.children])},getInitialState:function(e){return{dom:void 0,visible:e.permanent||!1}},getUpdates:function(e){return{setVisible:function(t){return e(function(e){return e.visible=t,e})},setDom:function(t){return e(function(e){return e.dom=t,e})}}},onMount:function(e){if(e.dom){var t=e.state,n=e.attrs;t.dom=e.dom,n.permanent||j(e,"mount"),k(t,n)}},onUnMount:function(e){e.attrs.permanent||j(e,"unmount")}};e.CoreMenu=O,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-menu.js.map
