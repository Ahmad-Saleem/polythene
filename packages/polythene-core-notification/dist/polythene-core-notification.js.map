{"version":3,"file":"polythene-core-notification.js","sources":["../../polythene-css-classes/notification.js","../src/notification-instance.js","../src/vars.js","../src/transitions.js"],"sourcesContent":["\nexport default {\n  component:      \"pe-notification\",\n\n  // elements\n  action:         \"pe-notification__action\",\n  content:        \"pe-notification__content\",\n  holder:         \"pe-notification__holder\",\n  placeholder:    \"pe-notification__placeholder\",\n  title:          \"pe-notification__title\",\n\n  // states\n  hasContainer:   \"pe-notification--container\",\n  horizontal:     \"pe-notification--horizontal\",\n  multilineTitle: \"pe-notification__title--multiline\",\n  vertical:       \"pe-notification--vertical\",\n};","import { filterSupportedAttributes, show, hide, isClient, isServer } from \"polythene-core\";\nimport { Timer } from \"polythene-utilities\";\nimport classes from \"polythene-css-classes/notification\";\n\nconst DEFAULT_TIME_OUT = 3;\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst pauseInstance = state => {\n  state.paused(true);\n  if (state.timer) {\n    state.timer.pause();\n  }\n};\n\nconst unpauseInstance = state => {\n  state.paused(false);\n  if (state.timer) {\n    state.timer.resume();\n  }\n};\n\nconst stopTimer = state => {\n  if (state.timer) {\n    state.timer.stop();\n  }\n};\n\nconst prepareShow = (state, attrs) => {\n  if (!state.containerEl && isClient) {\n    // attrs.holderSelector is passed as option to Multiple\n    state.containerEl = document.querySelector(attrs.containerSelector || attrs.holderSelector);\n  }\n  if (!state.containerEl && isClient) {\n    console.error(\"No container element found\"); // eslint-disable-line no-console\n  }\n  if (attrs.containerSelector && state.containerEl) {\n    state.containerEl.classList.add(classes.hasContainer);\n  }\n};\n\nconst showInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  prepareShow(state, attrs);\n  const id = attrs.instanceId;\n  const transitions = attrs.transitions;\n  return show(Object.assign({},\n    attrs,\n    transitions.show(Object.assign(\n      {},\n      attrs,\n      {\n        containerEl: state.containerEl,\n        el: state.el,\n      }\n    ))\n  )).then(() => {\n    if (attrs.multipleDidShow) {\n      attrs.multipleDidShow(id); // this will call attrs.didShow\n    }\n    // set timer to hide in a few seconds\n    const timeout = attrs.timeout;\n    if (timeout === 0) {\n      // do not time out\n    } else {\n      const timeoutSeconds = timeout !== undefined\n        ? timeout\n        : DEFAULT_TIME_OUT;\n      state.timer.start(() => {\n        hideInstance(state, attrs);\n      }, timeoutSeconds);\n    }\n    state.visible(true);\n    state.transitioning(false);\n  });\n};\n\nconst hideInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  const id = attrs.instanceId;\n  const transitions = attrs.transitions;\n  return hide(Object.assign({},\n    attrs,\n    transitions.hide(Object.assign(\n      {},\n      attrs,\n      {\n        containerEl: state.containerEl,\n        el: state.el,\n      }\n    ))\n  )).then(() => {\n    if (attrs.multipleDidHide) {\n      attrs.multipleDidHide(id); // this will call attrs.didHide\n    }\n    state.visible(false);\n    state.transitioning(false);\n  });\n};\n\nconst setTitleStyles = titleEl => {\n  if (isServer) return;\n  const height = titleEl.getBoundingClientRect().height;\n  const lineHeight = parseInt(window.getComputedStyle(titleEl).lineHeight, 10);\n  const paddingTop = parseInt(window.getComputedStyle(titleEl).paddingTop, 10);\n  const paddingBottom = parseInt(window.getComputedStyle(titleEl).paddingBottom, 10);\n  if (height > (lineHeight + paddingTop + paddingBottom)) {\n    titleEl.classList.add(classes.multilineTitle);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  const paused = createStream(false);\n  const mounted = createStream(false);\n  const visible = createStream(false);\n  return {\n    cleanUp:        undefined,\n    containerEl:    undefined,\n    dismissEl:      undefined,\n    el:             undefined,\n    timer:          new Timer(),\n    paused,\n    transitioning,\n    visible,\n    mounted,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.el = dom;\n  const titleEl = state.el.querySelector(`.${classes.title}`);\n  if (titleEl) {\n    setTitleStyles(titleEl);\n  }\n  if (attrs.showInstance && !state.visible()) {\n    showInstance(state, attrs);\n  }\n  state.mounted(true);\n};\n\nexport const onUnMount = vnode => (\n  // vnode.attrs.multipleClear(),\n  vnode.state.mounted(false)\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.tone === \"light\" ? null : \"pe-dark-tone\", // default dark tone\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.containerSelector ? classes.hasContainer : null,\n        attrs.layout === \"vertical\" ? classes.vertical : classes.horizontal,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      [k.onclick]: e => e.preventDefault()\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (state.mounted() && !state.transitioning()) {\n    if (attrs.hideInstance && state.visible()) {\n      hideInstance(state, attrs);\n    } else if (attrs.showInstance && !state.visible()) {\n      showInstance(state, attrs);\n    }\n  }\n  if (attrs.pauseInstance && !state.paused()) {\n    pauseInstance(state, attrs);\n  } else if (attrs.unpauseInstance && state.paused()) {\n    unpauseInstance(state, attrs);\n  }\n\n  return h(\"div\",\n    {\n      className: classes.content,\n      style: attrs.style\n    },\n    attrs.content || [\n      attrs.title\n        ? h(\"div\",\n          { className: classes.title },\n          attrs.title\n        )\n        : null,\n      attrs.action\n        ? h(\"div\",\n          { className: classes.action },\n          attrs.action\n        )\n        : null\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nconst buttonPaddingH = 8; // padding, inner text space\n\nexport default {\n  width:                  274,\n  min_height:             80,\n  border_radius:          vars.unit_block_border_radius,\n  title_padding_h:        buttonPaddingH,\n  title_single_padding_v: 14,\n  title_multi_padding_v:  20,\n  side_padding:           24 - buttonPaddingH,\n  font_size:              14,\n  line_height:            20,\n\n  color_light_background: rgba(vars.color_light_background),\n  color_light_text:       rgba(vars.color_light_foreground, vars.blend_light_dark_primary),\n\n  color_dark_background:  rgba(vars.color_dark_background),\n  color_dark_text:        rgba(vars.color_dark_foreground, vars.blend_light_text_primary)\n};\n","const ANIMATION_DURATION = .5;\n\nconst show = ({ el, showDuration, showDelay }) => ({\n  el,\n  showDuration: showDuration || ANIMATION_DURATION,\n  showDelay:    showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = ({ el, hideDuration, hideDelay }) => ({\n  el,\n  hideDuration: hideDuration || ANIMATION_DURATION,\n  hideDelay:    hideDelay || 0,\n  hide:         () => el.style.opacity = 0,\n});\n\nexport default {\n  show,\n  hide\n};\n"],"names":["DEFAULT_TIME_OUT","getElement","vnode","attrs","element","pauseInstance","paused","state","timer","pause","unpauseInstance","resume","stopTimer","stop","prepareShow","containerEl","isClient","document","querySelector","containerSelector","holderSelector","error","classList","add","classes","hasContainer","showInstance","transitioning","Promise","resolve","id","instanceId","transitions","show","el","then","multipleDidShow","timeout","timeoutSeconds","undefined","start","visible","hideInstance","hide","multipleDidHide","setTitleStyles","isServer","height","titleEl","getBoundingClientRect","lineHeight","parseInt","window","getComputedStyle","paddingTop","paddingBottom","multilineTitle","getInitialState","createStream","mounted","Timer","merge","onMount","dom","title","onUnMount","createProps","k","keys","filterSupportedAttributes","component","tone","layout","vertical","horizontal","className","class","join","onclick","e","preventDefault","createContent","h","renderer","content","style","action","rgba","colorStr","opacity","buttonPaddingH","vars","unit_block_border_radius","color_light_background","color_light_foreground","blend_light_dark_primary","color_dark_background","color_dark_foreground","blend_light_text_primary","ANIMATION_DURATION","showDuration","showDelay","hideDuration","hideDelay"],"mappings":"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"}