{"version":3,"file":"polythene-core-base-spinner.js","sources":["../../polythene-css-classes/base-spinner.js","../src/spinner.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:   \"pe-spinner\",\n\n  // elements\n  animation:   \"pe-spinner__animation\",\n  placeholder: \"pe-spinner__placeholder\",\n\n  // states\n  animated:    \"pe-spinner--animated\",\n  fab:         \"pe-spinner--fab\",\n  large:       \"pe-spinner--large\",\n  medium:      \"pe-spinner--medium\",\n  permanent:   \"pe-spinner--permanent\",\n  raised:      \"pe-spinner--raised\",\n  regular:     \"pe-spinner--regular\",\n  singleColor: \"pe-spinner--single-color\",\n  small:       \"pe-spinner--small\",\n  visible:     \"pe-spinner--visible\",\n};\n","import { filterSupportedAttributes, show, hide } from \"polythene-core\";\nimport classes from \"polythene-css-classes/base-spinner\";\n\nconst sizeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large,\n  fab:     classes.fab\n};\n\nconst classForSize = (size = \"regular\") => sizeClasses[size];\n\nconst showSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: false, transitioning: true });\n  }\n  return show(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: true, transitioning: false });\n    }\n    if (attrs.didShow) {\n      attrs.didShow(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nconst hideSpinner = (state, attrs) => {\n  if (attrs.onChange) {\n    attrs.onChange({ visible: true, transitioning: true });\n  }\n  return hide(Object.assign({},\n    attrs, {\n      el: state.dom(),\n      showClass: classes.visible\n    }\n  )).then(() => {\n    if (attrs.onChange) {\n      attrs.onChange({ visible: false, transitioning: false });\n    }\n    if (attrs.didHide) {\n      attrs.didHide(attrs.id);\n    }\n    state.visible(false);\n  });\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const visible = createStream(false);\n  const dom = createStream(null);\n  return {\n    dom,\n    visible,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.dom(vnode.dom);\n\n  if (!attrs.permanent) {\n    showSpinner(state, attrs);\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass,\n        classForSize(attrs.size),\n        attrs.singleColor ? classes.singleColor: null,\n        attrs.raised ? classes.raised : null,\n        attrs.animated ? classes.animated : null,\n        attrs.permanent ? classes.permanent : null,\n        attrs.permanent ? classes.visible : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.events\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, Shadow }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  if (state.hide) {\n    setTimeout(() => { hideSpinner(state, attrs); }, 0);\n  }\n\n  return [\n    attrs.raised && attrs.content\n      ? h(Shadow, { key: \"shadow\", z: attrs.z })\n      : null,\n    attrs.content\n  ];\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n  \nexport default {\n  size_small:   3 * vars.grid_unit_component,\n  size_regular: 4 * vars.grid_unit_component,\n  size_medium:  5 * vars.grid_unit_component,\n  size_large:   6 * vars.grid_unit_component,\n  size_fab:     7 * vars.grid_unit_component,\n\n  raisedSize: size => {\n    const padding = size * 0.25;\n    const paddedSize = size + padding * 2;\n    return { padding, paddedSize };\n  },\n\n  color_light_raised_background: rgba(vars.color_light_background),\n  // also use light background with dark tone\n  color_dark_raised_background: rgba(vars.color_light_background)\n};\n"],"names":["sizeClasses","classes","small","regular","medium","large","fab","classForSize","size","showSpinner","state","attrs","onChange","visible","transitioning","show","dom","then","didShow","id","hideSpinner","hide","didHide","getInitialState","vnode","createStream","merge","onMount","permanent","createProps","k","keys","filterSupportedAttributes","component","instanceClass","singleColor","raised","animated","className","class","join","events","createContent","h","renderer","Shadow","content","key","z","rgba","colorStr","opacity","vars","grid_unit_component","padding","paddedSize","color_light_background"],"mappings":";;;;;;AACA,cAAe;aACA,YADA;;;aAIA,uBAJA;eAKA,yBALA;;;YAQA,sBARA;OASA,iBATA;SAUA,mBAVA;UAWA,oBAXA;aAYA,uBAZA;UAaA,oBAbA;WAcA,qBAdA;eAeA,0BAfA;SAgBA,mBAhBA;WAiBA;CAjBf;;;;ACDA,AAGA,IAAMA,cAAc;SACTC,QAAQC,KADC;WAETD,QAAQE,OAFC;UAGTF,QAAQG,MAHC;SAITH,QAAQI,KAJC;OAKTJ,QAAQK;CALnB;;AAQA,IAAMC,eAAe,SAAfA,YAAe;MAACC,IAAD,uEAAQ,SAAR;SAAsBR,YAAYQ,IAAZ,CAAtB;CAArB;;AAEA,IAAMC,cAAc,SAAdA,WAAc,CAACC,KAAD,EAAQC,KAAR,EAAkB;MAChCA,MAAMC,QAAV,EAAoB;UACZA,QAAN,CAAe,EAAEC,SAAS,KAAX,EAAkBC,eAAe,IAAjC,EAAf;;SAEKC,mBAAK,SAAc,EAAd,EACVJ,KADU,EACH;QACDD,MAAMM,GAAN,EADC;eAEMf,QAAQY;GAHX,CAAL,EAKJI,IALI,CAKC,YAAM;QACRN,MAAMC,QAAV,EAAoB;YACZA,QAAN,CAAe,EAAEC,SAAS,IAAX,EAAiBC,eAAe,KAAhC,EAAf;;QAEEH,MAAMO,OAAV,EAAmB;YACXA,OAAN,CAAcP,MAAMQ,EAApB;;UAEIN,OAAN,CAAc,KAAd;GAZK,CAAP;CAJF;;AAoBA,IAAMO,cAAc,SAAdA,WAAc,CAACV,KAAD,EAAQC,KAAR,EAAkB;MAChCA,MAAMC,QAAV,EAAoB;UACZA,QAAN,CAAe,EAAEC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAAf;;SAEKO,mBAAK,SAAc,EAAd,EACVV,KADU,EACH;QACDD,MAAMM,GAAN,EADC;eAEMf,QAAQY;GAHX,CAAL,EAKJI,IALI,CAKC,YAAM;QACRN,MAAMC,QAAV,EAAoB;YACZA,QAAN,CAAe,EAAEC,SAAS,KAAX,EAAkBC,eAAe,KAAjC,EAAf;;QAEEH,MAAMW,OAAV,EAAmB;YACXA,OAAN,CAAcX,MAAMQ,EAApB;;UAEIN,OAAN,CAAc,KAAd;GAZK,CAAP;CAJF;;AAoBA,AAAO,IAAMU,kBAAkB,SAAlBA,eAAkB,CAACC,KAAD,EAAQC,YAAR,EAAyB;MAChDZ,UAAUY,aAAa,KAAb,CAAhB;MACMT,MAAMS,aAAa,IAAb,CAAZ;SACO;YAAA;oBAAA;oBAGWA,aAAaC,KAAb,CAAmB,CAACb,OAAD,CAAnB;GAHlB;CAHK;;AAUP,AAAO,IAAMc,UAAU,SAAVA,OAAU,QAAS;MAC1B,CAACH,MAAMR,GAAX,EAAgB;;;MAGVN,QAAQc,MAAMd,KAApB;MACMC,QAAQa,MAAMb,KAApB;QACMK,GAAN,CAAUQ,MAAMR,GAAhB;;MAEI,CAACL,MAAMiB,SAAX,EAAsB;gBACRlB,KAAZ,EAAmBC,KAAnB;;CATG;;AAaP,AAAO,IAAMkB,cAAc,SAAdA,WAAc,CAACL,KAAD,QAAwB;MAARM,CAAQ,QAAdC,IAAc;;MAC3CpB,QAAQa,MAAMb,KAApB;SACO,SACL,EADK,EAELqB,wCAA0BrB,KAA1B,CAFK,EAGL;eACa,CACTV,QAAQgC,SADC,EAETtB,MAAMuB,aAFG,EAGT3B,aAAaI,MAAMH,IAAnB,CAHS,EAITG,MAAMwB,WAAN,GAAoBlC,QAAQkC,WAA5B,GAAyC,IAJhC,EAKTxB,MAAMyB,MAAN,GAAenC,QAAQmC,MAAvB,GAAgC,IALvB,EAMTzB,MAAM0B,QAAN,GAAiBpC,QAAQoC,QAAzB,GAAoC,IAN3B,EAOT1B,MAAMiB,SAAN,GAAkB3B,QAAQ2B,SAA1B,GAAsC,IAP7B,EAQTjB,MAAMiB,SAAN,GAAkB3B,QAAQY,OAA1B,GAAoC,IAR3B,EASTF,MAAM2B,SAAN,IAAmB3B,MAAMmB,EAAES,KAAR,CATV,EAUTC,IAVS,CAUJ,GAVI;GAJR,EAgBL7B,MAAM8B,MAhBD,CAAP;CAFK;;AAsBP,AAAO,IAAMC,gBAAgB,SAAhBA,aAAgB,CAAClB,KAAD,SAAoC;MAAhBmB,CAAgB,SAA1BC,QAA0B;MAAbC,MAAa,SAAbA,MAAa;;MACzDnC,QAAQc,MAAMd,KAApB;MACMC,QAAQa,MAAMb,KAApB;;MAEID,MAAMW,IAAV,EAAgB;eACH,YAAM;kBAAcX,KAAZ,EAAmBC,KAAnB;KAAnB,EAAiD,CAAjD;;;SAGK,CACLA,MAAMyB,MAAN,IAAgBzB,MAAMmC,OAAtB,GACIH,EAAEE,MAAF,EAAU,EAAEE,KAAK,QAAP,EAAiBC,GAAGrC,MAAMqC,CAA1B,EAAV,CADJ,GAEI,IAHC,EAILrC,MAAMmC,OAJD,CAAP;CARK;;;;;;;;;AChGP,IAAMG,OAAO,SAAPA,IAAO,CAACC,QAAD;MAAWC,OAAX,uEAAqB,CAArB;mBACHD,QADG,UACUC,OADV;CAAb;;AAGA,aAAe;cACC,IAAIC,oBAAKC,mBADV;gBAEC,IAAID,oBAAKC,mBAFV;eAGC,IAAID,oBAAKC,mBAHV;cAIC,IAAID,oBAAKC,mBAJV;YAKC,IAAID,oBAAKC,mBALV;;cAOD,0BAAQ;QACZC,UAAU9C,OAAO,IAAvB;QACM+C,aAAa/C,OAAO8C,UAAU,CAApC;WACO,EAAEA,gBAAF,EAAWC,sBAAX,EAAP;GAVW;;iCAakBN,KAAKG,oBAAKI,sBAAV,CAblB;;gCAeiBP,KAAKG,oBAAKI,sBAAV;CAfhC;;;;;;;;;;;;;"}