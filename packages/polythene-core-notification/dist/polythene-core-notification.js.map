{"version":3,"file":"polythene-core-notification.js","sources":["../src/classes.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js","../src/theme/layout-holder.js","../src/theme/index.js","../src/notification-instance.js","../src/theme/transitions.js"],"sourcesContent":["export default {\n  component:      \"pe-notification\",\n\n  // elements\n  action:         \"pe-notification__action\",\n  content:        \"pe-notification__content\",\n  holder:         \"pe-notification__holder\",\n  placeholder:    \"pe-notification__placeholder\",\n  title:          \"pe-notification__title\",\n\n  // states\n  hasContainer:   \"pe-notification--container\",\n  horizontal:     \"pe-notification--horizontal\",\n  multilineTitle: \"pe-notification__title--multiline\",\n  vertical:       \"pe-notification--vertical\",\n};","import { vars } from \"polythene-theme\";\nimport { rgba } from \"polythene-core-css\";\n\nconst buttonPaddingH = 8; // padding, inner text space\n\nexport default {\n  width:                  274,\n  min_height:             80,\n  border_radius:          vars.unit_block_border_radius,\n  title_padding_h:        buttonPaddingH,\n  title_single_padding_v: 14,\n  title_multi_padding_v:  20,\n  side_padding:           24 - buttonPaddingH,\n  font_size:              14,\n  line_height:            20,\n\n  color_light_background: rgba(vars.color_light_background),\n  color_light_text:       rgba(vars.color_light_foreground, vars.blend_light_dark_primary),\n\n  color_dark_background:  rgba(vars.color_dark_background),\n  color_dark_text:        rgba(vars.color_dark_foreground, vars.blend_light_text_primary)\n};\n","\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector, componentVars) => [{\n  [selector]: [\n    flex.layoutCenter,\n    {\n      width: componentVars.width + \"px\",\n      minHeight: componentVars.min_height + \"px\",\n      position: \"relative\",\n      padding: \"0 \" + componentVars.side_padding + \"px\",\n      margin: \"0 auto\",\n      borderRadius: componentVars.border_radius + \"px\",\n      pointerEvents: \"all\",\n\n      \" .pe-notification__content\": {\n        width: \"100%\"\n      },\n\n      \" .pe-notification__title\": {\n        padding: componentVars.title_single_padding_v + \"px \" + componentVars.title_padding_h + \"px\",\n        fontSize: componentVars.font_size + \"px\",\n        lineHeight: componentVars.line_height + \"px\"\n      },\n\n      \" .pe-notification__action\": {\n        \" .pe-button\": {\n          margin: 0\n        }\n      },\n\n      \"&.pe-notification--horizontal\": {\n        \" .pe-notification__content\": flex.layoutHorizontal,\n        \" .pe-notification__title\": flex.flex(),\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\",\n          paddingBottom: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutCenter\n      },\n      \"&.pe-notification--vertical\": {\n        \" .pe-notification__content\": flex.layoutVertical,\n        \" .pe-notification__title\": {\n          paddingBottom: \"4px\"\n        },\n        \" .pe-notification__title--multi-line\": {\n          paddingTop: componentVars.title_multi_padding_v + \"px\"\n        },\n        \" .pe-notification__action\": flex.layoutEndJustified\n      }\n    }\n  ]\n}];\n\n","\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n    color: componentVars[\"color_\" + tint + \"_text\"],\n    background: componentVars[\"color_\" + tint + \"_background\"]\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n","import { vars } from \"polythene-theme\";\nimport { flex } from \"polythene-core-css\";\n\nexport default (selector) => [{\n  [selector]: [\n    flex.layoutCenterCenter,\n    {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      zIndex: vars.z_notification,\n      pointerEvents: \"none\",\n\n      \".pe-multiple--screen\": {\n        position: \"fixed\",\n      }\n    }\n  ],\n  \":not(.pe-notification--container) .pe-multiple--container\": {\n    position: \"absolute\",\n  }\n}];\n","import { styler } from \"polythene-core-css\";\nimport classes from \"../classes\";\nimport vars from \"./vars\";\nimport layout from \"./layout\";\nimport color from \"./color\";\nimport holderLayout from \"./layout-holder\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nconst holderFns = [holderLayout];\nconst holderSelector = `.${classes.holder}`;\n\nexport const customTheme = (customSelector, customVars) => (\n  styler.generateStyles([customSelector, selector], {...vars, ...customVars}, fns)\n);\n\nstyler.generateStyles([selector], vars, fns);\nstyler.generateStyles([holderSelector], vars, holderFns);\n","import { filterSupportedAttributes, show, hide, isClient, isServer } from \"polythene-core\";\nimport { Timer } from \"polythene-utilities\";\nimport { customTheme } from \"./theme\";\nimport classes from \"./classes\";\n\nconst DEFAULT_TIME_OUT = 3;\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nexport const theme = customTheme;\n\nconst pauseInstance = state => {\n  state.paused(true);\n  if (state.timer) {\n    state.timer.pause();\n  }\n};\n\nconst unpauseInstance = state => {\n  state.paused(false);\n  if (state.timer) {\n    state.timer.resume();\n  }\n};\n\nconst stopTimer = state => {\n  if (state.timer) {\n    state.timer.stop();\n  }\n};\n\nconst prepareShow = (state, attrs) => {\n  if (!state.containerEl && isClient) {\n    // attrs.holderSelector is passed as option to Multiple\n    state.containerEl = document.querySelector(attrs.containerSelector || attrs.holderSelector);\n  }\n  if (!state.containerEl && isClient) {\n    console.error(\"No container element found\"); // eslint-disable-line no-console\n  }\n  if (attrs.containerSelector && state.containerEl) {\n    state.containerEl.classList.add(classes.hasContainer);\n  }\n};\n\nconst showInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  prepareShow(state, attrs);\n  const id = attrs.instanceId;\n  const transitions = attrs.transitions;\n  return show(Object.assign({},\n    attrs,\n    transitions.show(Object.assign(\n      {},\n      attrs,\n      {\n        containerEl: state.containerEl,\n        el: state.el,\n      }\n    ))\n  )).then(() => {\n    if (attrs.multipleDidShow) {\n      attrs.multipleDidShow(id); // this will call attrs.didShow\n    }\n    // set timer to hide in a few seconds\n    const timeout = attrs.timeout;\n    if (timeout === 0) {\n      // do not time out\n    } else {\n      const timeoutSeconds = timeout !== undefined\n        ? timeout\n        : DEFAULT_TIME_OUT;\n      state.timer.start(() => {\n        hideInstance(state, attrs);\n      }, timeoutSeconds);\n    }\n    state.visible(true);\n    state.transitioning(false);\n  });\n};\n\nconst hideInstance = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  state.transitioning(true);\n  stopTimer(state);\n  const id = attrs.instanceId;\n  const transitions = attrs.transitions;\n  return hide(Object.assign({},\n    attrs,\n    transitions.hide(Object.assign(\n      {},\n      attrs,\n      {\n        containerEl: state.containerEl,\n        el: state.el,\n      }\n    ))\n  )).then(() => {\n    state.transitioning(false);\n    if (attrs.multipleDidHide) {\n      attrs.multipleDidHide(id); // this will call attrs.didHide\n    }\n    state.visible(false);\n  });\n};\n\nconst setTitleStyles = titleEl => {\n  if (isServer) return;\n  const height = titleEl.getBoundingClientRect().height;\n  const lineHeight = parseInt(window.getComputedStyle(titleEl).lineHeight, 10);\n  const paddingTop = parseInt(window.getComputedStyle(titleEl).paddingTop, 10);\n  const paddingBottom = parseInt(window.getComputedStyle(titleEl).paddingBottom, 10);\n  if (height > (lineHeight + paddingTop + paddingBottom)) {\n    titleEl.classList.add(classes.multilineTitle);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  const paused = createStream(false);\n  const mounted = createStream(false);\n  const visible = createStream(false);\n  return {\n    cleanUp:        undefined,\n    containerEl:    undefined,\n    dismissEl:      undefined,\n    el:             undefined,\n    timer:          new Timer(),\n    paused,\n    transitioning,\n    visible,\n    mounted,\n    redrawOnUpdate: createStream.merge([visible])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.el = dom;\n  const titleEl = state.el.querySelector(`.${classes.title}`);\n  if (titleEl) {\n    setTitleStyles(titleEl);\n  }\n  if (attrs.showInstance && !state.visible()) {\n    showInstance(state, attrs);\n  }\n  state.mounted(true);\n};\n\nexport const onUnMount = vnode =>\n  vnode.state.mounted(false);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.tone === \"light\" ? null : \"pe-dark-tone\", // default dark tone\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.containerSelector ? classes.hasContainer : null,\n        attrs.layout === \"vertical\" ? classes.vertical : classes.horizontal,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      [k.onclick]: e => e.preventDefault()\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (state.mounted() && !state.transitioning()) {\n    if (attrs.hideInstance && state.visible()) {\n      hideInstance(state, attrs);\n    } else if (attrs.showInstance && !state.visible()) {\n      showInstance(state, attrs);\n    }\n  }\n  if (attrs.pauseInstance && !state.paused()) {\n    pauseInstance(state, attrs);\n  } else if (attrs.unpauseInstance && state.paused()) {\n    unpauseInstance(state, attrs);\n  }\n\n  return h(\"div\",\n    {\n      className: classes.content,\n      style: attrs.style\n    },\n    attrs.content || [\n      attrs.title\n        ? h(\"div\",\n          { className: classes.title },\n          attrs.title\n        )\n        : null,\n      attrs.action\n        ? h(\"div\",\n          { className: classes.action },\n          attrs.action\n        )\n        : null\n    ]\n  );\n};\n","const ANIMATION_DURATION = .5;\n\nconst show = ({ el, showDuration, showDelay }) => ({\n  el,\n  showDuration: showDuration || ANIMATION_DURATION,\n  showDelay:    showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = ({ el, hideDuration, hideDelay }) => ({\n  el,\n  hideDuration: hideDuration || ANIMATION_DURATION,\n  hideDelay:    hideDelay || 0,\n  hide:         () => el.style.opacity = 0,\n});\n\nexport default {\n  show,\n  hide\n};\n"],"names":["vars","unit_block_border_radius","rgba","color_light_background","color_light_foreground","blend_light_dark_primary","color_dark_background","color_dark_foreground","blend_light_text_primary","selector","componentVars","flex","layoutCenter","width","min_height","side_padding","border_radius","title_single_padding_v","title_padding_h","font_size","line_height","layoutHorizontal","title_multi_padding_v","layoutVertical","layoutEndJustified","style","scopes","tint","map","s","join","layoutCenterCenter","z_notification","fns","layout","color","classes","component","holderFns","holderLayout","holderSelector","holder","customTheme","customSelector","customVars","styler","generateStyles","getElement","vnode","attrs","element","theme","pauseInstance","paused","state","timer","pause","unpauseInstance","resume","stopTimer","stop","prepareShow","containerEl","isClient","document","querySelector","containerSelector","error","classList","add","hasContainer","showInstance","transitioning","Promise","resolve","id","instanceId","transitions","show","_extends","el","then","multipleDidShow","timeout","timeoutSeconds","undefined","start","visible","hideInstance","hide","multipleDidHide","setTitleStyles","isServer","titleEl","getBoundingClientRect","height","parseInt","window","getComputedStyle","lineHeight","paddingTop","paddingBottom","multilineTitle","getInitialState","createStream","mounted","Timer","merge","onMount","dom","title","onUnMount","createProps","k","keys","filterSupportedAttributes","tone","vertical","horizontal","className","class","onclick","e","preventDefault","createContent","h","renderer","content","action","showDuration","showDelay","opacity","hideDuration","hideDelay"],"mappings":"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"}