{"version":3,"file":"polythene-core-selection-control.js","sources":["../src/classes.js","../src/selection-control.js","../src/theme/vars.js","../src/theme/layout.js","../src/theme/color.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import { filterSupportedAttributes } from \"polythene-core\";\n// Does not export theme\nimport classes from \"./classes\";\n\nexport const element = \"div\";\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n\n  const defaultChecked = attrs.checked !== undefined\n    ? !!attrs.checked\n    : !!attrs.defaultChecked || false;\n\n  const checked = createStream(defaultChecked);\n  const redrawOnChange = createStream(defaultChecked);\n\n  const toggle = () => {\n    const oldChecked = attrs.checked !== undefined\n      ? attrs.checked\n      : checked();\n    checked(!oldChecked);\n    redrawOnChange(!oldChecked);\n  };\n\n  const onChange = attrs.onChange !== undefined\n    ? e => (\n        toggle(),\n        attrs.onChange({\n          event: e,\n          checked: checked(),\n          value: attrs.value\n        })\n      )\n    : () => toggle();\n\n  return {\n    checked,\n    onChange,\n    redrawOnUpdate: createStream.merge([redrawOnChange])\n  };\n};\n\nconst sizeClasses = {\n  small:   classes.small,\n  regular: classes.regular,\n  medium:  classes.medium,\n  large:   classes.large\n};\n\nconst classForSize = (size = \"regular\") => sizeClasses[size];\n\nconst currentState = (attrs, state) => {\n  const checked = attrs.checked !== undefined\n    ? attrs.checked\n    : state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  return { checked, inactive };\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const { checked, inactive } = currentState(attrs, state);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass, // for instance pe-checkbox-control\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(attrs.size),\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    },\n    attrs.events\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, Icon, IconButton }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const { inactive } = currentState(attrs, state);\n  const controlView = attrs.createControl\n    ? attrs.createControl({ h, k, inactive, onChange: state.onChange, attrs, Icon, IconButton })\n    : null;\n\n  return h(\"label\",\n    {\n      className: classes.formLabel,\n      key: \"label\"\n    },\n    [\n      controlView,\n      attrs.label\n        ? h(`.${classes.label}`,\n            inactive\n              ? null\n              : { [k.onclick]: state.onChange },\n            attrs.label\n          )\n        : null\n    ]\n  );\n};\n\nconst createIcon = (h, iconType, attrs, className) => (\n  // if attrs.iconOn/attrs.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    attrs[iconType]\n      ? attrs[iconType]\n      : { svg: h.trust(attrs.icons[iconType]) },\n    { className },\n    attrs.icon,\n    attrs.size\n      ? { size: attrs.size }\n      : null\n  )\n);\n\nexport const createControl = ({ h, k, attrs, inactive, onChange, Icon, IconButton }) => (\n  h(\"div\",\n    { className: classes.box },\n    h(IconButton, Object.assign(\n      {},\n      {\n        element: \"div\",\n        className: classes.button,\n        content: [\n          { iconType: \"iconOn\", className: classes.buttonOn},\n          { iconType: \"iconOff\", className: classes.buttonOff}\n        ].map(o =>\n          h(Icon, createIcon(h, o.iconType, attrs, o.className))\n        ),\n        ripple: { center: true },\n        disabled: attrs.disabled,\n        events: { [k.onclick]: onChange },\n        inactive\n      },\n      attrs.iconButton // for example for hover behaviour\n    ))\n  )\n);\n","import { vars } from \"polythene-theme\";\n\nconst rgba = vars.rgba;\n\nexport default {\n  label_font_size:                     2 * vars.grid_unit_component, // 16\n  label_height:                        3 * vars.grid_unit_component, // 24\n  label_padding_before:                vars.grid_unit * 4, // 16\n  label_padding_after:                 0,\n  button_size:                         6 * vars.grid_unit_component,\n  icon_size:                           3 * vars.grid_unit_component,\n  animation_duration:                  vars.animation_duration,\n\n  color_light_on:                      vars.rgba(vars.color_primary),\n  color_light_off:                     rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_label:                   rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled:                rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_thumb_off_focus_opacity: .08,\n  color_light_thumb_on_focus_opacity:  .11,\n\n  // icon colors may be set in theme; disabled by default\n  // color_light_on_icon\n  // color_light_off_icon\n\n  color_light_focus_on:                rgba(vars.color_primary),\n  color_light_focus_on_opacity:        .11,\n  color_light_focus_off:                rgba(vars.color_light_foreground),\n  color_light_focus_off_opacity:       .07,\n\n  color_dark_on:                       vars.rgba(vars.color_primary),\n  color_dark_off:                      rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_label:                    rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_thumb_off_focus_opacity:  .08,\n  color_dark_thumb_on_focus_opacity:   .11,\n\n  // icon color may be set in theme; disabled by default\n  // color_dark_on_icon\n  // color_dark_off_icon\n  \n  color_dark_focus_on:                 rgba(vars.color_primary), // or '#80cbc4'\n  color_dark_focus_on_opacity:         .14,\n  color_dark_focus_off:                rgba(vars.color_dark_foreground),\n  color_dark_focus_off_opacity:        .09\n};\n","// Returns a style function to be used by checkbox and radio-button\n\nimport { mixin, flex } from \"polythene-core-css\";\nimport { vars } from \"polythene-theme\";\n\nconst makeSize = (componentVars, height, iconSize = vars.unit_icon_size) => {\n  const labelSize = iconSize + componentVars.label_height;\n  const iconOffset = (labelSize - iconSize) / 2;\n  return {\n    \" .pe-control__form-label\": {\n      height: height + \"px\"\n    },\n    \" .pe-control__box\": {\n      width: iconSize + \"px\",\n      height: iconSize + \"px\"\n    },\n    \" .pe-button__content\": {\n      width: labelSize + \"px\",\n      height: labelSize + \"px\",\n\n      \" .pe-icon\": [\n        mixin.fit(iconOffset)\n      ]\n    }\n  };\n};\n\nconst activeButton = () => ({\n  opacity: 1,\n  zIndex: 1\n});\n\nconst inactiveButton = () => ({\n  opacity: 0,\n  zIndex: 0\n});\n\nexport default (selector, componentVars) => [{\n  [selector]: {\n    display: \"inline-block\",\n    boxSizing: \"border-box\",\n    margin: 0,\n    padding: 0,\n\n    \" .pe-control__form-label\": [\n      flex.layoutHorizontal,\n      flex.layoutCenter,\n      {\n        position: \"relative\",\n        cursor: \"pointer\",\n        fontSize: componentVars.label_font_size + \"px\",\n        lineHeight: componentVars.label_height + \"px\",\n        margin: 0,\n        color: \"inherit\",\n\n        \":focus\": {\n          outline: 0\n        },\n      }\n    ],\n\n    \".pe-control--inactive\": {\n      \" .pe-control__form-label\": {\n        cursor: \"default\"\n      }\n    },\n\n    \" .pe-control__box\": {\n      position: \"relative\",\n      display: \"inline-block\",\n      boxSizing: \"border-box\",\n      width: componentVars.label_height + \"px\",\n      height: componentVars.label_height + \"px\",\n      color: \"inherit\",\n\n      \":focus\": {\n        outline: 0,\n      }\n    },\n\n    \" .pe-button.pe-control__button\": [\n      mixin.defaultTransition(\"opacity\", componentVars.animation_duration), {\n        position: \"absolute\",\n        left: -((componentVars.button_size - componentVars.icon_size) / 2) + \"px\",\n        top: -((componentVars.button_size - componentVars.icon_size) / 2) + \"px\",\n        zIndex: 1\n      }\n    ],\n\n    \".pe-control--off\": {\n      \" .pe-control__button--on\": inactiveButton(),\n      \" .pe-control__button--off\": activeButton()\n    },\n\n    \".pe-control--on\": {\n      \" .pe-control__button--on\": activeButton(),\n      \" .pe-control__button--off\": inactiveButton()\n    },\n\n    \" .pe-control__label\": {\n      paddingLeft: componentVars.label_padding_before + \"px\",\n      paddingRight: componentVars.label_padding_after + \"px\"\n    },\n\n    \".pe-control--disabled\": {\n      \" .pe-control__form-label\": {\n        cursor: \"auto\"\n      },\n      \" .pe-control__button\": {\n        pointerEvents: \"none\"\n      }\n    },\n\n    \" .pe-button__content\": {\n      \" .pe-icon\": {\n        position: \"absolute\"\n      }\n    },\n\n    \".pe-control--small\":   makeSize(componentVars, vars.unit_icon_size_small, vars.unit_icon_size_small),\n    \".pe-control--regular\": makeSize(componentVars, componentVars.label_height, vars.unit_icon_size),\n    \".pe-control--medium\":  makeSize(componentVars, vars.unit_icon_size_medium, vars.unit_icon_size_medium),\n    \".pe-control--large\":   makeSize(componentVars, vars.unit_icon_size_large, vars.unit_icon_size_large)\n  }\n}];\n","// Returns a style function to be used by checkbox and radio-button\n\nconst style = (scopes, selector, componentVars, tint) => [{\n  [scopes.map(s => s + selector).join(\",\")]: {\n    color: componentVars[\"color_\" + tint + \"_on\"], // override by specifying \"color\"\n\n    \" .pe-control__label\": {\n      color: componentVars[\"color_\" + tint + \"_label\"]\n    },\n    \" .pe-control__box\": {\n      \" .pe-control__button\": {\n        color: \"inherit\",\n\n        \" .pe-control__button--on\": {\n          color: componentVars[\"color_\" + tint + \"_on_icon\"] ||  \"inherit\"\n        },\n\n        \" .pe-control__button--off\": {\n          color: componentVars[\"color_\" + tint + \"_off_icon\"] || componentVars[\"color_\" + tint + \"_off\"]\n        }\n      }\n    },\n    \".pe-control--off\": {\n      \" .pe-button--focus .pe-button__focus\": {\n        opacity: componentVars[\"color_\" + tint + \"_focus_off_opacity\"],\n        backgroundColor: componentVars[\"color_\" + tint + \"_focus_off\"]\n      }\n    },\n    \".pe-control--on\": {\n      \" .pe-button--focus .pe-button__focus\": {\n        opacity: componentVars[\"color_\" + tint + \"_focus_on_opacity\"],\n        backgroundColor: componentVars[\"color_\" + tint + \"_focus_on\"]\n      }\n    },\n\n    \".pe-control--disabled\": {\n      \" .pe-control__label\": {\n        color: componentVars[\"color_\" + tint + \"_disabled\"]\n      },\n      \" .pe-control__box\": {\n        \" .pe-control__button--on, .pe-control__button--off\": {\n          color: componentVars[\"color_\" + tint + \"_disabled\"]\n        }\n      }\n    }\n  }\n}];\n\nexport default (selector, componentVars) => [\n  style([\".pe-dark-tone\", \".pe-dark-tone \"], selector, componentVars, \"dark\"), // has/inside dark tone\n  style([\"\", \".pe-light-tone\", \".pe-light-tone \"], selector, componentVars, \"light\"), // normal, has/inside light tone\n];\n\n"],"names":["getInitialState","vnode","createStream","attrs","defaultChecked","undefined","checked","redrawOnChange","toggle","oldChecked","onChange","e","value","merge","sizeClasses","classes","small","regular","medium","large","classForSize","size","currentState","state","selectable","inactive","disabled","createProps","k","keys","_extends","filterSupportedAttributes","component","instanceClass","on","off","tone","className","class","join","events","createContent","h","renderer","Icon","IconButton","controlView","createControl","formLabel","label","onclick","createIcon","iconType","svg","trust","icons","icon","box","button","buttonOn","buttonOff","map","o","center","iconButton","rgba","vars","grid_unit_component","grid_unit","animation_duration","color_primary","color_light_foreground","blend_light_text_secondary","blend_light_text_disabled","color_dark_foreground","blend_dark_text_secondary","blend_dark_text_disabled","makeSize","componentVars","height","iconSize","unit_icon_size","labelSize","label_height","iconOffset","mixin","fit","selector","flex","layoutHorizontal","layoutCenter","label_font_size","defaultTransition","button_size","icon_size","label_padding_before","label_padding_after","unit_icon_size_small","unit_icon_size_medium","unit_icon_size_large","style","scopes","tint","s"],"mappings":"mwBACA,iBACa,uBAGA,+BACA,0BACA,6BAGA,gCACA,6BACA,2BACA,yBACA,qBACA,yBACA,4BACA,wBAGA,yBACA,+BAGA,mCACA,8LCnBAA,EAAkB,SAACC,EAAOC,MAC/BC,GAAQF,EAAME,MAEdC,MAAmCC,KAAlBF,EAAMG,UACvBH,EAAMG,UACNH,EAAMC,iBAAkB,EAExBE,EAAUJ,EAAaE,GACvBG,EAAiBL,EAAaE,GAE9BI,EAAS,cACPC,OAA+BJ,KAAlBF,EAAMG,QACrBH,EAAMG,QACNA,OACKG,MACOA,IAGZC,MAA8BL,KAAnBF,EAAMO,SACnB,kBACEF,KACAL,EAAMO,gBACGC,UACEL,UACFH,EAAMS,SAGjB,iBAAMJ,iDAKQN,EAAaW,OAAON,MAIlCO,SACKC,EAAQC,cACRD,EAAQE,eACRF,EAAQG,aACRH,EAAQI,OAGbC,EAAe,cAACC,0DAAO,gBAAcP,GAAYO,IAEjDC,EAAe,SAACnB,EAAOoB,MACrBjB,OAA4BD,KAAlBF,EAAMG,QAClBH,EAAMG,QACNiB,EAAMjB,UACJkB,MAAkCnB,KAArBF,EAAMqB,YACrBrB,EAAMqB,WAAWlB,UAGZA,UAASmB,SADDtB,EAAMuB,WAAaF,IAIzBG,EAAc,SAAC1B,QAAe2B,KAANC,KAC7B1B,EAAQF,EAAME,MACdoB,EAAQtB,EAAMsB,QACUD,EAAanB,EAAOoB,GAA1CjB,IAAAA,QAASmB,IAAAA,eACVK,MAELC,4BAA0B5B,eAGtBY,EAAQiB,UACR7B,EAAM8B,gBACIlB,EAAQmB,GAAKnB,EAAQoB,IAC/BhC,EAAMuB,SAAWX,EAAQW,SAAW,KACpCD,EAAWV,EAAQU,SAAW,KAC9BL,EAAajB,EAAMkB,MACJ,SAAflB,EAAMiC,KAAkB,eAAiB,KAC1B,UAAfjC,EAAMiC,KAAmB,gBAAkB,KAC3CjC,EAAMkC,WAAalC,EAAMyB,EAAEU,QAC3BC,KAAK,MAETpC,EAAMqC,SAIGC,EAAgB,SAACxC,QAAmByC,KAAVC,SAAmBf,IAANC,KAASe,IAAAA,KAAMC,IAAAA,WAC3DtB,EAAQtB,EAAMsB,MACdpB,EAAQF,EAAME,MACZsB,EAAaH,EAAanB,EAAOoB,GAAjCE,SACFqB,EAAc3C,EAAM4C,cACtB5C,EAAM4C,eAAgBL,IAAGd,IAAGH,WAAUf,SAAUa,EAAMb,SAAUP,QAAOyC,OAAMC,eAC7E,WAEGH,GAAE,mBAEM3B,EAAQiC,cACd,UAGLF,EACA3C,EAAM8C,MACFP,MAAM3B,EAAQkC,MACZxB,EACI,UACGG,EAAEsB,QAAU3B,EAAMb,UACzBP,EAAM8C,OAER,QAKJE,EAAa,SAACT,EAAGU,EAAUjD,EAAOkC,eAKpClC,EAAMiD,GACFjD,EAAMiD,IACJC,IAAKX,EAAEY,MAAMnD,EAAMoD,MAAMH,MAC7Bf,aACFlC,EAAMqD,KACNrD,EAAMkB,MACAA,KAAMlB,EAAMkB,MACd,OAIK0B,EAAgB,eAAGL,KAAAA,EAAGd,IAAAA,EAAGzB,IAAAA,MAAOsB,IAAAA,SAAUf,IAAAA,SAAUkC,IAAAA,KAAMC,IAAAA,iBACrEH,GAAE,OACEL,UAAWtB,EAAQ0C,KACrBf,EAAEG,EAAYf,cAGD,gBACEf,EAAQ2C,iBAEfN,SAAU,SAAUf,UAAWtB,EAAQ4C,WACvCP,SAAU,UAAWf,UAAWtB,EAAQ6C,YAC1CC,IAAI,kBACJnB,GAAEE,EAAMO,EAAWT,EAAGoB,EAAEV,SAAUjD,EAAO2D,EAAEzB,sBAEnC0B,QAAQ,YACR5D,EAAMuB,qBACLE,EAAEsB,QAAUxC,eAGzBP,EAAM6D,wCAhJW,wECFjBC,EAAOC,OAAKD,wBAGqB,EAAIC,OAAKC,iCACT,EAAID,OAAKC,yCACQ,EAAjBD,OAAKE,8BACL,cACA,EAAIF,OAAKC,8BACT,EAAID,OAAKC,uCACTD,OAAKG,kCAELH,OAAKD,KAAKC,OAAKI,+BACfL,EAAKC,OAAKK,uBAAwBL,OAAKM,8CACvCP,EAAKC,OAAKK,uBAAwBL,OAAKM,iDACvCP,EAAKC,OAAKK,uBAAwBL,OAAKO,+DACvC,uCACA,yBAMAR,EAAKC,OAAKI,4CACV,0BACCL,EAAKC,OAAKK,sDACX,kBAEAL,OAAKD,KAAKC,OAAKI,8BACfL,EAAKC,OAAKQ,sBAAuBR,OAAKS,4CACtCV,EAAKC,OAAKQ,sBAAuBR,OAAKS,+CACtCV,EAAKC,OAAKQ,sBAAuBR,OAAKU,6DACtC,sCACA,wBAMAX,EAAKC,OAAKI,2CACV,yBACAL,EAAKC,OAAKQ,oDACV,KCtCjCG,EAAW,SAACC,EAAeC,MAAQC,0DAAWd,OAAKe,eACjDC,EAAYF,EAAWF,EAAcK,aACrCC,GAAcF,EAAYF,GAAY,4CAGhCD,EAAS,iCAGVC,EAAW,YACVA,EAAW,oCAGZE,EAAY,YACXA,EAAY,kBAGlBG,QAAMC,IAAIF,kBAgBFG,EAAUT,eACvBS,WACU,yBACE,oBACH,UACC,8BAGPC,OAAKC,iBACLD,OAAKE,uBAEO,kBACF,mBACEZ,EAAca,gBAAkB,gBAC9Bb,EAAcK,aAAe,YACjC,QACD,4BAGI,iEAOH,0CAKA,mBACD,yBACE,mBACJL,EAAcK,aAAe,YAC5BL,EAAcK,aAAe,WAC9B,4BAGI,sCAKXE,QAAMO,kBAAkB,UAAWd,EAAcT,8BACrC,kBACDS,EAAce,YAAcf,EAAcgB,WAAa,EAAK,WAC7DhB,EAAce,YAAcf,EAAcgB,WAAa,EAAK,YAC5D,4DApDL,SACD,wCANC,SACD,2DADC,SACD,wCAIC,SACD,uCAkEShB,EAAciB,qBAAuB,kBACpCjB,EAAckB,oBAAsB,kEAKxC,8CAGO,uDAML,kCAIUnB,EAASC,EAAeZ,OAAK+B,qBAAsB/B,OAAK+B,6CACxDpB,EAASC,EAAeA,EAAcK,aAAcjB,OAAKe,sCACzDJ,EAASC,EAAeZ,OAAKgC,sBAAuBhC,OAAKgC,4CACzDrB,EAASC,EAAeZ,OAAKiC,qBAAsBjC,OAAKiC,0BCxH9EC,EAAQ,SAACC,EAAQd,EAAUT,EAAewB,eAC7CD,EAAOxC,IAAI,kBAAK0C,GAAIhB,IAAUhD,KAAK,YAC3BuC,EAAc,SAAWwB,EAAO,oCAG9BxB,EAAc,SAAWwB,EAAO,8DAI9B,4CAGExB,EAAc,SAAWwB,EAAO,aAAgB,8CAIhDxB,EAAc,SAAWwB,EAAO,cAAgBxB,EAAc,SAAWwB,EAAO,+EAMhFxB,EAAc,SAAWwB,EAAO,sCACxBxB,EAAc,SAAWwB,EAAO,mFAKxCxB,EAAc,SAAWwB,EAAO,qCACxBxB,EAAc,SAAWwB,EAAO,qEAM1CxB,EAAc,SAAWwB,EAAO,+FAI9BxB,EAAc,SAAWwB,EAAO,+BAOjCf,EAAUT,UACxBsB,GAAO,gBAAiB,kBAAmBb,EAAUT,EAAe,WAC7D,GAAI,iBAAkB,mBAAoBS,EAAUT,EAAe"}