{"version":3,"file":"polythene-core-dialog.js","sources":["../../polythene-css-classes/list-tile.js","../../polythene-css-classes/menu.js","../../polythene-css-classes/dialog.js","../src/dialog-instance.js","../src/vars.js","../src/transitions.js"],"sourcesContent":["\nexport default {\n  component:       \"pe-list-tile\",\n\n  // elements\n  content:         \"pe-list-tile__content\",\n  highSubtitle:    \"pe-list-tile__high-subtitle\",\n  primary:         \"pe-list-tile__primary\",\n  secondary:       \"pe-list-tile__secondary\",\n  subtitle:        \"pe-list-tile__subtitle\",\n  title:           \"pe-list-tile__title\",\n  contentFront:    \"pe-list-tile__content-front\",\n\n  // states\n  compact:         \"pe-list-tile--compact\",\n  compactFront:    \"pe-list-tile--compact-front\",\n  disabled:        \"pe-list-tile--disabled\",\n  hasFront:        \"pe-list-tile--front\",\n  hasHighSubtitle: \"pe-list-tile--high-subtitle\",\n  hasSubtitle:     \"pe-list-tile--subtitle\",\n  header:          \"pe-list-tile--header\",\n  hoverable:       \"pe-list-tile--hoverable\",\n  selectable:      \"pe-list-tile--selectable\",\n  selected:        \"pe-list-tile--selected\",\n  highlight:       \"pe-list-tile--highlight\",\n  sticky:          \"pe-list-tile--sticky\",\n};\n","import listTileClasses from \"./list-tile\";\n\nexport default {\n  component:   \"pe-menu\",\n\n  // elements\n  content:     \"pe-menu__content\",\n  placeholder: \"pe-menu__placeholder\",\n  target:      \"pe-menu__target\",\n\n  // states\n  permanent:   \"pe-menu--permanent\",\n  visible:     \"pe-menu--visible\",\n  width_auto:  \"pe-menu--width-auto\",\n  width_n:     \"pe-menu--width-\",\n\n  // lookup\n  listTile:         listTileClasses.component,\n  selectedListTile: listTileClasses.selected,\n};\n","import menuClasses from \"./menu\";\n\nexport default {\n  component:         \"pe-dialog\",\n\n  // elements\n  placeholder:       \"pe-dialog__placeholder\",\n  holder:            \"pe-dialog__holder\",\n  content:           \"pe-dialog__content\",\n\n  // states\n  fullScreen:        \"pe-dialog--full-screen\",\n  backdrop:          \"pe-dialog--backdrop\",\n  open:              \"pe-dialog--open\",\n\n  // lookup\n  menuContent:       menuClasses.content,\n};\n","import { filterSupportedAttributes, subscribe, unsubscribe, show, hide } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst DEFAULT_Z = 3;\n\nconst showDialog = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  const id = state.instanceId;\n  state.transitioning(true);\n  const transitions = attrs.transitions;\n  return show(Object.assign({},\n    attrs,\n    transitions.show({ el: state.el, showDuration: attrs.showDuration, showDelay: attrs.showDelay })\n  )).then(() => {\n    if (attrs.multipleDidShow) {\n      attrs.multipleDidShow(id); // this will call attrs.didShow\n    }\n    state.transitioning(false);\n  });\n};\n\nconst hideDialog = (state, attrs) => {\n  if (state.transitioning()) {\n    return Promise.resolve();\n  }\n  const id = state.instanceId;\n  state.transitioning(true);\n  const transitions = attrs.transitions;\n  return hide(Object.assign({},\n    attrs,\n    transitions.hide({ el: state.el, hideDuration: attrs.hideDuration, hideDelay: attrs.hideDelay })\n  )).then(() => {\n    if (attrs.multipleDidHide) {\n      attrs.multipleDidHide(id); // this will call attrs.didHide\n    }\n    state.transitioning(false);\n  });\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  return {\n    cleanUp: undefined,\n    el:      undefined,\n    transitioning\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.el = vnode.dom;\n \n  const handleEscape = e => {\n    if (attrs.fullScreen || attrs.modal) return;\n    if (e.key === \"Escape\") {\n      hideDialog(state, Object.assign({}, attrs, {\n        hideDelay: 0\n      }));\n    }\n  };\n  \n  state.cleanUp = () => (\n    unsubscribe(\"keydown\", handleEscape)\n  );\n\n  subscribe(\"keydown\", handleEscape);\n\n  if (attrs.showInstance) {\n    showDialog(state, attrs);\n  }\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullScreen ? classes.fullScreen : null,\n        attrs.backdrop ? classes.backdrop : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      // click backdrop: close dialog\n      [k.onclick]: e => {\n        if (e.target !== state.el) {\n          return;\n        }\n        if (attrs.modal) {\n          // not allowed\n          return;\n        }\n        hideDialog(state, Object.assign({}, attrs, {\n          hideDelay: 0\n        }));\n      }\n    },\n    attrs.formOptions ? attrs.formOptions : null\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, Shadow, DialogPane }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.hideInstance) {\n    hideDialog(state, attrs);\n  }\n  const pane = attrs.panes && attrs.panes.length\n    ? attrs.panes[0]\n    : h(DialogPane,\n      {\n        title: attrs.title,\n        header: attrs.header,\n        body: attrs.content || attrs.body || attrs.menu,\n        footer: attrs.footer,\n        footerButtons: attrs.footerButtons,\n        className: attrs.className,\n        style: attrs.style,\n        fullBleed: attrs.fullBleed\n      }\n    );\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.fullScreen\n        ? null\n        : h(Shadow, {\n          z: attrs.z !== undefined ? attrs.z : DEFAULT_Z,\n          animated: true\n        }),\n      pane\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  border_radius:                   vars.unit_block_border_radius,\n  padding_vertical:                3 * vars.grid_unit_component,\n  padding_horizontal:              5 * vars.grid_unit_component,\n  color_light_backdrop_background: \"rgba(0, 0, 0, .4)\",\n  color_dark_backdrop_background:  \"rgba(0, 0, 0, .5)\",\n\n  color_light_background:          rgba(vars.color_light_background),\n  color_dark_background:           rgba(vars.color_dark_background),\n\n  color_light_text:                rgba(vars.color_light_foreground, vars.blend_light_text_regular),\n  color_dark_text:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_regular),\n};\n","const ANIMATION_DURATION = .220;\n\nconst show = ({ el, showDuration, showDelay }) => ({\n  el,\n  showDuration: showDuration || ANIMATION_DURATION,\n  showDelay:    showDelay || 0,\n  beforeShow:   () => el.style.opacity = 0,\n  show:         () => el.style.opacity = 1,\n});\n\nconst hide = ({ el, hideDuration, hideDelay }) => ({\n  el,\n  hideDuration: hideDuration || ANIMATION_DURATION,\n  hideDelay:    hideDelay || 0,\n  hide:         () => el.style.opacity = 0\n});\n\nexport default {\n  show,\n  hide\n};\n"],"names":["listTileClasses","component","selected","menuClasses","content","getElement","vnode","attrs","element","DEFAULT_Z","showDialog","state","transitioning","Promise","resolve","id","instanceId","transitions","show","el","showDuration","showDelay","then","multipleDidShow","hideDialog","hide","hideDuration","hideDelay","multipleDidHide","getInitialState","createStream","undefined","onMount","dom","handleEscape","fullScreen","modal","e","key","cleanUp","unsubscribe","showInstance","onUnMount","createProps","k","keys","filterSupportedAttributes","remove","classes","backdrop","tone","className","class","join","onclick","target","formOptions","createContent","h","renderer","Shadow","DialogPane","hideInstance","pane","panes","length","title","header","body","menu","footer","footerButtons","style","fullBleed","menuContent","z","rgba","colorStr","opacity","vars","unit_block_border_radius","grid_unit_component","color_light_background","color_dark_background","color_light_foreground","blend_light_text_regular","color_dark_foreground","blend_dark_text_regular","ANIMATION_DURATION"],"mappings":"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"}