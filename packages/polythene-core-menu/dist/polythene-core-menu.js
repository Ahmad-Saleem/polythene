!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core"),require("polythene-css-classes"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-css-classes","polythene-theme"],t):t(e.polythene={},e["polythene-core"],e["polythene-css-classes"],e["polythene-theme"])}(this,function(e,t,n,i){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(e){return e.attrs.element||"div"},a=function(e,i){if(!t.isServer){var o=document.querySelector(i.target);if(o){var s=void 0!==i.offset?i.offset:0,r=e.dom();if(r){var a=e.dom().querySelector("."+n.menuClasses.content),l=i.origin||"top-left",u=0;if(i.reposition){var c=a.querySelectorAll("."+n.menuClasses.listTile)[0],d=a.querySelector("."+n.menuClasses.selectedListTile);if(c&&d){var f=c.getBoundingClientRect(),p=d.getBoundingClientRect();u=p.top-f.top}var m=(d||c).getBoundingClientRect(),h=o.getBoundingClientRect(),v=m.height-h.height;u+=v/2}var g=o.getBoundingClientRect();if(r.parentNode){var b=r.parentNode.getBoundingClientRect(),y=function(){return r.style.left=g.left-b.left+s+"px"},C=function(){return r.style.right=g.right-b.right+s+"px"},_=function(){return r.style.top=g.top-b.top-u-8+"px"},k=function(){return r.style.bottom=g.bottom-b.bottom-u+"px"};({"top-left":function(){return _()&&y()},"top-right":function(){return _()&&C()},"bottom-left":function(){return k()&&y()},"bottom-right":function(){return k()&&C()}})[l].call()}}}}},l=function(e,i){i.onChange&&i.onChange({visible:!1,transitioning:!0}),a(e,i);var o=i.transitions,r=e.dom();return t.show(s({},i,o?o.show(r,i):{el:r,showClass:n.menuClasses.visible})).then(function(){i.onChange&&i.onChange({visible:!0,transitioning:!1}),i.didShow&&i.didShow(i.id),e.visible(!1)})},u=function(e,i){i.onChange&&i.onChange({visible:!0,transitioning:!0});var o=i.transitions,r=e.dom();return t.hide(s({},i,o?o.hide(r,i):{el:r,showClass:n.menuClasses.visible})).then(function(){i.onChange&&i.onChange({visible:!1,transitioning:!1}),i.didHide&&i.didHide(i.id),e.visible(!1)})},c=function(e){return e<1.5?1.5:e},d=function(e){return n.menuClasses.width_n+e.toString().replace(".","-")},f=function(e,n){var i=e.state,o=e.attrs;"mount"===n?(t.subscribe("resize",i.update),t.subscribe("keydown",i.handleEscape),setTimeout(function(){i.activateDismissTap(),l(i,o)},0)):(t.unsubscribe("resize",i.update),t.unsubscribe("keydown",i.handleEscape),i.deActivateDismissTap())},p=function(e){if(e.dom){var t=e.state,n=e.attrs;t.dom(e.dom),n.permanent||(t.handleDismissTap=function(e){e.target!==t.dom()&&(e.defaultPrevented?u(t,n):u(t,s({},n,{hideDelay:0})))},t.update=function(){a(t,n)},t.activateDismissTap=function(){document.body.addEventListener("click",t.handleDismissTap)},t.deActivateDismissTap=function(){document.body.removeEventListener("click",t.handleDismissTap)},t.handleEscape=function(e){"Escape"===e.key&&u(t,s({},n,{hideDelay:0}))},f(e,"mount"))}},m=function(e){e.attrs.permanent||f(e,"unmount")},h=function(e,t){var n=t(null),i=t(!1);return{dom:n,visible:i,activateDismissTap:void 0,deActivateDismissTap:void 0,handleDismissTap:void 0,handleEscape:void 0,update:void 0,redrawOnUpdate:t.merge([i])}},v=function(e,i){var o=i.keys,r=e.attrs;return s({},t.filterSupportedAttributes(r),{className:[n.menuClasses.component,r.permanent?n.menuClasses.permanent:null,r.target?n.menuClasses.target:null,r.size?d(c(r.size)):null,"dark"===r.tone?"pe-dark-tone":null,"light"===r.tone?"pe-light-tone":null,r.className||r[o.class]].join(" ")})},g=function(e,t){var i,s=t.renderer,r=t.keys,a=t.Shadow,l=e.attrs,u=void 0!==l.z?l.z:1;return s("div",(i={className:n.menuClasses.content},o(i,r.onclick,function(e){return e.preventDefault()}),o(i,"style",l.style),i),[u>0&&s(a,{z:u,animated:!0}),l.content?l.content:e.children])},b=Object.freeze({getElement:r,onMount:p,onUnMount:m,getInitialState:h,createProps:v,createContent:g}),y=function(e){return"rgba("+e+", "+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)+")"},C={sizes:[1,1.5,2,3,4,5,6,7],min_size:1.5,max_size_small_screen:5,size_factor:i.vars.grid_unit_menu,border_radius:i.vars.unit_block_border_radius,color_light_background:y(i.vars.color_light_background),color_dark_background:y(i.vars.color_dark_background)};e.coreMenu=b,e.classes=n.menuClasses,e.vars=C,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-menu.js.map
