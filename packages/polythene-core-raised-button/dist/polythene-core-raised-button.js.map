{"version":3,"file":"polythene-core-raised-button.js","sources":["../src/raised-button.js","../src/vars.js"],"sourcesContent":["import { isServer, pointerStartMoveEvent, pointerEndEvent, subscribe } from \"polythene-core\";\nimport classes from \"./classes\";\n\n// Don't export 'getElement': it will be the wrapped button component (set in polythene-xxx-raised-button)\n\nconst MAX_Z = 5;\n\nlet tapStart,\n  tapEndAll = () => {},\n  downButtons = [];\n\nsubscribe(pointerEndEvent, () => tapEndAll());\n\nconst animateZ = (which, vnode) => {\n  const zBase = vnode.state.zBase;\n  const increase = vnode.attrs.increase || 1;\n  const z = vnode.state.z();\n  const newZ = which === \"down\" && zBase < MAX_Z\n    ? Math.min(zBase + increase, MAX_Z)\n    : which === \"up\"\n      ? Math.max(z - increase, zBase)\n      : z;\n  if (newZ !== z) {\n    vnode.state.z(newZ);\n  }\n};\n\nconst tapHandler = (which, vnode) => {\n  if (which === \"down\") {\n    downButtons.push(Object.assign({}, vnode));\n  }\n  const animateOnTap = vnode.attrs.animateOnTap !== false ? true : false;\n  if (animateOnTap) {\n    animateZ(which, vnode);\n  }\n};\n\nconst initTapEvents = vnode => {\n  if (isServer) return;\n  tapStart = () => tapHandler(\"down\", vnode);\n  tapEndAll = () => {\n    downButtons.map(buttonVnode =>\n      tapHandler(\"up\", buttonVnode));\n    downButtons = [];\n  };\n  vnode.dom.addEventListener(pointerStartMoveEvent, tapStart);\n};\n\nconst clearTapEvents = vnode =>\n  vnode.dom.removeEventListener(pointerStartMoveEvent, tapStart);\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const zBase = attrs.z !== undefined ? attrs.z : 1;\n  const z = createStream(zBase);\n  const tapEventsInited = createStream(false);\n  return {\n    zBase,\n    z,\n    tapEventsInited,\n    redrawOnUpdate: createStream.merge([z])\n  };\n};\n\nexport const onMount = vnode => {\n  const state = vnode.state;\n  if (vnode.dom && !state.tapEventsInited()) {\n    initTapEvents(vnode);\n    state.tapEventsInited(true);\n  }\n};\n\nexport const onUnMount = vnode => {\n  if (vnode.state.tapEventsInited()) {\n    clearTapEvents(vnode);\n  }\n};\n\nexport const createProps = (vnode, { renderer: h, Shadow }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const children = attrs.children || vnode.children || [];\n  return Object.assign(\n    {},\n    {\n      parentClassName: [\n        attrs.parentClassName || classes.component\n      ].join(\" \"),\n      animateOnTap: false,\n      shadowComponent: h(Shadow, {\n        z: attrs.disabled ? 0 : state.z,\n        animated: true\n      }),\n      children\n    },\n    attrs\n  );\n};\n\nexport const createContent = () => null;\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  color_light_background:          \"#fff\",\n  color_light_text:                rgba(vars.color_light_foreground, vars.blend_light_text_primary),\n  color_light_hover_background:    \"transparent\",\n  color_light_focus_background:    rgba(vars.color_light_foreground, vars.blend_light_background_hover),\n  color_light_active_background:   rgba(vars.color_light_foreground, vars.blend_light_background_hover), // same as hover\n  color_light_disabled_background: rgba(vars.color_light_foreground, vars.blend_light_background_disabled),\n  color_light_disabled_text:       rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n\n  color_dark_background:           rgba(vars.color_primary),\n  color_dark_text:                 rgba(vars.color_dark_foreground, vars.blend_dark_text_primary),\n  color_dark_hover_background:     vars.color_primary_active,\n  color_dark_focus_background:     vars.color_primary_active,\n  color_dark_active_background:    vars.color_primary_dark,\n  color_dark_disabled_background:  rgba(vars.color_dark_foreground, vars.blend_dark_background_disabled),\n  color_dark_disabled_text:        rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled)\n};\n"],"names":["tapStart","tapEndAll","downButtons","subscribe","pointerEndEvent","animateZ","which","vnode","zBase","state","increase","attrs","z","newZ","Math","min","max","tapHandler","push","_extends","animateOnTap","initTapEvents","isServer","map","buttonVnode","dom","addEventListener","pointerStartMoveEvent","clearTapEvents","removeEventListener","getInitialState","createStream","undefined","merge","onMount","tapEventsInited","onUnMount","createProps","h","renderer","Shadow","children","parentClassName","classes","component","join","disabled","createContent","rgba","colorStr","vars","color_light_foreground","blend_light_text_primary","blend_light_background_hover","blend_light_background_disabled","blend_light_text_disabled","color_primary","color_dark_foreground","blend_dark_text_primary","color_primary_active","color_primary_dark","blend_dark_background_disabled","blend_dark_text_disabled"],"mappings":"+jBAOIA,SACFC,EAAY,aACZC,IAEFC,aAAUC,kBAAiB,iBAAMH,MAEjC,IAAMI,GAAW,SAACC,EAAOC,MACjBC,GAAQD,EAAME,MAAMD,MACpBE,EAAWH,EAAMI,MAAMD,UAAY,EACnCE,EAAIL,EAAME,MAAMG,IAChBC,EAAiB,SAAVP,GAAoBE,EAZrB,EAaRM,KAAKC,IAAIP,EAAQE,EAbT,GAcE,OAAVJ,EACEQ,KAAKE,IAAIJ,EAAIF,EAAUF,GACvBI,CACFC,KAASD,KACLH,MAAMG,EAAEC,IAIZI,EAAa,SAACX,EAAOC,GACX,SAAVD,KACUY,KAAKC,KAAkBZ,KAEa,IAA7BA,EAAMI,MAAMS,gBAEtBd,EAAOC,IAIdc,EAAgB,YAChBC,eACO,iBAAML,GAAW,OAAQV,MACxB,aACEgB,IAAI,kBACdN,GAAW,KAAMO,aAGfC,IAAIC,iBAAiBC,wBAAuB3B,KAG9C4B,EAAiB,kBACrBrB,GAAMkB,IAAII,oBAAoBF,wBAAuB3B,IAE1C8B,EAAkB,SAACvB,EAAOwB,MAC/BpB,GAAQJ,EAAMI,MACdH,MAAoBwB,KAAZrB,EAAMC,EAAkBD,EAAMC,EAAI,EAC1CA,EAAImB,EAAavB,sCACCuB,GAAa,kBAKnBA,EAAaE,OAAOrB,MAI3BsB,EAAU,eACfzB,GAAQF,EAAME,KAChBF,GAAMkB,MAAQhB,EAAM0B,sBACR5B,KACR4B,iBAAgB,KAIbC,EAAY,YACnB7B,EAAME,MAAM0B,qBACC5B,IAIN8B,EAAc,SAAC9B,QAAmB+B,KAAVC,SAAaC,IAAAA,OAC1C7B,EAAQJ,EAAMI,MACdF,EAAQF,EAAME,MACdgC,EAAW9B,EAAM8B,UAAYlC,EAAMkC,mBAClCtB,wBAIDR,EAAM+B,iBAAmBC,sBAAQC,WACjCC,KAAK,mBACO,kBACGP,EAAEE,KACd7B,EAAMmC,SAAW,EAAIrC,EAAMG,YACpB,gBAIdD,IAISoC,EAAgB,iBAAM,gGCjG7BC,EAAO,SAACC,iBACJA,+DADwB,kCAIC,wBACAD,EAAKE,OAAKC,uBAAwBD,OAAKE,uDACvC,2CACAJ,EAAKE,OAAKC,uBAAwBD,OAAKG,4DACvCL,EAAKE,OAAKC,uBAAwBD,OAAKG,8DACvCL,EAAKE,OAAKC,uBAAwBD,OAAKI,2DACvCN,EAAKE,OAAKC,uBAAwBD,OAAKK,iDAEvCP,EAAKE,OAAKM,+BACVR,EAAKE,OAAKO,sBAAuBP,OAAKQ,qDACtCR,OAAKS,iDACLT,OAAKS,kDACLT,OAAKU,kDACLZ,EAAKE,OAAKO,sBAAuBP,OAAKW,yDACtCb,EAAKE,OAAKO,sBAAuBP,OAAKY"}