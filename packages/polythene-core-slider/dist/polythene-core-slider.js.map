{"version":3,"file":"polythene-core-slider.js","sources":["../src/vars.js","../../polythene-css-classes/slider.js","../src/slider.js"],"sourcesContent":["import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nconst lightForeground =                vars.color_light_foreground;\nconst darkForeground =                 vars.color_dark_foreground;\nconst activeColor =                    vars.color_primary; // or override in CSS by setting 'color' property on '.pe-slider'\nconst thumb_size =                     12;\nconst thumb_touch_size =               Math.max(40, thumb_size);\nconst thumb_border_width =             2;\nconst active_thumb_scale =             3/2;\nconst disabled_thumb_scale =           1/2;\nconst active_pin_thumb_scale =         2/6;\nconst largestThumbSize =               active_thumb_scale * thumb_size;\nconst largestElement =                 Math.max(thumb_touch_size, largestThumbSize);\nconst height =                         Math.max(52, largestThumbSize);\nconst side_spacing =                   Math.max(10, largestElement / 2 - thumb_size / 2);\nconst horizontal_layout_side_spacing = side_spacing + 4; // optimization for horizontal layout\n\nexport default {\n  height,\n  side_spacing,\n  horizontal_layout_side_spacing,\n  thumb_size,\n  thumb_touch_size,\n  track_height: height,\n  bar_height: 2,\n  thumb_border_width,\n  active_thumb_scale,\n  animation_duration: vars.animation_duration,\n  disabled_thumb_scale,\n  active_pin_thumb_scale,\n\n  step_width: 2,\n  pin_height: 32,\n  pin_width: 26,\n  pin_font_size: 10,\n\n  color_light_track_active:            rgba(lightForeground, .38),\n  color_light_track_inactive:          rgba(lightForeground, .26),\n  color_light_track_value:             rgba(activeColor),\n  // background color may be set in theme; disabled by default\n  // color_light_thumb_background:        undefined,\n  color_light_thumb_off:               rgba(lightForeground, .26),\n  color_light_thumb_off_focus:         rgba(lightForeground),\n  color_light_thumb_off_focus_opacity: .08,\n  color_light_thumb_on:                rgba(activeColor),\n  color_light_thumb_on_focus_opacity:  .11,\n  color_light_thumb_inactive:          rgba(lightForeground, .26),\n  color_light_tick:                    rgba(lightForeground, 1),\n  color_light_icon:                    rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled_icon:           rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_label:                   rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled_label:          rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n\n  color_dark_track_active:             rgba(darkForeground, .3),\n  color_dark_track_inactive:           rgba(darkForeground, .2),\n  color_dark_track_value:              rgba(activeColor),\n  // background color may be set in theme; disabled by default\n  // color_dark_thumb_background:         undefined,\n  color_dark_thumb_off:                rgba(darkForeground, .2),\n  color_dark_thumb_off_focus:          rgba(darkForeground),\n  color_dark_thumb_off_focus_opacity:  .08,\n  color_dark_thumb_on:                 rgba(activeColor),\n  color_dark_thumb_on_focus_opacity:   .11,\n  color_dark_thumb_inactive:           rgba(darkForeground, .2),\n  color_dark_tick:                     rgba(darkForeground, 1),\n  color_dark_icon:                     rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled_icon:            rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_label:                    rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled_label:           rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled)\n};\n","\nexport default {\n  component:      \"pe-slider\",\n\n  // elements\n  control:        \"pe-slider__control\",\n  label:          \"pe-slider__label\",\n  pin:            \"pe-slider__pin\",\n  thumb:          \"pe-slider__thumb\",\n  tick:           \"pe-slider__ticks-tick\",\n  ticks:          \"pe-slider__ticks\",\n  track:          \"pe-slider__track\",\n  trackBar:       \"pe-slider__track-bar\",\n  trackBarValue:  \"pe-slider__track-bar-value\",\n  trackPart:      \"pe-slider__track-part\",\n  trackPartRest:  \"pe-slider__track-rest\",\n  trackPartValue: \"pe-slider__track-value\",\n\n  // states\n  hasFocus:       \"pe-slider--focus\",\n  hasPin:         \"pe-slider--pin\",\n  hasTicks:       \"pe-slider--ticks\",\n  hasTrack:       \"pe-slider--track\",\n  isActive:       \"pe-slider--active\",\n  isAtMin:        \"pe-slider--min\",\n  isDisabled:     \"pe-slider--disabled\",\n};\n","import { isTouch, pointerStartMoveEvent, pointerMoveEvent, pointerEndMoveEvent, isClient, filterSupportedAttributes } from \"polythene-core\";\nimport themeVars from \"./vars\";\nimport classes from \"polythene-css-classes/slider\";\n\nconst MAX_TICKS = 100;\nlet focusElement;\n\nconst deFocus = state => {\n  if (focusElement) {\n    focusElement.blur();\n  }\n  focusElement = undefined;\n  state.hasFocus(false);\n};\n\nconst focus = (state, el) => {\n  deFocus(state);\n  focusElement = el;\n  state.hasFocus(true);\n};\n\nconst positionFromEvent = (e, isVertical) => (\n  // isVertical not yet implemented\n  isTouch && e.touches\n    ? isVertical ? e.touches[0].pageY : e.touches[0].pageX\n    : isVertical ? e.pageY : e.pageX);\n\nconst updatePinPosition = state => {\n  if (state.controlEl && state.pinEl) {\n    const left = state.fraction() * state.rangeWidth;\n    state.pinEl.style.left = left + \"px\";\n  }\n};\n\nconst updateValue = (state, value) => {\n  state.setValue(value, true);\n  updatePinPosition(state);\n};\n\nconst generateTickMarks = (h, stepCount) => {\n  const items = [];\n  let s = stepCount + 1;\n  while (s > 0) {\n    items.push(h(\"div\", {\n      className: classes.tick,\n      key: `tick-${s}`\n    }));\n    s--;\n  }\n  return items;\n};\n\nconst readRangeData = state => {\n  if (state.controlEl && isClient) {\n    // range is from the far left to the far right minus the thumb width (max x is at the left side of the thumb)\n    state.controlWidth = themeVars.thumb_size;\n    state.rangeWidth = state.trackEl.getBoundingClientRect().width - state.controlWidth;\n    const styles = window.getComputedStyle(state.trackEl);\n    state.rangeOffset = parseFloat(styles.marginLeft);\n  }\n};\n\nconst calculateClickOffset = (state, controlOffset = 0) => {\n  state.clickOffset = state.trackEl.getBoundingClientRect().left - (state.rangeOffset - state.controlWidth / 2) + controlOffset;\n};\n\nconst initControlEvent = (state, e) => {\n  const controlPos = state.controlEl.getBoundingClientRect().left;\n  const eventPos = positionFromEvent(e);\n  const controlOffset = eventPos - controlPos - state.controlWidth / 2;\n  calculateClickOffset(state, controlOffset);\n};\n\nconst initTrackEvent = (state) =>\n  calculateClickOffset(state, 0);\n\nconst handlePosEvent = (state, e) => {\n  const pos = positionFromEvent(e) - state.clickOffset;\n  const value = state.min + ((pos - state.rangeOffset) / state.rangeWidth) * (state.max - state.min);\n  updateValue(state, value);\n};\n\nconst startDrag = (state, attrs, e) => {\n  if (state.isDragging()) return;\n  e.preventDefault();\n  state.isDragging(true);\n  state.isActive(true);\n  deFocus(state);\n\n  const drag = e => {\n    if (!state.isDragging()) return;\n    handlePosEvent(state, e);\n  };\n\n  const endDrag = () => {\n    if (!state.isDragging()) return;\n    deFocus(state);\n    if (isClient) {\n      window.removeEventListener(pointerMoveEvent, drag);\n      window.removeEventListener(pointerEndMoveEvent, endDrag);\n    }\n    state.isDragging(false);\n    state.isActive(false);\n  };\n\n  if (isClient) {\n    window.addEventListener(pointerMoveEvent, drag);\n    window.addEventListener(pointerEndMoveEvent, endDrag);\n  }\n  readRangeData(state);\n\n  if (attrs.pin) {\n    updatePinPosition(state);\n  }\n};\n\nconst startTrack = (state, attrs, e) => {\n  e.preventDefault();\n  if (state.isDragging()) {\n    return;\n  }\n  readRangeData(state);\n  initTrackEvent(state);\n  handlePosEvent(state, e);\n  startDrag(state, attrs, e);\n};\n\nconst createSlider = (vnode, { h, k, hasTicks, interactiveTrack }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const fraction = state.fraction();\n  const range = state.max - state.min;\n  const stepCount = Math.min(MAX_TICKS, parseInt(range / state.stepSize, 10));\n\n  const onStartTrack = e => (\n    startTrack(state, attrs, e)\n  );\n\n  const onInitDrag = e => {\n    readRangeData(state);\n    initControlEvent(state, e);\n    startDrag(state, attrs, e);\n  };\n\n  const flexValueCss =  fraction + \" 1 0%\";\n  const flexRestValue = 1 - fraction;\n  const flexRestCss =   flexRestValue + \" 1 0%\";\n\n  return h(\"div\",\n    Object.assign(\n      {},\n      { className: classes.track },\n      interactiveTrack && !attrs.disabled && {\n        [k[`on${pointerStartMoveEvent}`]]: onStartTrack\n      }\n    ),\n    [\n      h(\"div\",\n        {\n          className: classes.trackPart + \" \" + classes.trackPartValue,\n          key: \"trackPartValue\",\n          style: {\n            flex: flexValueCss,\n            msFlex: flexValueCss,\n            WebkitFlex: flexValueCss\n          }\n        },\n        h(\"div\", { className: classes.trackBar },\n          h(\"div\", { className: classes.trackBarValue })\n        )\n      ),\n      h(\"div\", Object.assign(\n        {},\n        {\n          className: classes.control,\n          key: \"control\"\n        },\n        attrs.disabled\n          ? { disabled: true }\n          : {\n            [k.tabindex]: attrs[k.tabindex] || 0,\n            [k.onfocus]: () => focus(state, state.controlEl),\n            [k.onblur]: () => deFocus(state),\n            [k.onkeydown]: e => {\n              if (e.key !== \"Tab\") {\n                e.preventDefault();\n              }\n              if (e.key === \"Escape\") {\n                state.controlEl.blur(e);\n              } else if (e.key === \"ArrowLeft\" || e.key === \"ArrowDown\") {\n                state.decrement(state, e.shiftKey);\n              } else if (e.key === \"ArrowRight\" || e.key === \"ArrowUp\") {\n                state.increment(state, e.shiftKey);\n              } else if (e.key === \"Home\") {\n                updateValue(state, state.min);\n              } else if (e.key === \"End\") {\n                updateValue(state, state.max);\n              } else if (e.key === \"PageDown\") {\n                state.decrement(state, true);\n              } else if (e.key === \"PageUp\") {\n                state.increment(state, true);\n              }\n              readRangeData(state);\n              updatePinPosition(state);\n            }\n          },\n        !attrs.disabled && {\n          [k[`on${pointerStartMoveEvent}`]]: onInitDrag\n        },\n        attrs.events\n          ? attrs.events\n          : null,\n        hasTicks\n          ? { step: stepCount }\n          : null\n      ),\n      attrs.icon\n        ? h(\"div\",\n          {\n            className: classes.thumb,\n            key: \"icon\"\n          },\n          attrs.icon\n        )\n        : null\n      ),\n      h(\"div\",\n        {\n          className: classes.trackPart + \" \" + classes.trackPartRest,\n          key: \"trackPartRest\",\n          style: {\n            flex: flexRestCss,\n            msFlex: flexRestCss,\n            WebkitFlex: flexRestCss,\n            maxWidth: (flexRestValue * 100) + \"%\" // for IE Edge\n          }\n        },\n        h(\"div\", { className: classes.trackBar },\n          h(\"div\", { className: classes.trackBarValue })\n        )\n      ),\n      hasTicks && !attrs.disabled\n        ? h(\"div\",\n          {\n            className: classes.ticks,\n            key: \"ticks\"\n          },\n          generateTickMarks(h, stepCount)\n        )\n        : null,\n      hasTicks && attrs.pin && !attrs.disabled\n        ? h(\"div\",\n          {\n            className: classes.pin,\n            key: \"pin\",\n            value: state.value()\n          }\n        )\n        : null\n    ]\n  );\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n\n  const min = attrs.min !== undefined ? attrs.min : 0;\n  const max = attrs.max !== undefined ? attrs.max : 100;\n  const range = max - min;\n  const stepSize = attrs.stepSize !== undefined\n    ? attrs.stepSize\n    : 1;\n  const defaultValue = attrs.defaultValue !== undefined\n    ? attrs.defaultValue\n    : attrs.value !== undefined\n      ? attrs.value\n      : 0;\n  const previousValue = createStream(undefined);\n  const isActive = createStream(false);\n  const hasFocus = createStream(false);\n  const isDragging = createStream(false);\n  const fraction = createStream(min);\n  const value = createStream(0);\n  const normalizeFactor = 1 / stepSize;\n\n  const setValue = (v, shouldNotify = false) => {\n    if (v < min) v = min;\n    if (v > max) v = max;\n    value(stepSize\n      ? Math.round(v * normalizeFactor) / normalizeFactor\n      : v\n    );\n    fraction((value() - min) / range);\n    if (shouldNotify && attrs.onChange) {\n      attrs.onChange({\n        value: value()\n      });\n    }\n    previousValue(v);\n  };\n\n  const increment = (state, useLargeStep) =>\n    updateValue(state, value() + (useLargeStep ? 10 : 1) * (stepSize || 1));\n\n  const decrement = (state, useLargeStep) =>\n    updateValue(state, value() - (useLargeStep ? 10 : 1) * (stepSize || 1));\n  \n  setValue(defaultValue);\n  \n  return {\n    min,\n    max,\n    stepSize,\n    fraction,\n    // DOM elements\n    trackEl: null,\n    controlEl: null,\n    pinEl: null,\n    // functions\n    setValue,\n    increment,\n    decrement, \n    // streams\n    isDragging,\n    isActive,\n    value,\n    previousValue,\n    hasFocus,\n    // coordinates\n    controlWidth: 0,\n    rangeWidth: 0,\n    rangeOffset: 0,\n    clickOffset: 0,\n    redrawOnUpdate: createStream.merge([isActive, value])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  state.trackEl = dom.querySelector(`.${classes.track}`);\n  state.controlEl = dom.querySelector(`.${classes.control}`);\n  state.pinEl = dom.querySelector(`.${classes.pin}`);\n\n  readRangeData(state);\n\n  if (attrs.pin) {\n    setTimeout(() => {\n      updateValue(state, state.value());\n    }, 0);\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.value !== undefined) {\n    if (state.previousValue() !== attrs.value) {\n      state.previousValue(attrs.value);\n      setTimeout(() => state.setValue(state.previousValue()), 0); // perform in next tick to play nice with React\n    }\n  }\n  const hasTicks = attrs.ticks !== undefined && attrs.ticks !== false;\n  const interactiveTrack = (attrs.interactiveTrack !== undefined) ? attrs.interactiveTrack : true;\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.disabled ? classes.isDisabled : null,\n        attrs.pin ? classes.hasPin : null,\n        interactiveTrack ? classes.hasTrack : null,\n        state.isActive() ? classes.isActive : null,\n        state.hasFocus() ? classes.hasFocus : null,\n        state.fraction() === 0 ? classes.isAtMin : null,\n        hasTicks ? classes.hasTicks : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const attrs = vnode.attrs;\n  const hasTicks = attrs.ticks !== undefined && attrs.ticks !== false;\n  const interactiveTrack = (attrs.interactiveTrack !== undefined) ? attrs.interactiveTrack : true;\n  return createSlider(vnode, { h, k, hasTicks, interactiveTrack });\n};\n\n\n"],"names":["rgba","colorStr","opacity","lightForeground","vars","color_light_foreground","darkForeground","color_dark_foreground","activeColor","color_primary","thumb_size","thumb_touch_size","Math","max","thumb_border_width","active_thumb_scale","disabled_thumb_scale","active_pin_thumb_scale","largestThumbSize","largestElement","height","side_spacing","horizontal_layout_side_spacing","animation_duration","blend_light_text_secondary","blend_light_text_disabled","blend_dark_text_secondary","blend_dark_text_disabled","MAX_TICKS","focusElement","deFocus","blur","undefined","hasFocus","focus","state","el","positionFromEvent","e","isVertical","touches","pageY","pageX","updatePinPosition","controlEl","pinEl","left","fraction","rangeWidth","style","updateValue","value","setValue","generateTickMarks","h","stepCount","items","s","push","classes","tick","readRangeData","isClient","controlWidth","themeVars","trackEl","getBoundingClientRect","width","styles","window","getComputedStyle","rangeOffset","parseFloat","marginLeft","calculateClickOffset","controlOffset","clickOffset","initControlEvent","controlPos","eventPos","initTrackEvent","handlePosEvent","pos","min","startDrag","attrs","isDragging","preventDefault","isActive","drag","endDrag","removeEventListener","pointerMoveEvent","pointerEndMoveEvent","addEventListener","pin","startTrack","createSlider","vnode","k","hasTicks","interactiveTrack","range","parseInt","stepSize","onStartTrack","onInitDrag","flexValueCss","flexRestValue","flexRestCss","className","track","disabled","pointerStartMoveEvent","trackPart","trackPartValue","trackBar","trackBarValue","control","tabindex","onfocus","onblur","onkeydown","key","decrement","shiftKey","increment","events","step","icon","thumb","trackPartRest","ticks","getInitialState","createStream","defaultValue","previousValue","normalizeFactor","v","shouldNotify","round","onChange","useLargeStep","merge","onMount","dom","querySelector","createProps","keys","filterSupportedAttributes","component","isDisabled","hasPin","hasTrack","isAtMin","tone","class","join","createContent","renderer"],"mappings":"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"}