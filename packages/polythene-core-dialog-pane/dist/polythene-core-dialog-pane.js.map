{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../src/classes.js","../src/dialog-pane.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"./classes\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nconst updateFooterState = vnode => {\n  const state = vnode.state;\n  const footerEl = state.footerEl();\n  if (!footerEl) {\n    return;\n  }\n  const style = window.getComputedStyle(footerEl);\n  const height = footerEl.getBoundingClientRect().height;\n  const minHeight = parseInt(style.minHeight, 10);\n  if (height > minHeight) {\n    footerEl.classList.add(classes.footerHigh);\n  } else {\n    footerEl.classList.remove(classes.footerHigh);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream();\n  const headerEl = createStream();\n  const isScrolling = createStream(false);\n  const scrollEl = createStream();\n  const topOverflow = createStream(false);\n  const el = createStream();\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.title}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n    updateFooterState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n  \n  updateScrollOverflowState(vnode);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (borders === \"overflow\" && state.bottomOverflow());\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  padding:       3 * vars.grid_unit_component,\n  header_bottom: 20,\n  header_height: 60,\n  footer_height: 52,\n\n  border_width: 1,\n\n  color_light_title_text:          \"inherit\",\n  color_light_body_text:           \"inherit\",\n  color_light_body_border:         rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_light_background:          \"inherit\",\n\n  color_dark_title_text:           \"inherit\",\n  color_dark_body_text:            \"inherit\",\n  color_dark_body_border:          rgba(vars.color_dark_foreground, vars.blend_dark_border_light),\n  color_dark_background:           \"inherit\",\n};\n"],"names":["getElement","vnode","attrs","element","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","updateFooterState","footerEl","style","window","getComputedStyle","parseInt","minHeight","classList","add","classes","footerHigh","remove","getInitialState","createStream","headerEl","isScrolling","undefined","merge","onMount","dom","el","querySelector","body","footer","title","map","update","cleanUp","unsubscribe","onUnMount","createProps","k","keys","unpackAttrs","borders","showTopBorder","showBottomBorder","withHeader","header","withFooter","footerButtons","_extends","filterSupportedAttributes","component","fullBleed","borderTop","borderBottom","tone","className","class","join","formOptions","createContent","h","renderer","content","menu","menuContent","headerWithTitle","onscroll","scrollWatchId","setTimeout","footerWithButtons","actions","rgba","colorStr","vars","grid_unit_component","color_light_foreground","blend_light_border_light","color_dark_foreground","blend_dark_border_light"],"mappings":"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"}