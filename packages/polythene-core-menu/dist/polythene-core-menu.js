!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core"),require("polythene-core-list-tile"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-core-list-tile","polythene-theme"],t):t(e.polythene={},e["polythene-core"],e["polythene-core-list-tile"],e["polythene-theme"])}(this,function(e,t,n,i){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r={component:"pe-menu",content:"pe-menu__content",placeholder:"pe-menu__placeholder",target:"pe-menu__target",permanent:"pe-menu--permanent",visible:"pe-menu--visible",width_auto:"pe-menu--width-auto",width_n:"pe-menu--width-",listTile:n.classes.component,selectedListTile:n.classes.selected},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=function(e){return e.attrs.element||"div"},l=function(e,n){if(!t.isServer){var i=document.querySelector(n.target);if(i){var o=void 0!==n.offset?n.offset:0,a=e.dom();if(a){var s=e.dom().querySelector("."+r.content),l=n.origin||"top-left",u=0;if(n.reposition){var c=s.querySelectorAll("."+r.listTile)[0],d=s.querySelector("."+r.selectedListTile);if(c&&d){var p=c.getBoundingClientRect(),f=d.getBoundingClientRect();u=f.top-p.top}var h=(d||c).getBoundingClientRect(),m=i.getBoundingClientRect(),v=h.height-m.height;u+=v/2}var g=i.getBoundingClientRect();if(a.parentNode){var b=a.parentNode.getBoundingClientRect(),y=function(){return a.style.left=g.left-b.left+o+"px"},_=function(){return a.style.right=g.right-b.right+o+"px"},k=function(){return a.style.top=g.top-b.top-u-8+"px"},w=function(){return a.style.bottom=g.bottom-b.bottom-u+"px"};({"top-left":function(){return k()&&y()},"top-right":function(){return k()&&_()},"bottom-left":function(){return w()&&y()},"bottom-right":function(){return w()&&_()}})[l].call()}}}}},u=function(e,n){n.onChange&&n.onChange({visible:!1,transitioning:!0}),l(e,n);var i=n.transitions,o=e.dom();return t.show(a({},n,i?i.show(o,n):{el:o,showClass:r.visible})).then(function(){n.onChange&&n.onChange({visible:!0,transitioning:!1}),n.didShow&&n.didShow(n.id),e.visible(!1)})},c=function(e,n){n.onChange&&n.onChange({visible:!0,transitioning:!0});var i=n.transitions,o=e.dom();return t.hide(a({},n,i?i.hide(o,n):{el:o,showClass:r.visible})).then(function(){n.onChange&&n.onChange({visible:!1,transitioning:!1}),n.didHide&&n.didHide(n.id),e.visible(!1)})},d=function(e){return e<1.5?1.5:e},p=function(e){return r.width_n+e.toString().replace(".","-")},f=function(e,n){var i=e.state,o=e.attrs;"mount"===n?(t.subscribe("resize",i.update),t.subscribe("keydown",i.handleEscape),setTimeout(function(){i.activateDismissTap(),u(i,o)},0)):(t.unsubscribe("resize",i.update),t.unsubscribe("keydown",i.handleEscape),i.deActivateDismissTap())},h=function(e){if(e.dom){var t=e.state,n=e.attrs;t.dom(e.dom),n.permanent||(t.handleDismissTap=function(e){e.target!==t.dom()&&(e.defaultPrevented?c(t,n):c(t,a({},n,{hideDelay:0})))},t.update=function(){l(t,n)},t.activateDismissTap=function(){document.body.addEventListener("click",t.handleDismissTap)},t.deActivateDismissTap=function(){document.body.removeEventListener("click",t.handleDismissTap)},t.handleEscape=function(e){"Escape"===e.key&&c(t,a({},n,{hideDelay:0}))},f(e,"mount"))}},m=function(e){e.attrs.permanent||f(e,"unmount")},v=function(e,t){var n=t(),i=t(!1);return{dom:n,visible:i,activateDismissTap:void 0,deActivateDismissTap:void 0,handleDismissTap:void 0,handleEscape:void 0,update:void 0,redrawOnUpdate:t.merge([i])}},g=function(e,n){var i=n.keys,o=e.attrs;return a({},t.filterSupportedAttributes(o),{className:[r.component,o.permanent?r.permanent:null,o.target?r.target:null,o.size?p(d(o.size)):null,"dark"===o.tone?"pe-dark-tone":null,"light"===o.tone?"pe-light-tone":null,o.className||o[i.class]].join(" ")})},b=function(e,t){var n,i=t.renderer,a=t.keys,s=t.Shadow,l=e.attrs,u=void 0!==l.z?l.z:1;return i("div",(n={className:r.content},o(n,a.onclick,function(e){return e.preventDefault()}),o(n,"style",l.style),n),[u>0&&i(s,{z:u,animated:!0}),l.content?l.content:e.children])},y=Object.freeze({getElement:s,onMount:h,onUnMount:m,getInitialState:v,createProps:g,createContent:b}),_=function(e){return"rgba("+e+", "+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)+")"},k={sizes:[1,1.5,2,3,4,5,6,7],min_size:1.5,max_size_small_screen:5,size_factor:i.vars.grid_unit_menu,border_radius:i.vars.unit_block_border_radius,color_light_background:_(i.vars.color_light_background),color_dark_background:_(i.vars.color_dark_background)};e.coreMenu=y,e.classes=r,e.vars=k,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-menu.js.map
