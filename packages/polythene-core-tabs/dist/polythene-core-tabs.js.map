{"version":3,"file":"polythene-core-tabs.js","sources":["../src/vars.js","../../polythene-css-classes/button.js","../../polythene-css-classes/tabs.js","../src/tabs.js","../src/tab.js","../src/scroll-button.js"],"sourcesContent":["import { vars } from \"polythene-theme\";\nimport { vars as buttonVars } from \"polythene-core-button\";\nimport { vars as iconButtonVars } from \"polythene-core-icon-button\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nconst fontSize = buttonVars.font_size;\nconst tab_label_line_height = 1.1 * fontSize;\n\nexport default {\n  tab_min_width:                    72,\n  tab_min_width_tablet:             160,\n  tab_max_width:                    \"initial\",\n  tab_height:                       48,\n  label_max_width:                  264,\n  menu_tab_height:                  44,\n  menu_tab_icon_label_height:       44,\n  tab_icon_label_height:            72,\n  tab_icon_label_icon_spacing:      7,\n  indicator_slide_speed:            600, // px per second\n  indicator_slide_min_duration:     .250,\n  tabs_indent:                      vars.unit_indent,\n  tabs_scroll_speed:                600, // px per second\n  tabs_scroll_delay:                .15,\n  tabs_scroll_min_duration:         .5,\n  scroll_button_fade_duration:      .2,\n  scroll_button_fade_delay:         .25,\n  tab_content_padding_v:            12,\n  tab_menu_content_padding_v:       6,\n  tab_indicator_height:             2,\n  scrollbar_offset:                 20,\n  scroll_button_opacity:            .7,\n  label_opacity:                    .7,\n\n  tab_label_line_height,\n  tab_label_vertical_offset:        tab_label_line_height - fontSize,\n  tab_label_transition_property:    \"opacity, color, backgroundColor\",\n \n  color_light:                      \"inherit\",\n  color_light_selected:             rgba(vars.color_primary),\n  color_light_selected_background:  \"transparent\",\n  color_light_tab_indicator:        rgba(vars.color_primary),\n  color_light_icon:                 iconButtonVars.color_light,\n \n  color_dark:                       \"inherit\",\n  color_dark_selected:              rgba(vars.color_primary),\n  color_dark_selected_background:   \"transparent\",\n  color_dark_tab_indicator:         rgba(vars.color_primary),\n  color_dark_icon:                  iconButtonVars.color_dark\n};\n","\nexport default {\n  base:       \"pe-button\",\n  component:  \"pe-button pe-text-button\",\n  row:        \"pe-button-row\",\n\n  // elements\n  content:    \"pe-button__content\",\n  focus:      \"pe-button__focus\",\n  label:      \"pe-button__label\",\n  wash:       \"pe-button__wash\",\n\n  // states\n  borders:    \"pe-button--borders\",\n  disabled:   \"pe-button--disabled\",\n  focused:    \"pe-button--focus\",\n  inactive:   \"pe-button--inactive\",\n  selected:   \"pe-button--selected\",\n};\n","import buttonClasses from \"./button\";\n\nexport default {\n  component:            \"pe-tabs\",\n\n  // elements\n  indicator:            \"pe-tabs__indicator\",\n  scrollButton:         \"pe-tabs__scroll-button\",\n  scrollButtonAtEnd:    \"pe-tabs__scroll-button-end\",\n  scrollButtonAtStart:  \"pe-tabs__scroll-button-start\",\n  scrollButtonOffset:   \"pe-tabs__scroll-button-offset\",\n  tab:                  \"pe-tabs__tab\",\n  tabContent:           \"pe-tabs__tab-content\",\n  tabRow:               \"pe-tabs__row\",\n\n  // states\n  activeSelectable:     \"pe-tabs__active--selectable\",\n  isAtEnd:              \"pe-tabs--end\",\n  isAtStart:            \"pe-tabs--start\",\n  isAutofit:            \"pe-tabs--autofit\",\n  isMenu:               \"pe-tabs--menu\",\n  scrollable:           \"pe-tabs--scrollable\",\n  compactTabs:          \"pe-tabs--compact\",\n  tabHasIcon:           \"pe-tabs__tab---icon\",\n  tabRowCentered:       \"pe-tabs__row--centered\",\n  tabRowIndent:         \"pe-tabs__row--indent\",\n\n  // lookup\n  label:                buttonClasses.label\n};","import { filterSupportedAttributes } from \"polythene-core\";\nimport { isTouch, subscribe, unsubscribe } from \"polythene-core\";\nimport { scrollTo } from \"polythene-utilities\";\nimport vars from \"./vars\";\nimport classes from \"polythene-css-classes/tabs\";\n\nconst whenCreateDone = () => Promise.resolve();\n\nconst getNewIndex = (index, tabs) => {\n  const minTabIndex = 0;\n  const maxTabIndex = tabs.length - 1;\n  return {\n    backward: Math.max(index - 1, minTabIndex),\n    forward: Math.min(index + 1, maxTabIndex)\n  };\n};\n\nconst handleScrollButtonClick = (state, attrs, e, direction) => {\n  e.stopPropagation();\n  e.preventDefault();\n  const currentTabIndex = state.selectedTabIndex();\n  const newIndex = getNewIndex(currentTabIndex, state.tabs)[direction];\n  if (newIndex !== currentTabIndex) {\n    setSelectedTab(state, attrs, newIndex, true);\n  } else {\n    scrollToTab(state, newIndex);\n  }\n};\n\n/*\nMoves the first tab to the left so that the text label is as position 0. \n*/\nconst alignToTitle = (state) => {\n  const firstTab = state.tabs[0].dom;\n  const firstInnerLabel = firstTab.querySelector(`.${classes.label} span`);\n  const firstOuterLabelWidth = firstTab.getBoundingClientRect().width;\n  const firstInnerLabelWidth = firstInnerLabel.getBoundingClientRect().width;\n  const firstTabOffset = (firstOuterLabelWidth - firstInnerLabelWidth) / 2;\n  firstTab.style.marginLeft = `${-firstTabOffset}px`;\n};\n\nconst createRightButtonOffset = (state) => {\n  // add padding to right so that last item is not hidden behind scroll button\n  const scrollButtonAtEndWidth = state.scrollButtons[\"end\"].getBoundingClientRect().width;\n  const scrollButtonOffsetEl = state.tabsEl.querySelector(`.${classes.scrollButtonOffset}`);\n  scrollButtonOffsetEl.style.width = `${scrollButtonAtEndWidth}px`;\n};\n\nconst scrollToTab = (state, tabIndex) => {\n  const tabs = state.tabs;\n  const scroller = state.scrollerEl;\n  // Scroll to position of selected tab\n  const tabLeft = tabs.slice(0, tabIndex).reduce((totalWidth, tabData) =>\n    totalWidth + tabData.dom.getBoundingClientRect().width, 0);\n  // Tabs at the far right will not fully move to the left\n  // because the scrollable row will stick to the right \n  // to get the max scroll left, we subtract the visible viewport from the scroll width\n  const scrollerWidth = scroller.getBoundingClientRect().width; // frame width\n  const scrollingWidth = scroller.scrollWidth;\n  const maxScroll = scrollingWidth - scrollerWidth;\n  const left = Math.min(tabLeft, maxScroll);\n  const currentLeft = scroller.scrollLeft;\n  if (currentLeft !== left) {\n    const duration = Math.abs(currentLeft - left) / vars.tabs_scroll_speed;\n    const delaySeconds = vars.tabs_scroll_delay || 0;\n    setTimeout(() => {\n      scrollTo({\n        element: scroller,\n        to: left,\n        duration: Math.max(vars.tabs_scroll_min_duration, duration),\n        direction: \"horizontal\"\n      }).then(() => updateScrollButtons(state));\n    }, delaySeconds * 1000);\n  }\n};\n\nconst updateScrollButtons = state => {\n  const scrollerEl = state.scrollerEl;\n  const scrollLeft = scrollerEl.scrollLeft;\n  const currentTabIndex = state.selectedTabIndex();\n  const tabsEl = state.tabsEl;\n  const minTabIndex = 0;\n  const maxTabIndex = state.tabs.length - 1;\n  const isAtStart = (scrollerEl.scrollLeft === 0) && (currentTabIndex === minTabIndex);\n  const isAtEnd = (scrollLeft >= (scrollerEl.scrollWidth - tabsEl.getBoundingClientRect().width - 1)) && (currentTabIndex === maxTabIndex);\n  state.scrollButtonAtStart(isAtStart);\n  state.scrollButtonAtEnd(isAtEnd);\n};\n\nconst animateIndicator = (selectedTabEl, animate, state) => {\n  const parentRect = state.tabsEl.getBoundingClientRect();\n  const rect = selectedTabEl.getBoundingClientRect();\n  const style = state.tabIndicatorEl.style;\n  const translateX = rect.left - parentRect.left + state.scrollerEl.scrollLeft;\n  const scaleX = 1 / parentRect.width * rect.width;\n  const transformCmd = `translate(${translateX}px, 0) scaleX(${scaleX})`;\n  const duration = animate ? vars.indicator_slide_min_duration : 0;\n  style[\"transition-duration\"] = duration + \"s\";\n  style.transform = transformCmd;\n};\n\nconst setSelectedTab = (state, attrs, index, animate) => {\n  state.selectedTabIndex(index);\n  if (!state.tabs.length) return;\n  const selectedTabEl = state.tabs[index].dom;\n  if (selectedTabEl && state.tabIndicatorEl && state.tabsEl) {\n    animateIndicator(selectedTabEl, animate, state);\n  }\n  if (state.managesScroll) {\n    updateScrollButtons(state);\n  }\n  scrollToTab(state, index);\n  if (attrs.onChange) {\n    attrs.onChange({\n      index,\n      options: state.tabs[index].attrs,\n      el: selectedTabEl\n    });\n  }\n};\n\nconst sortByLargestWidth = (a, b) =>\n  a < b\n    ? 1\n    : a > b\n      ? -1\n      : 0;\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const selectedTabIndex = createStream(vnode.attrs.selectedTab || 0);\n  const scrollButtonAtStart = createStream(true);\n  const scrollButtonAtEnd = createStream(true);\n  const registerTabButton = state => (index, data) => state.tabs[index] = data;\n  const registerScrollButton = state => (position, dom) => state.scrollButtons[position] = dom;\n  return {\n    tabsEl:              undefined,\n    scrollerEl:          undefined,\n    tabs:                [], // {data, el}\n    tabRow:              undefined,\n    tabIndicatorEl:      undefined,\n    selectedTabIndex,\n    previousSelectedTab: undefined,\n    managesScroll:       attrs.scrollable && !isTouch,\n    scrollButtonAtStart,\n    scrollButtonAtEnd,\n    scrollButtons: {\n      start: undefined,\n      end: undefined\n    },\n    registerTabButton,\n    registerScrollButton,\n    cleanUp: undefined, // set in onMount\n    redrawOnUpdate: createStream.merge([selectedTabIndex, scrollButtonAtStart, scrollButtonAtEnd])\n  };\n};\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  state.tabsEl = dom;\n  if (!attrs.hideIndicator) {\n    state.tabIndicatorEl = dom.querySelector(`.${classes.indicator}`);\n  }\n  state.scrollerEl = dom.querySelector(`.${classes.tabRow}`);\n\n  // A promise can't resolve during the oncreate loop\n  // The Mithril draw loop is synchronous - there is no delay between one this oncreate and the tab button's oncreate\n  whenCreateDone().then(() => {\n    if (state.tabs && attrs.largestWidth) {\n      const widths = state.tabs.map(tabData => tabData.dom.getBoundingClientRect().width);\n      const largest = widths.sort(sortByLargestWidth)[0];\n      state.tabs.forEach(tabData => tabData.dom.style.width = largest + \"px\");\n    }\n    // Align first scrollable tab to title\n    if (attrs.scrollable) {\n      alignToTitle(state);\n    }\n    // Handle scroll\n    if (state.managesScroll) {\n      createRightButtonOffset(state);\n    }\n    setSelectedTab(state, attrs, state.selectedTabIndex(), false);\n  });\n\n  const onResize = () =>\n    setSelectedTab(state, attrs, state.selectedTabIndex(), false);\n\n  subscribe(\"resize\", onResize),\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", onResize)\n  );\n};\n\nexport const onUnMount = ({ state }) =>\n  state.cleanUp();\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const autofit = attrs.scrollable || attrs.centered\n    ? false\n    : attrs.autofit\n      ? true\n      : false;\n\n  // Keep selected tab up to date\n  if (attrs.selectedTab !== undefined && state.previousSelectedTab !== attrs.selectedTab) {\n    setSelectedTab(state, attrs, attrs.selectedTab, true);\n  }\n  state.previousSelectedTab = attrs.selectedTab;\n\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.scrollable ? classes.scrollable : null,\n        state.scrollButtonAtStart() ? classes.isAtStart : null,\n        state.scrollButtonAtEnd() ? classes.isAtEnd : null,\n        attrs.activeSelected ? classes.activeSelectable : null,\n        autofit ? classes.isAutofit : null,\n        attrs.compact ? classes.compactTabs : null,\n        attrs.menu ? classes.isMenu : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, Tab, ScrollButton }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  const buttons = attrs.content\n    ? attrs.content\n    : attrs.tabs\n      ? attrs.tabs\n      : attrs.children || vnode.children || [];\n\n  if (buttons.length === 0) {\n    console.error(\"No tabs specified\"); // eslint-disable-line no-console\n  }\n\n  const tabRowButtons = buttons.map((buttonOpts = {}, index) => {\n    const buttonOptsCombined = Object.assign(\n      {},\n      buttonOpts,\n      {\n        // These options can be overridden by `all`\n        selected: index === state.selectedTabIndex(),\n        animateOnTap: (attrs.animateOnTap !== false) ? true : false\n      },\n      attrs.all,\n      {\n        // Internal options, should not get overridden\n        index,\n        key: `tab-${index}`,\n        register: state.registerTabButton(state),\n        onSelect: () =>\n          setSelectedTab(state, attrs, index, attrs.noIndicatorSlide ? false : true)\n      }\n    );\n    return h(Tab, buttonOptsCombined);\n  });\n\n  const tabRow = attrs.scrollable\n    ? tabRowButtons.concat([\n      // offset for right scroll button\n      h(\"div\",\n        {\n          key: \"offset\",\n          className: classes.scrollButtonOffset\n        }\n      )\n    ])\n    : tabRowButtons;\n\n  let scrollButtonAtStart, scrollButtonAtEnd;\n  if (attrs.scrollable) {\n    scrollButtonAtStart = h(ScrollButton, Object.assign(\n      {},\n      {\n        key: \"backward\",\n        icon: attrs.scrollIconBackward,\n        className: classes.scrollButtonAtStart,\n        position: \"start\",\n        register: state.registerScrollButton(state),\n        events: { [k.onclick]: e => handleScrollButtonClick(state, attrs, e, \"backward\") }\n      }\n    ));\n    scrollButtonAtEnd = h(ScrollButton, Object.assign(\n      {},\n      {\n        key: \"forward\",\n        icon: attrs.scrollIconForward,\n        className: classes.scrollButtonAtEnd,\n        position: \"end\",\n        register: state.registerScrollButton(state),\n        events: { [k.onclick]: e => handleScrollButtonClick(state, attrs, e, \"forward\") }\n      }\n    ));\n  }\n\n  const tabIndicator = attrs.hideIndicator\n    ? null\n    : h(\"div\",\n      {\n        key: \"indicator\",\n        className: classes.indicator\n      }\n    );\n\n  return [\n    attrs.scrollable ? scrollButtonAtStart : null,\n    h(\"div\",\n      {\n        key: \"tabrow\",\n        className: [\n          classes.tabRow,\n          attrs.centered ? classes.tabRowCentered : null,\n          attrs.scrollable ? classes.tabRowIndent : null\n        ].join(\" \")\n      },\n      [\n        tabRow,\n        tabIndicator\n      ]\n    ),\n    attrs.scrollable ? scrollButtonAtEnd : null\n  ];\n};\n\n","import classes from \"polythene-css-classes/tabs\";\n\n// Don't export 'element': it will be the wrapped Button component (set in polythene-xxx-tabs/tab)\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const attrs = vnode.attrs;\n  attrs.register(attrs.index, {\n    attrs,\n    dom\n  });\n};\n\nexport const createProps = (vnode, { renderer: h, keys: k, Icon }) => {\n  const attrs = vnode.attrs;\n  // Let internal onclick function co-exist with passed button option\n  attrs.events = attrs.events || {};\n  attrs.events[k.onclick] = attrs.events[k.onclick] || (() => {});\n  return Object.assign(\n    {},\n    attrs,\n    {\n      content: h(\"div\",\n        { className: classes.tabContent },\n        [\n          attrs.icon ? h(Icon, attrs.icon) : null,\n          attrs.label\n            ? h(\"div\",\n              { className: classes.label },\n              h(\"span\", attrs.label)\n            )\n            : null,\n        ]),\n      className: [\n        classes.tab,\n        attrs.icon && attrs.label ? classes.tabHasIcon : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      selected: attrs.selected,\n      wash: false,\n      ripple: true,\n      events: Object.assign(\n        {},\n        attrs.events,\n        {\n          [k.onclick]: e => {\n            attrs.onSelect();\n            attrs.events[k.onclick](e);\n          }\n        }\n      )\n    }\n  );\n};\n\nexport const createContent = vnode =>\n  vnode.children;\n","import classes from \"polythene-css-classes/tabs\";\n\n// Don't export 'element': it will be the wrapped IconButton component (set in polythene-xxx-tabs/scroll-button)\n\nconst arrowBackward = \"<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\\\"/></svg>\";\nconst arrowForward = \"<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\\\"/></svg>\";\n\nexport const onMount = vnode => {\n  const dom = vnode.dom;\n  if (!dom) {\n    return;\n  }\n  const attrs = vnode.attrs;\n  attrs.register(attrs.position, dom);\n};\n\nexport const createProps = (vnode, { renderer: h, keys: k }) => {\n  const attrs = vnode.attrs;\n  const icon = attrs.position === \"start\"\n    ? attrs.icon || { svg: { content: h.trust(arrowBackward) } }\n    : attrs.icon || { svg: { content: h.trust(arrowForward) } };\n  return {\n    className: [\n      classes.scrollButton,\n      attrs.className || attrs[k.class]\n    ].join(\" \"),\n    icon,\n    ripple: { center: true },\n    events: attrs.events,\n  };\n};\n"],"names":["rgba","colorStr","opacity","fontSize","buttonVars","font_size","tab_label_line_height","vars","unit_indent","color_primary","iconButtonVars","color_light","color_dark","buttonClasses","label","whenCreateDone","Promise","resolve","getNewIndex","index","tabs","minTabIndex","maxTabIndex","length","Math","max","min","handleScrollButtonClick","state","attrs","e","direction","stopPropagation","preventDefault","currentTabIndex","selectedTabIndex","newIndex","alignToTitle","firstTab","dom","firstInnerLabel","querySelector","classes","firstOuterLabelWidth","getBoundingClientRect","width","firstInnerLabelWidth","firstTabOffset","style","marginLeft","createRightButtonOffset","scrollButtonAtEndWidth","scrollButtons","scrollButtonOffsetEl","tabsEl","scrollButtonOffset","scrollToTab","tabIndex","scroller","scrollerEl","tabLeft","slice","reduce","totalWidth","tabData","scrollerWidth","scrollingWidth","scrollWidth","maxScroll","left","currentLeft","scrollLeft","duration","abs","tabs_scroll_speed","delaySeconds","tabs_scroll_delay","tabs_scroll_min_duration","then","updateScrollButtons","isAtStart","isAtEnd","scrollButtonAtStart","scrollButtonAtEnd","animateIndicator","selectedTabEl","animate","parentRect","rect","tabIndicatorEl","translateX","scaleX","transformCmd","indicator_slide_min_duration","transform","setSelectedTab","managesScroll","onChange","sortByLargestWidth","a","b","getInitialState","vnode","createStream","selectedTab","registerTabButton","data","registerScrollButton","position","undefined","scrollable","isTouch","merge","onMount","hideIndicator","indicator","tabRow","largestWidth","widths","map","largest","sort","forEach","onResize","cleanUp","unsubscribe","onUnMount","createProps","k","keys","autofit","centered","previousSelectedTab","filterSupportedAttributes","component","activeSelected","activeSelectable","isAutofit","compact","compactTabs","menu","isMenu","tone","className","class","join","createContent","h","renderer","Tab","ScrollButton","buttons","content","children","error","tabRowButtons","buttonOpts","buttonOptsCombined","animateOnTap","all","noIndicatorSlide","concat","scrollIconBackward","onclick","scrollIconForward","tabIndicator","tabRowCentered","tabRowIndent","register","Icon","events","_extends","tabContent","icon","tab","tabHasIcon","selected","onSelect","arrowBackward","arrowForward","svg","trust","scrollButton","center"],"mappings":"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"}